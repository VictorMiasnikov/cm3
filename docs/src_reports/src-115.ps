%!PS-Adobe-2.0
%%Creator: dvips 5.58 Copyright 1986, 1994 Radical Eye Software
%%Title: src115-new.dvi
%%CreationDate: Thu Apr 25 15:30:11 1996
%%Pages: 56
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Roman Times-Bold Times-Italic Courier
%%+ Courier-Oblique
%%EndComments
%DVIPSCommandLine: dvips -Psrcreport -o src115-new.ps src115-new.dvi
%DVIPSParameters: dpi=300, comments removed
%DVIPSSource:  TeX output 1996.04.25:1530
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]{ch-image}imagemask restore}B /D{/cc X dup type /stringtype ne{]}
if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2
index /UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type /integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics /Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont /setfont load]cvx def}def
/ObliqueSlant{dup sin S cos div neg}B /SlantFont{4 index mul add}def
/ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding exch def}def
end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N
/vs 792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP 0 N /rwiSeen
false N /rhiSeen false N /letter{}N /note{}N /a4{}N /legal{}N}B
/@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{@scaleunit
div /vsc X}B /@hsize{/hs X /CLIP 1 N}B /@vsize{/vs X /CLIP 1 N}B /@clip{
/CLIP 2 N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{
10 div /rwi X /rwiSeen true N}B /@rhi{10 div /rhi X /rhiSeen true N}B
/@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X}B /magscale
true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{userdict begin md length 10 add md maxlength ge{/md md dup
length 20 add dict copy def}if end md begin /letter{}N /note{}N /legal{}
N /od{txpose 1 0 mtx defaultmatrix dtransform S atan/pa X newpath
clippath mark{transform{itransform moveto}}{transform{itransform lineto}
}{6 -2 roll transform 6 -2 roll transform 6 -2 roll transform{
itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll curveto}}{{
closepath}}pathforall newpath counttomark array astore /gc xdf pop ct 39
0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}if}N
/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1 -1
scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0
TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR
pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1
-1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg
TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg
sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr 2 get ppr
0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4 -1 roll add
2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S TR}if}N /cp
{pop pop showpage pm restore}N end}if}if}N /normalscale{Resolution 72
div VResolution 72 div neg scale magscale{DVImag dup scale}if 0 setgray}
N /psfts{S 65781.76 div N}N /startTexFig{/psf$SavedState save N userdict
maxlength dict begin /magscale true def normalscale currentpoint TR
/psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx
psf$llx sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy
scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR
/showpage{}N /erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N /endTexFig{end psf$SavedState restore}N /@beginspecial{SDict
begin /SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count /ocount X /dcount countdictstack N}N /@setspecial
{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if /showpage{}N /erasepage{}N /copypage{}N newpath
}N /@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{
end}repeat grestore SpecialSave restore end}N /@defspecial{SDict begin}
N /@fedspecial{end}B /li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{
/SaveX currentpoint /SaveY X N 1 setlinecap newpath}N /st{stroke SaveX
SaveY moveto}N /fil{fill SaveX SaveY moveto}N /ellipse{/endangle X
/startangle X /yrad X /xrad X /savematrix matrix currentmatrix N TR xrad
yrad scale 0 0 1 startangle endangle arc savematrix setmatrix}N end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/tmp_mnt/teak/r/dlusers7/mcjones/m3/cmass/src115/src115-new.dvi)
@start /Fa 134[17 3[17 9 13 11 17 1[17 17 26 9 1[9 9
17 17 1[15 17 15 17 15 97[{}19 33.333332 /Times-Roman
rf /Fb 3 116 df<07C00C20107020706000C000C000C00080008000C010C02060C03F00
0C0E7E8D0F>99 D<003E000C000C000C000C0018001800180018073018F0307060706060
C060C060C06080C080C480C4C1C446C838700F177E9612>I<07C00C201870187038001E
000FC003E000606060E060C0C0C1803F000C0E7E8D10>115 D E
/Fc 2 42 df<0102040C1818303070606060E0E0E0E0E0E0E0E0E0E06060607030301818
0C04020108227D980E>40 D<8040203018180C0C0E060606070707070707070707070606
060E0C0C18183020408008227E980E>I E /Fd 4 116 df<70F0F8F87808080810101020
2040050E7C840D>59 D<007C0001C3000700800E07801E07801C07003C02007800007800
00780000F00000F00000F00000F00000F000007001007002003004001838000FC0001114
7E9314>99 D<0000780003F80000700000700000700000700000E00000E00000E00000E0
0001C00001C000F1C00389C00707800E03801C03803C0380380700780700780700780700
F00E00F00E00F00E00F00E10F01C20F01C20703C20705C40308C400F078015207E9F18>
I<00FC000303000600800C01800C03800C03000E00000F80000FF80007FC0001FE00001F
00000700700700F00600F00600E004004008002030001FC00011147E9315>115
D E /Fe 2 42 df<0040008001000300060004000C001800180038003000300070006000
600060006000E000E000E000E000E000E000E000E000E000E000E000E000600060006000
60007000300030003800180018000C000400060003000100008000400A2E7BA112>40
D<8000400020003000180008000C00060006000700030003000380018001800180018001
C001C001C001C001C001C001C001C001C001C001C001C001800180018001800380030003
000700060006000C000800180030002000400080000A2E7EA112>I
E /Ff 134[25 1[25 25 25 25 25 25 1[25 25 25 25 25 1[25
25 25 25 25 25 25 25 25 25 3[25 1[25 1[25 25 25 1[25
25 25 25 1[25 25 25 1[25 2[25 2[25 25 1[25 1[25 3[25
2[25 11[25 4[25 25 40[{}45 41.666668 /Courier-Oblique
rf /Fg 80[25 53[23 23 33 23 23 13 18 15 23 23 23 23 36
13 23 13 13 23 23 15 20 23 20 23 20 11[33 28 25 30 4[41
28 2[15 2[25 2[30 1[33 6[13 11[11 15 11 44[{.167 SlantFont}40
45.833332 /Times-Roman rf /Fh 130[25 25 25 1[25 25 25
25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25
25 25 25 25 1[25 1[25 1[25 1[25 25 25 25 25 25 25 25
25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 2[25
25 25 25 25 1[25 25 25 25 1[25 25 25 25 25 25 25 25 1[25
25 25 25 3[25 25 34[{}79 41.666668 /Courier rf /Fi 81[23
52[20 20 30 20 23 13 18 18 23 23 23 23 33 13 20 13 13
23 23 13 20 23 20 23 23 12[25 23 28 1[28 33 1[38 25 1[20
15 3[28 33 30 28 28 6[15 23 4[23 23 23 23 23 13 11 15
11 4[15 39[{}52 45.833332 /Times-Italic rf /Fj 135[29
42 29 32 19 23 26 1[32 29 32 48 16 2[16 2[19 26 32 26
32 29 14[42 1[36 45 5[23 3[39 1[42 11[29 29 29 29 29
29 29 49[{}32 58.333336 /Times-Bold rf /Fk 81[28 53[25
36 25 28 17 19 22 28 28 25 28 41 14 28 17 14 28 25 17
22 28 22 28 25 12[33 28 36 1[30 39 36 47 33 4[39 30 33
36 36 33 36 7[25 25 25 25 25 25 25 25 25 2[12 6[17 39[{}51
50.000000 /Times-Bold rf /Fl 4 104 df<0000FF00000007FFE000001F00F8000078
001E0000E0000700018000018003000000C006000000600C000000300C00000030180000
0018300000000C300000000C6000000006600000000660000000066000000006C0000000
03C000000003C000000003C000000003C000000003C000000003C000000003C000000003
C0000000036000000006600000000660000000066000000006300000000C300000000C18
000000180C000000300C00000030060000006003000000C0018000018000E00007000078
001E00001F00F8000007FFE0000000FF0000282B7EA02D>13 D<03F0000FFC001FFE003F
FF007FFF807FFF80FFFFC0FFFFC0FFFFC0FFFFC0FFFFC0FFFFC07FFF807FFF803FFF001F
FE000FFC0003F00012127E9317>15 D<000F0038006000E001C001C001C001C001C001C0
01C001C001C001C001C001C001C001C001C0038007001E00F8001E000700038001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C001C000E000600038000F102D
7DA117>102 D<F8001E000700038001C001C001C001C001C001C001C001C001C001C001
C001C001C001C001C000E000600038000F0038006000E001C001C001C001C001C001C001
C001C001C001C001C001C001C001C001C0038007001E00F800102D7DA117>I
E /Fm 134[42 4[28 32 37 3[46 69 4[46 2[37 1[37 1[42 13[46
60 14[60 67[{}13 83.333336 /Times-Bold rf /Fn 47[46 13[15
7[20 8[23 1[25 25 3[20 47[20 23 23 33 23 23 13 18 15
23 23 23 23 36 13 23 13 13 23 23 15 20 23 20 23 20 3[15
1[15 1[33 33 43 33 33 28 25 30 1[25 33 33 41 28 33 18
15 33 33 25 28 33 30 30 33 42 20 3[13 13 23 23 23 23
23 23 23 23 23 23 13 11 15 11 2[15 15 15 36 38[{}81 45.833332
/Times-Roman rf /Fo 81[25 52[23 23 33 23 25 15 18 20
25 25 23 25 38 13 2[13 25 23 15 20 25 20 25 23 13[25
33 1[28 36 1[43 3[18 36 2[30 33 33 1[33 7[23 23 23 23
23 23 23 23 23 4[11 44[{}45 45.833332 /Times-Bold rf
/Fp 136[51 2[23 27 31 2[35 3[39 23 4[31 1[31 39 18[55
51 78[{}12 70.833336 /Times-Bold rf /Fq 136[42 1[29 16
23 19 1[29 29 29 1[16 29 1[16 29 29 1[26 29 26 29 26
9[55 3[32 39 2[42 42 6[42 1[36 2[39 42 20[15 44[{}28
58.333336 /Times-Roman rf /Fr 172[58 75 14[75 13[52 3[52
49[{}5 104.166664 /Times-Bold rf /Fs 134[25 2[25 25 14
19 17 2[25 1[39 14 2[14 3[22 25 22 25 22 9[47 2[30 1[33
11[28 1[36 10[25 25 2[25 25 1[25 25 2[12 1[12 44[{}28
50.000000 /Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 75 100 a
 0 0 0 setrgbcolor
 75 100 a 41 x Fs(February)11 b(28,)i(1994)75
191 y(Revised)g(December)f(4,)h(1995)p 75 266 1500 2
v 75 412 a Fr(SRC)307 337 y Fq(Research)307 412 y(Report)p
1415 443 218 160 v 1420 391 a
 1 1 1 setrgbcolor
 1420 391 a Fr(1)-6 b(15)1570
391 y
 0 0 0 setrgbcolor
 1570 391 a 75 927 1500 2 v 75 1022 a Fp(Network)19
b(Objects)38 1484 y Fq(Andrew)c(Birrell,)g(Greg)g(Nelson,)e(Susan)i
(Owicki,)f(and)g(Edward)g(W)-5 b(obber)p 75 1925 V 75
2116 a @beginspecial 100 @llx 100 @lly 170 @urx 120 @ury
945 @rwi @setspecial
%%BeginProcSet: logo.ps
/logo {gsave
  % create a 1-by-1 digital logo
  /Helvetica-Bold findfont
  .6 .75 matrix defaultmatrix scale makefont setfont

  /box {gsave
    % paint a character white on gray box
    newpath
    0.2 setgray
    0 0 moveto
    .425 0 lineto
    .425 1 lineto
    0 1 lineto
    closepath
    fill
    word exch 1 getinterval
    1 setgray
    dup stringwidth pop .425 exch sub 2 div .225 moveto
    show
    grestore} def

  /boxstr {gsave
    /word exch def
    word length 2 div 1 exch div 1 scale
    0 1 word length 1 sub {box .5 0 translate} for
    grestore} def

  (digital) boxstr
  grestore} def

100 100 translate 70 20 scale logo
%%EndProcSet
 @endspecial 61 x Fo(Systems)12 b(Resear)o(ch)g(Center)75
2227 y Fn(130)f(L)m(ytton)g(A)m(venue)75 2277 y(Palo)h(Alto,)f
(California)g(94301)p eop
%%Page: 2 2
2 1 bop 225 444 a Fm(Systems)21 b(Resear)o(ch)e(Center)225
569 y Fn(The)12 b(charter)g(of)g(SRC)g(is)f(to)h(advance)g(both)f(the)g
(state)g(of)h(knowledge)f(and)g(the)h(state)f(of)h(the)f(art)h(in)f
(com-)225 618 y(puter)d(systems.)14 b(From)8 b(our)h(establishment)e
(in)h(1984,)h(we)g(have)g(performed)f(basic)h(and)f(applied)h(research)
225 668 y(to)h(support)g(Digital')m(s)g(business)g(objectives.)k(Our)d
(current)g(work)g(includes)f(exploring)g(distributed)f(per)o(-)225
718 y(sonal)j(computing)f(on)h(multiple)f(platforms,)i(networking,)f
(programming)f(technology)m(,)i(system)e(mod-)225 768
y(elling)f(and)i(management)f(techniques,)g(and)g(selected)g
(applications.)225 838 y(Our)g(strategy)g(is)g(to)f(test)h(the)g
(technical)g(and)g(practical)h(value)f(of)g(our)g(ideas)g(by)g
(building)f(hardware)i(and)225 888 y(software)g(prototypes)e(and)i
(using)f(them)g(as)g(daily)g(tools.)16 b(Interesting)11
b(systems)f(are)i(too)f(complex)g(to)h(be)225 938 y(evaluated)d(solely)
g(in)f(the)h(abstract;)h(extended)f(use)g(allows)g(us)f(to)h
(investigate)f(their)h(properties)g(in)g(depth.)225 988
y(This)i(experience)i(is)e(useful)h(in)f(the)h(short)f(term)h(in)f
(re\256ning)h(our)g(designs,)f(and)h(invaluable)f(in)h(the)f(long)225
1037 y(term)h(in)h(advancing)f(our)g(knowledge.)19 b(Most)11
b(of)i(the)g(major)f(advances)h(in)f(information)f(systems)g(have)225
1087 y(come)g(through)g(this)f(strategy)m(,)i(including)e(personal)h
(computing,)f(distributed)g(systems,)g(and)i(the)f(Inter)o(-)225
1137 y(net.)225 1207 y(W)l(e)h(also)g(perform)f(complementary)g(work)h
(of)f(a)h(more)g(mathematical)e(\257avor)m(.)18 b(Some)12
b(of)f(it)g(is)g(in)h(estab-)225 1257 y(lished)c(\256elds)g(of)h
(theoretical)g(computer)f(science,)i(such)e(as)h(the)g(analysis)f(of)g
(algorithms,)g(computational)225 1307 y(geometry)m(,)13
b(and)f(logics)f(of)i(programming.)k(Other)12 b(work)g(explores)g(new)h
(ground)f(motivated)f(by)h(prob-)225 1357 y(lems)f(that)g(arise)g(in)g
(our)g(systems)f(research.)225 1427 y(W)l(e)j(have)g(a)g(strong)e
(commitment)g(to)h(communicating)e(our)j(results;)e(exposing)h(and)g
(testing)f(our)i(ideas)225 1477 y(in)d(the)f(research)i(and)f
(development)f(communities)f(leads)i(to)g(improved)f(understanding.)14
b(Our)c(research)225 1527 y(report)g(series)f(supplements)f
(publication)g(in)h(professional)g(journals)g(and)h(conferences.)16
b(W)l(e)10 b(seek)g(users)225 1576 y(for)f(our)g(prototype)e(systems)h
(among)g(those)g(with)g(whom)g(we)h(have)g(common)e(interests,)i(and)g
(we)g(encour)o(-)225 1626 y(age)j(collaboration)e(with)h(university)f
(researchers.)225 1751 y Fs(Robert)i(W)-5 b(.)13 b(T)m(aylor)n(,)g
(Director)p eop
%%Page: 3 3
3 2 bop 75 532 a Fp(Network)19 b(Objects)75 657 y Fn(Andrew)11
b(Birrell,)i(Greg)e(Nelson,)g(Susan)h(Owicki,)f(and)h(Edward)f(W)l
(obber)75 757 y(February)h(28,)g(1994)75 806 y(Revised)g(December)g(4,)
f(1995)p eop
%%Page: 4 4
4 3 bop 225 141 a Fo(Af\256liations)225 257 y Fn(Susan)9
b(Owicki)f(is)g(an)g(independent)g(consultant.)13 b(Her)c(current)g
(address)g(is)f(956)g(N.)h(California)f(A)m(ve,)h(Palo)225
307 y(Alto,)i(CA)h(94303,)f(U.S.A.)i(\(e-mail:)i
(owicki@mojave.stanford.edu\).)225 440 y Fo(Publication)d(History)225
556 y Fn(An)f(earlier)g(version)g(of)g(this)f(report)h(appeared)h(in)e
(the)h(Proceedings)g(of)g(the)g(Fourteenth)g(ACM)g(Sympo-)225
606 y(sium)f(on)h(Operating)g(System)g(Principles,)h(Asheville,)f
(North)f(Carolina,)j(December)f(5-8,)f(1993.)225 722
y(This)g(report)g(is)g(to)g(appear)h(in)f(Software)h(\261)f(Practice)i
(&)e(Experience,)h(John)f(W)n(iley)g(&)g(Sons,)h(Ltd.)238
1774 y Fo(c)225 1775 y Fl(\015)p Fo(Digital)f(Equipment)i(Corporation)f
(1993,)g(1995)225 1875 y Fn(This)d(work)i(may)e(not)h(be)g(copied)g(or)
h(reproduced)f(in)g(whole)g(or)g(in)g(part)g(except)h(in)f(accordance)h
(with)f(this)225 1925 y(provision.)19 b(Permission)12
b(to)h(copy)g(in)f(whole)h(or)g(in)f(part)i(without)d(payment)h(of)i
(fee)f(is)g(granted)g(only)f(to)225 1974 y(licensees)f(under)g(\(and)g
(is)f(subject)h(to)f(the)h(terms)g(and)g(conditions)e(of\))i(the)g
(Digital)f(License)h(Agreement)225 2024 y(for)e(SRC)h(Modula-3,)f(as)g
(it)f(appears,)i(for)g(example,)f(on)g(the)f(Internet)h(at)g(the)f(URL)
i(http://www)m(.research.)225 2074 y
(digital.com/SRC/m3sources/html/COPYRIGHT)m(.html)e(.)15
b(All)c(such)g(whole)f(or)h(partial)g(copies)g(must)225
2124 y(include)i(the)g(following:)k(a)d(notice)f(that)f(such)h(copying)
g(is)g(by)g(permission)e(of)j(the)f(Systems)f(Research)225
2174 y(Center)g(of)e(Digital)g(Equipment)f(Corporation)i(in)f(Palo)h
(Alto,)g(California;)f(an)h(acknowledgment)f(of)h(the)225
2223 y(authors)h(and)g(individual)f(contributors)g(to)h(the)g(work;)g
(and)h(all)f(applicable)g(portions)f(of)h(this)g(copyright)225
2273 y(notice.)j(All)c(rights)f(reserved.)p eop
%%Page: 5 5
5 4 bop 75 141 a Fk(Authors')11 b(Abstract)75 213 y Fn(A)g(network)h
(object)f(is)f(an)i(object)f(whose)g(methods)f(can)i(be)g(invoked)e
(over)i(a)g(network.)j(The)d(Modula-3)75 263 y(network)g(objects)h
(system)e(is)i(novel)f(for)h(its)f(overall)h(simplicity)m(.)k(It)c
(provides)f(distributed)f(type)i(safety)75 313 y(through)7
b(the)g(narrowest)h(surrogate)g(rule,)h(which)e(allows)g(programmers)h
(to)f(export)g(new)h(versions)f(of)h(dis-)75 363 y(tributed)g(services)
i(as)f(subtypes)g(of)g(previous)g(versions.)14 b(This)8
b(report)i(describes)f(the)g(design)g(and)g(imple-)75
413 y(mentation)i(of)i(the)f(system,)g(including)f(a)i(thorough)e
(description)g(of)i(realistic)f(marshaling)f(algorithms)75
462 y(for)k(network)g(objects,)h(precise)f(informal)f(speci\256cations)
h(of)g(the)g(major)f(system)g(interfaces,)j(lessons)75
512 y(learned)12 b(from)f(using)f(the)i(system,)e(and)i(performance)g
(results.)p eop
%%Page: 6 6
6 5 bop eop
%%Page: 7 7
7 6 bop 75 141 a Fj(Contents)75 238 y Fo(1)45 b(Overview)1415
b(1)143 288 y Fn(1.1)49 b(Related)11 b(work)37 b(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)78
b(3)143 338 y(1.2)49 b(De\256nitions)43 b(.)23 b(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)78 b(3)143
387 y(1.3)49 b(Examples)32 b(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)78 b(4)143 437 y(1.4)49
b(Failure)11 b(semantics)g(and)g(alerts)h(.)23 b(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)78 b(8)75 533 y Fo(2)45 b(Implementation)1292
b(9)143 583 y Fn(2.1)49 b(Assumptions)40 b(.)23 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)78 b(9)143 632
y(2.2)49 b(Pickles)13 b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(10)143 682 y(2.3)49
b(Garbage)12 b(collection)37 b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)57 b(1)n(1)143 732 y(2.4)49 b(T)n(ransports)19
b(.)k(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)55 b(12)143 782 y(2.5)49 b(Basic)11 b(representations)29
b(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(13)143 832 y(2.6)49 b(Remote)11 b(invocation)37 b(.)23
b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(14)143 881 y(2.7)49 b(Marshaling)10 b(network)h(objects)44
b(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(15)143 931 y(2.8)49
b(Marshaling)10 b(streams)25 b(.)e(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)55 b(19)143 981 y(2.9)49 b(Bootstrapping)21
b(.)i(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(20)75 1077 y Fo(3)45 b(Public)12 b(Interfaces)1250
b(21)143 1126 y Fn(3.1)49 b(NetObj)10 b(interface)45
b(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(21)143 1176 y(3.2)49 b(NetStream)11 b(interface)19
b(.)k(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(23)143 1226 y(3.3)49 b(NetObjNoti\256er)10 b(interface)40
b(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(24)143
1276 y(3.4)49 b(The)11 b(stub)f(generator)43 b(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(25)75 1371 y Fo(4)45
b(Internal)13 b(Interfaces)1214 b(26)143 1421 y Fn(4.1)49
b(StubLib)10 b(interface)32 b(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)55 b(26)143 1471 y(4.2)49 b(An)11
b(example)g(stub)39 b(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)55 b(31)143 1521 y(4.3)49 b(StubConn)11 b(interface)31
b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(33)143 1571 y(4.4)49 b(Message)11 b(readers)h(and)f(writers)36
b(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(34)143 1620
y(4.5)49 b(T)n(ransport)11 b(interface)38 b(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(35)75 1716 y Fo(5)45
b(Performance)1328 b(38)75 1811 y(6)45 b(Experience)1364
b(39)143 1861 y Fn(6.1)49 b(Siphon)15 b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(39)143 1911 y(6.2)49 b(Ar)o(go)18 b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55
b(40)143 1961 y(6.3)49 b(Obliq)40 b(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(41)143
2011 y(6.4)49 b(Other)11 b(work)38 b(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)55 b(41)75 2106 y
Fo(7)45 b(Conclusion)1362 b(42)75 2201 y(Index)1537 b(47)p
eop
%%Page: 8 8
8 7 bop eop
%%Page: 1 9
1 8 bop 75 141 a Fj(1)58 b(Overview)75 271 y Fn(In)11
b(pure)g(object-oriented)g(programming,)f(clients)g(cannot)h(access)g
(the)g(concrete)h(state)e(of)h(an)g(object)g(di-)75 321
y(rectly)m(,)h(but)f(only)f(via)i(the)f(object')m(s)g(methods.)k(This)c
(methodology)e(applies)i(beautifully)f(to)h(distributed)75
370 y(computing,)d(since)h(the)f(method)g(calls)h(are)g(a)g(convenient)
f(place)h(to)g(insert)f(the)h(communication)e(required)75
420 y(by)k(the)g(distributed)f(system.)k(Systems)d(based)g(on)g(this)g
(observation)f(began)h(to)g(appear)h(about)f(a)h(decade)75
470 y(ago,)k(including)d(Ar)o(gus[16)o(],)j(Eden[1],)g(and)f(early)g
(work)f(of)h(Shapiro[24)o(],)h(and)f(more)f(keep)h(arriving)75
520 y(every)e(day)m(.)18 b(It)12 b(seems)g(to)g(be)g(the)g(destiny)f
(of)h(distributed)f(programming)g(to)h(become)g(object-oriented,)75
570 y(but)d(the)h(details)g(of)g(the)g(transformation)f(are)h(hazy)m(.)
16 b(Should)9 b(objects)h(be)g(mobile)f(or)h(stationary?)k(Should)75
619 y(they)c(be)g(communicated)f(by)g(copying)g(or)h(by)g(reference?)17
b(Should)9 b(they)h(be)g(active?)15 b(Persistent?)f(Repli-)75
669 y(cated?)24 b(Is)13 b(the)h(typical)f(object)h(a)g(menu)g(button)e
(or)i(an)h(X)e(server?)24 b(Is)14 b(there)g(any)g(dif)o(ference)i
(between)75 719 y(inter)o(-program)11 b(typechecking)g(and)g
(intra-program)g(typechecking?)117 771 y(W)l(e)i(believe)g(that)f(the)h
(way)f(to)h(make)g(progress)f(in)g(these)h(issues)f(is)g(to)g(discuss)g
(them)g(in)h(the)f(context)75 821 y(of)g(real)g(implementations.)i(T)m
(o)d(this)g(end,)h(this)e(report)i(describes)g(a)g(distributed)e
(programming)g(system)75 870 y(for)i(Modula-3,)f(that)f(we)i(call)f
Fi(network)h(objects)p Fn(.)117 922 y(Network)e(objects)h(provide)f
(functionality)f(similar)h(to)h(remote)f(procedure)i(call)f(\(RPC\),)i
(but)d(they)h(are)75 972 y(more)i(general)g(and)g(easier)h(to)f(use.)20
b(Our)13 b(network)g(objects)g(are)g(not)g(mobile,)g(but)f(we)h(make)g
(it)g(easy)g(to)75 1022 y(communicate)f(objects)h(either)h(by)f
(copying)f(or)i(by)f(reference.)24 b(Our)13 b(objects)g(are)h(passive:)
k(they)13 b(have)75 1072 y(no)d(implicitly)d(associated)j(thread)g(of)g
(control,)g(nor)g(is)f(there)h(any)g(implicit)e(synchronization)h
(associated)75 1121 y(with)i(calling)g(their)h(methods.)k(Our)c
(objects)f(are)i(not)e(persistent)g(or)h(replicated.)18
b(They)11 b(are)i(suf)o(\256ciently)75 1171 y(lightweight)8
b(that)h(it)g(would)g(be)h(perfectly)g(practical)g(to)f(use)h(one)g
(per)g(menu)f(button.)14 b(W)l(e)c(provide)f(strong)75
1221 y(inter)o(-program)i(typechecking.)117 1273 y(The)g(primary)g
(distinguishing)e(aspect)j(of)f(our)h(system)e(is)i(its)e(simplicity)m
(.)k(W)l(e)f(restricted)e(our)h(feature)75 1323 y(set)j(to)f(those)h
(features)g(that)g(we)g(believe)g(are)g(valuable)g(to)f(all)h
(distributed)e(applications)h(\(distributed)75 1373 y(type-checking,)g
(transparent)e(invocation,)h(powerful)g(marshaling,)g(ef)o(\256cient)h
(and)f(convenient)f(access)75 1422 y(to)f(streams,)h(and)g(distributed)
e(garbage)i(collection\),)g(and)f(we)h(omitted)f(more)g(complex)g(or)h
(speculative)75 1472 y(features)g(\(object)f(mobility)m(,)f
(transactions\).)117 1524 y(W)l(e)g(or)o(ganized)f(the)h
(implementation)d(around)i(a)h(small)e(number)h(of)h(quite)e(simple)h
(interfaces,)h(each)h(of)75 1574 y(which)d(is)g(described)h(in)f(this)g
(report.)15 b(The)9 b(report)f(also)h(describes)f(a)h(number)f(of)h
(implementation)d(details)75 1624 y(that)k(have)g(been)g(omitted)f
(from)g(previously)g(published)g(work,)h(including)f(simple)g
(algorithms)f(for)i(mar)o(-)75 1673 y(shaling)j(and)h(unmarshaling)e
(network)i(objects)f(in)g(a)i(heterogeneous)e(network.)23
b(All)13 b(of)h(this)f(material)75 1723 y(makes)f(the)h(report)f
(longer)g(than)g(we)h(would)f(like,)h(but)f(to)g(make)g(progress)g(in)g
(the)h(complicated)e(design)75 1773 y(space)h(of)f(distributed)e
(object)i(systems)f(it)h(seems)f(necessary)i(to)f(describe)g(real)h
(systems)d(in)i(more)g(detail)75 1823 y(than)g(is)g(customary)g(in)f
(the)i(research)g(literature.)117 1875 y(W)l(e)g(now)f(brie\257y)g
(introduce)g(some)g(of)g(the)h(central)f(aspects)h(of)f(our)g(design.)
117 1941 y Fi(Distributed)e(typechecking.)15 b Fn(Our)c(system)f
(provides)g(strong)h(typechecking)f(via)h(the)g Fi(narr)n(owest)f(sur)o
(-)75 1991 y(r)n(ogate)j(rule)p Fn(,)i(which)e(will)g(be)h(described)g
(in)f(detail)h(below)m(.)22 b(In)14 b(a)g(distributed)e(environment)h
(it)g(can)i(be)75 2040 y(very)c(dif)o(\256cult)f(to)g(release)h(a)f
(new)h(version)f(of)g(a)h(service,)g(since)f(old)g(clients)f(must)h(be)
g(supported)g(as)g(well)75 2090 y(as)j(new)f(ones.)19
b(The)13 b(narrowest)g(surrogate)f(rule)h(allows)f(a)h(programmer)f(to)
g(release)i(a)f(new)g(version)f(of)75 2140 y(the)h(service)g(as)g(a)g
(subtype)f(of)h(the)f(old)g(version,)i(which)e(supports)g(both)g(old)g
(and)h(new)f(clients)h(and)f(en-)75 2190 y(sures)f(type)h(safety)m(.)k
(The)11 b(narrowest)h(surrogate)f(rule)h(could)f(also)g(be)h(useful)f
(in)g(other)g(situations)f(where)75 2240 y(separately)h(compiled)f
(programs)g(need)h(to)f(communicate)g(in)g(a)h(type-safe)g(way;)g(for)g
(example,)g(it)f(could)75 2289 y(be)i(used)f(to)g(solve)f(the)i
(problem)e(of)i(version)e(skew)i(in)f(shared)g(libraries.)117
2341 y Fi(T)m(ranspar)n(ent)g(r)n(emote)h(invocation.)j
Fn(In)c(our)h(system,)f(remote)g(invocations)g(are)h(syntactically)e
(identi-)75 2391 y(cal)f(to)f(local)g(ones;)h(their)f(method)g
(signatures)f(are)i(identical.)14 b(A)9 b(client)f(invoking)f(a)h
(method)g(of)g(an)h(object)910 2516 y(1)p eop
%%Page: 2 10
2 9 bop 225 141 a Fn(need)12 b(not)e(know)h(whether)h(the)f(object)g
(is)g(local)g(or)g(remote.)267 192 y Fi(Powerful)f(marshaling.)k
Fn(As)c(in)h(any)g(distributed)e(programming)h(system,)g(ar)o(gument)h
(values)g(and)g(re-)225 242 y(sults)g(are)j(communicated)d(by)h
Fi(marshaling)f Fn(them)g(into)h(a)h(sequence)g(of)f(bytes,)h
(transmitting)d(the)i(bytes)225 292 y(from)g(one)g(program)f(to)h(the)g
(other)n(,)g(and)g(then)g(unmarshaling)e(them)i(into)f(values)g(in)h
(the)g(receiving)g(pro-)225 342 y(gram.)22 b(The)13 b(marshaling)f
(code)i(is)f(contained)g(in)g(stub)f(modules)h(that)f(are)j(generated)f
(from)f(the)g(object)225 392 y(type)c(declaration)h(by)g(a)g(stub)f
(generator.)15 b(Our)10 b(marshaling)f(code)h(relies)g(heavily)f(on)g
(a)h(general-purpose)225 441 y(mechanism)f(called)h Fi(pickles)p
Fn(.)15 b(Pickles)9 b(use)h(the)g(same)f(runtime-type)g(data)h
(structures)f(used)h(by)f(the)h(local)225 491 y(garbage)h(collector)f
(to)g(perform)h(ef)o(\256cient)g(and)f(compact)g(marshaling)g(of)g
(arbitrarily)g(complicated)g(data)225 541 y(types.)15
b(Our)10 b(stub)g(generator)h(produces)g(in-line)f(code)h(for)g(simple)
e(types,)i(but)f(calls)g(the)h(pickle)f(package)225 591
y(for)k(complicated)f(types.)22 b(This)12 b(combination)g(strategy)i
(makes)f(simple)f(calls)i(fast,)g(handles)f(arbitrary)225
641 y(data)e(structures,)h(and)f(guarantees)h(small)e(stub)h(modules.)
267 692 y(W)l(e)g(believe)g(it)f(is)g(better)h(to)f(provide)h(powerful)
g(marshaling)e(than)i(object)f(mobility)m(.)j(The)e(two)g(facili-)225
742 y(ties)d(are)i(similar)n(,)f(since)g(both)f(of)h(them)g(allow)f
(the)h(programmer)g(the)f(option)g(of)h(communicating)e(objects)225
791 y(by)12 b(reference)i(or)e(by)g(copying.)17 b(Either)12
b(facility)f(can)i(be)f(used)g(to)g(distribute)f(data)h(and)g
(computation)f(as)225 841 y(needed)g(by)f(applications.)k(Object)d
(mobility)d(of)o(fers)k(slightly)c(more)j(\257exibility)m(,)f(since)g
(the)h(same)f(object)225 891 y(can)i(be)g(either)g(sent)f(by)g
(reference)j(or)d(moved;)g(while)g(with)g(our)h(system,)f(network)g
(objects)g(are)i(always)225 941 y(sent)c(by)h(reference)i(and)d(other)h
(objects)f(are)i(always)f(sent)f(by)h(copying.)k(However)n(,)d(this)e
(extra)h(\257exibility)225 991 y(doesn')o(t)i(seem)h(to)f(us)g(to)g(be)
g(worth)g(the)h(substantial)e(increase)i(in)f(complexity)f(of)h(mobile)
g(objects.)18 b(For)225 1041 y(example,)10 b(a)f(system)f(like)h
(Hermes[5],)h(though)f(designed)f(for)i(mobile)e(objects,)h(could)g(be)
g(implemented)225 1090 y(straightforwardly)h(with)h(our)g(mechanisms.)
267 1142 y Fi(Leveraging)d(general-purpose)f(str)n(eams.)14
b Fn(Our)8 b(whole)g(design)f(makes)h(heavy)g(use)g(of)g
(object-oriented)225 1191 y Fi(buffer)n(ed)i(str)n(eams)p
Fn(.)15 b(These)10 b(are)h(abstract)g(types)e(representing)h(buf)o
(fered)i(streams)e(in)f(which)h(the)h(method)225 1241
y(for)g(\256lling)g(the)g(buf)o(fer)h(\(in)f(the)g(case)g(of)h(input)e
(streams\))h(or)g(\257ushing)f(the)h(buf)o(fer)h(\(in)f(the)g(case)h
(of)f(output)225 1291 y(streams\))g(can)i(be)e(overridden)h(dif)o
(ferently)g(in)f(dif)o(ferent)h(subtypes.)j(The)d(representation)g(of)f
(the)h(buf)o(fer)225 1341 y(and)i(the)h(protocol)e(for)i(invoking)e
(the)h(\257ushing)g(and)h(\256lling)e(methods)h(are)h(common)e(to)h
(all)g(subtypes,)225 1391 y(so)g(that)h(generic)g(facilities)f(can)h
(deal)g(with)f(buf)o(fered)h(streams)f(ef)o(\256ciently)m(,)j
(independently)c(of)i(where)225 1440 y(the)e(bytes)g(are)i(coming)d
(from)i(or)f(going)g(to.)21 b(T)m(o)14 b(our)f(knowledge)g(these)g
(streams)g(were)i(\256rst)e(invented)225 1490 y(by)g(the)g(designers)g
(of)g(the)g(OS6)g(operating)g(system[26)o(].)21 b(In)13
b(Modula-3)g(they)f(are)i(called)g Fi(r)n(eaders)f Fn(and)225
1540 y Fi(writers)p Fn([18)o(].)267 1591 y(Because)d(we)g(use)g
(readers)g(and)g(writers,)g(our)g(interface)g(between)g(stubs)f(and)g
(protocol-speci\256c)h(com-)225 1641 y(munication)g(code)i(\(which)f
(we)h(call)f Fi(transports)p Fn(\))e(is)i(quite)g(simple.)k(This)10
b(choice)i(was)f(initially)f(contro-)225 1691 y(versial,)i(and)g
(viewed)g(as)g(a)h(likely)e(source)h(of)g(performance)h(problems.)k
(However)n(,)c(since)f(readers)h(and)225 1741 y(writers)g(are)h
Fi(buffer)n(ed)f Fn(streams,)g(it)g(is)f(still)g(possible)g(for)h(the)g
(stubs)f(to)h(operate)g(directly)g(on)g(the)g(buf)o(fer)225
1791 y(when)g(marshaling)f(and)h(unmarshaling)f(simple)g(types,)h(so)g
(there)g(is)g(not)f(much)h(loss)f(of)h(ef)o(\256ciency)h(for)225
1840 y(simple)d(calls.)18 b(And)11 b(for)i(ar)o(guments)e(that)h(need)g
(to)g(be)g(pickled,)h(it)e(is)h(a)g(further)h(simpli\256cation)d(that)i
(the)225 1890 y(streams)h(used)h(by)f(the)h(transport)f(interface)h
(are)h(of)f(the)f(same)h(type)f(as)h(those)f(assumed)g(by)g(the)h
(pickle)225 1940 y(package.)267 1991 y Fi(Marshaling)c(support)i(for)g
(str)n(eams.)19 b Fn(Inter)o(-process)13 b(byte)g(streams)f(are)i(more)
e(convenient)h(and)f(ef)o(\256-)225 2041 y(cient)7 b(than)h(RPC)h(for)f
(transferring)f(lar)o(ge)h(amounts)f(of)h(unstructured)e(data,)j(as)f
(critics)f(have)h(often)g(pointed)225 2091 y(out.)18
b(W)l(e)c(have)e(therefore)i(provided)e(special)g(marshaling)f(support)
h(for)h(Modula-3')m(s)f(standard)g(stream)225 2141 y(types)e(\(readers)
h(and)f(writers\).)16 b(W)l(e)11 b(marshal)f(readers)h(and)f(writers)g
(by)g(de\256ning)g(surrogate)h(readers)g(and)225 2190
y(writers)g(as)g(subtypes)f(of)h(the)g(abstract)g(stream)g(types.)j(T)m
(o)d(communicate)f(a)h(stream)g(from)g(one)g(program)225
2240 y(to)j(another)n(,)j(a)e(surrogate)g(stream)f(is)h(created)g(in)g
(the)f(receiving)h(program.)26 b(Data)15 b(is)f(copied)h(over)g(the)225
2290 y(network)c(between)h(the)f(buf)o(fers)h(of)f(the)g(real)h(stream)
f(and)h(the)f(surrogate)g(stream.)267 2341 y(Here)f(again)f(the)g
(prevalence)h(of)f(readers)h(and)f(writers)h(is)e(important:)13
b(the)c(stream)g(types)f(that)h(the)g(mar)o(-)225 2391
y(shaling)g(code)i(supports)e(are)j(not)e(some)g(new)g(kind)g(of)h
(stream)f(invented)g(for)g(marshaling)g(purposes,)g(but)1060
2516 y(2)p eop
%%Page: 3 11
3 10 bop 75 141 a Fn(exactly)11 b(the)g(readers)h(and)g(writers)f(used)
g(by)g(the)g(existing)f(public)g(interfaces)i(in)f(the)g(Modula-3)f
(library)m(.)117 191 y Fi(Distributed)e(garbage)i(collection.)k
Fn(Garbage)d(collection)e(is)h(a)h(valuable)f(tool)g(for)g(programming)
f(dis-)75 241 y(tributed)h(systems,)h(for)g(all)g(the)h(reasons)f(that)
g(apply)g(to)g(programs)f(that)h(run)h(in)e(a)i(single)f(address)g
(space.)75 291 y(Our)k(distributed)f(collector)h(allows)g(network)g
(objects)g(to)g(be)g(marshaled)g(freely)h(between)g(processes)75
340 y(without)11 b(fear)j(of)f(memory)f(leakage.)20 b(W)l(e)13
b(employ)f(a)h(fault-tolerant)f(and)h(ef)o(\256cient)h(algorithm)d(for)
i(dis-)75 390 y(tributed)d(garbage)i(collection)e(that)h(is)g(a)g
(generalization)g(of)g(reference)i(counting;)d(it)g(maintains)g(a)i
(set)f(of)75 440 y(identi\256ers)i(for)g(processes)g(with)g(references)
h(to)f(an)g(object.)21 b(Distributed)11 b(collection)i(is)f(driven)h
(by)g(the)75 490 y(local)g(collectors)f(in)g(each)i(process;)f(there)g
(is)g(no)f(need)h(for)g(global)f(synchronization.)19
b(Our)13 b(algorithm,)75 540 y(however)n(,)f(does)f(not)g(collect)g
(circular)h(structures)f(that)g(span)g(more)g(than)g(one)h(address)f
(space.)75 663 y Fk(1.1)50 b(Related)12 b(work)75 743
y Fn(W)l(e)j(have)f(built)e(closely)i(on)f(the)h(ideas)g(of)g
(Emerald[14)o(])g(and)g(SOS[25)q(];)h(our)e(main)h(contribution)e(has)
75 793 y(been)g(to)f(select)h(and)f(simplify)f(the)h(essential)g
(features)h(of)g(these)g(systems.)i(One)e(important)e(simpli\256ca-)75
843 y(tion)j(is)h(that)f(our)h(network)g(objects)g(are)h(not)e(mobile.)
23 b(Systems)13 b(like)h(Orca[2])h(and)f(Amber[7])g(aim)g(at)75
892 y(using)9 b(objects)h(to)g(obtain)g(performance)h(improvements)e
(on)h(a)h(multiprocessor)m(.)j(W)l(e)e(hope)e(that)g(our)g(de-)75
942 y(sign)j(can)g(be)h(used)f(in)g(this)f(way)m(,)j(but)e(our)g(main)g
(goal)g(was)g(to)g(provide)g(reliable)g(distributed)f(services,)75
992 y(and)j(consequently)f(our)h(system)f(is)g(quite)h(dif)o(ferent.)27
b(For)15 b(example,)h(the)f(implementations)e(of)i(Orca)75
1042 y(and)d(Amber)g(described)h(in)e(the)i(literature)f(require)g
(more)h(homogeneity)d(than)i(we)h(can)f(assume.)18 b(\(Rus-)75
1092 y(tan)12 b(Leino)g(has)g(implemented)f(a)i(version)e(of)i
(Modula-3)e(network)h(objects)g(on)g(the)g(Caltech)h(Mosaic,)f(a)75
1142 y(\256ne-grained)g(mesh)f(multiprocessor[15)n(].)16
b(But)11 b(we)h(will)e(not)h(describe)h(his)f(work)g(here.\))117
1191 y(Systems)6 b(like)i(Ar)o(gus[16)o(,)g(17])g(and)f(Arjuna[8])h
(are)g(like)g(network)f(objects)g(in)g(that)g(they)g(aim)g(to)h
(support)75 1241 y(the)k(programming)e(of)i(reliable)g(distributed)e
(services.)18 b(However)n(,)13 b(they)e(dif)o(fer)i(from)f(network)f
(objects)75 1291 y(by)j(providing)e(lar)o(ger)j(building)d(blocks,)i
(such)g(as)g(stable)g(state)g(and)f(multi-machine)g(atomic)g(transac-)
75 1341 y(tions,)d(and)g(are)h(oriented)f(to)g(objects)g(that)f(are)i
(implemented)e(by)h(whole)g(address)g(spaces.)16 b(Our)10
b(network)75 1391 y(objects)h(are)h(more)f(primitive)f(and)h
(\256ne-grained.)117 1440 y(The)f(Spring)g Fi(subcontract)f
Fn(is)h(an)h(intermediary)f(between)h(a)f(distributed)f(application)h
(and)g(the)g(under)o(-)75 1490 y(lying)f(object)h(runtime[1)n(1)o(].)16
b(For)10 b(example,)h(switching)e(the)h(subcontract)g(can)g(control)g
(whether)g(objects)75 1540 y(are)j(replicated.)20 b(A)12
b(derivative)h(of)f(this)g(idea)h(has)f(been)h(incorporated)f(into)g
(the)h Fi(object)f(adaptor)f Fn(of)i(the)75 1590 y(Common)c(Object)h
(Request)g(Broker)h(Architecture[19)q(].)k(W)l(e)c(haven')o(t)f(aimed)g
(at)g(such)g(a)g(\257exible)h(struc-)75 1640 y(ture,)j(although)e(our)i
(highly)e(modular)g(structure)i(allows)e(playing)h(some)f(similar)h
(tricks,)g(for)h(example)75 1689 y(by)d(building)f(custom)g
(transports.)75 1812 y Fk(1.2)50 b(De\256nitions)75 1893
y Fn(A)9 b(Modula-3)f Fi(object)g Fn(is)g(a)h(reference)i(to)d(a)i
(data)e(record)i(paired)f(with)f(a)h(method)f(suite.)14
b(The)9 b(method)e(suite)75 1943 y(is)12 b(a)h(record)h(of)f
(procedures)g(that)f(accept)h(the)g(object)f(itself)g(as)h(a)g(\256rst)
g(parameter)m(.)21 b(A)13 b(new)g(object)f(type)75 1993
y(can)f(be)g(de\256ned)g(as)g(a)g Fi(subtype)f Fn(of)h(an)g(existing)e
(type,)i(in)f(which)g(case)i(objects)e(of)g(the)h(new)g(type)f(have)h
(all)75 2042 y(the)e(methods)f(of)h(the)g(old)f(type,)i(and)f(possibly)
e(new)i(ones)g(as)g(well)g(\(inheritance\).)15 b(The)9
b(subtype)g(can)g(also)75 2092 y(provide)j(new)h(implementations)e(for)
i(selected)g(methods)e(of)i(the)g(supertype)f(\(overriding\).)20
b(Modula-3)75 2142 y(objects)12 b(are)h(always)g(references,)h(and)f
(multiple)e(inheritance)h(is)g(not)g(supported.)18 b(A)12
b(Modula-3)g(object)75 2192 y(includes)f(a)g(typecode)h(that)e(can)i
(be)g(tested)f(to)g(determine)g(its)f(type)h(dynamically[18)o(].)117
2242 y(A)e Fi(network)g(object)g Fn(is)g(an)h(object)f(whose)g(methods)
f(can)i(be)f(invoked)g(by)g(other)g(programs,)h(in)f(addition)75
2291 y(to)h(the)g(program)g(that)f(allocated)h(the)g(object.)15
b(The)c(program)e(invoking)g(the)h(method)f(is)h(called)g(the)g
Fi(client)75 2341 y Fn(and)h(the)g(program)g(containing)f(the)h
(network)f(object)h(is)g(called)g(the)g Fi(owner)p Fn(.)k(The)c(client)
g(and)g(owner)g(can)75 2391 y(be)h(running)e(on)h(dif)o(ferent)h
(machines)f(or)g(in)g(dif)o(ferent)h(address)f(spaces)h(on)f(the)g
(same)g(machine.)910 2516 y(3)p eop
%%Page: 4 12
4 11 bop 267 141 a Fn(A)10 b(remote)g(reference)i(in)e(a)g(client)g
(program)g(actually)g(points)f(to)h(a)g(local)g(object)g(whose)g
(methods)f(per)o(-)225 191 y(form)14 b(remote)h(procedure)g(calls)f(to)
h(the)f(owner)n(,)i(where)f(the)g(corresponding)f(method)f(of)i(the)f
(owner)r(')m(s)225 241 y(object)d(is)g(invoked.)16 b(The)c(client)f
(program)g(need)h(not)f(know)g(whether)h(the)g(method)e(invocation)h
(is)g(local)225 291 y(or)g(remote.)16 b(The)11 b(local)g(object)g(is)g
(called)h(a)g Fi(surr)n(ogate)e Fn(\(also)h(known)g(as)g(a)h(proxy\).)
267 344 y(The)d(surrogate)h(object')m(s)g(type)f(will)g(be)h(declared)g
(by)g(a)g(stub)f(generator)h(rather)g(than)g(written)f(by)g(hand.)225
394 y(This)f(type)g(declaration)h(includes)f(the)g(method)g(overrides)h
(that)f(are)h(analogous)f(to)h(a)g(conventional)e(client)225
444 y(stub)i(module.)14 b(There)d(are)f(three)h(object)e(types)h(to)f
(keep)h(in)g(mind:)j(the)c(network)h(object)g(type)f
Fh(T)h Fn(at)g(which)225 493 y(the)i(stub)e(generator)i(is)g(pointed;)e
(the)i(surrogate)f(type)h Fh(TSrg)f Fn(produced)h(by)f(the)g(stub)g
(generator)n(,)i(which)225 543 y(is)c(a)g(subtype)f(of)h
Fh(T)g Fn(with)f(method)h(overrides)g(that)f(perform)h(RPC)i(calls;)e
(and)g(the)g(type)g Fh(TImpl)f Fn(of)h(the)g(real)225
593 y(object)j(allocated)h(in)f(the)h(owner)n(,)g(also)g(a)g(subtype)f
(of)g Fh(T)p Fn(.)h(The)g(type)f Fh(T)h Fn(is)f(required)h(to)f(be)h(a)
g Fi(pur)n(e)g Fn(object)225 643 y(type;)c(that)g(is,)g(it)f(declares)i
(methods)e(only)m(,)h(no)f(data)h(\256elds.)15 b(The)9
b(type)g Fh(TImpl)f Fn(generally)h(extends)g Fh(T)f Fn(with)225
693 y(appropriate)j(data)h(\256elds.)267 746 y(If)g(program)f
Fh(A)h Fn(has)g(a)g(reference)i(to)d(a)i(network)e(object)h(owned)f(by)
h(program)f Fh(B)p Fn(,)i(then)e Fh(A)h Fn(can)g(pass)g(the)225
796 y(reference)f(to)e(a)h(third)f(program)g Fh(C)p Fn(,)h(after)g
(which)f Fh(C)h Fn(can)g(call)f(the)g(methods)g(of)g(the)g(object,)h
(just)f(as)g(if)h(it)f(had)225 846 y(obtained)g(the)g(reference)j
(directly)d(from)g(the)h(owner)g Fh(B)p Fn(.)g(This)e(is)h(called)h(a)g
Fi(thir)n(d)f(party)g(transfer)f Fn(.)15 b(In)10 b(most)225
895 y(conventional)g(RPC)i(systems,)e(third)g(party)h(transfers)g(are)g
(problematical;)f(with)g(network)h(objects)f(they)225
945 y(work)h(transparently)m(,)h(as)f(we)h(shall)e(see.)267
998 y(For)e(example,)g(if)g(a)g(network)g(node)f(of)o(fers)i(many)e
(services,)i(instead)e(of)h(running)f(all)g(the)h(servers)g(it)f(may)
225 1048 y(run)i(a)h(daemon)f(that)g(accepts)g(a)h(request)f(and)g
(starts)g(the)g(appropriate)h(server)m(.)15 b(Some)10
b(RPC)g(systems)e(have)225 1098 y(special)k(semantics)f(to)g(support)g
(this)g(arrangement,)i(but)e(third-party)g(transfers)i(are)f(all)g
(that)f(is)h(needed:)225 1148 y(the)h(daemon)g(can)h(return)f(to)g(the)
g(client)g(an)h(object)f(owned)g(by)g(the)g(server)h(it)f(has)g
(started;)h(subsequent)225 1198 y(calls)d(by)g(the)g(client)g(will)g
(be)g(executed)h(in)f(the)g(server)m(.)267 1251 y(When)j(a)h(client)f
(\256rst)g(receives)h(a)g(reference)h(to)e(a)h(given)f(network)g
(object,)i(either)e(from)g(the)h(owner)225 1301 y(or)f(from)f(a)g
(third)g(party)m(,)h(an)g(appropriate)f(surrogate)h(is)f(created)h(by)f
(the)g(unmarshaling)g(code.)22 b(Care)14 b(is)225 1351
y(required)e(on)f(several)g(counts.)267 1404 y(First,)j(dif)o(ferent)g
(nodes)f(in)g(the)h(network)f(may)g(use)h(dif)o(ferent)g(underlying)f
(communications)e(meth-)225 1454 y(ods)h(\(transports\).)18
b(T)m(o)12 b(create)i(the)e(surrogate,)h(the)f(code)h(in)f(the)g
(client)g(must)f(select)i(a)f(transport)g(that)g(is)225
1504 y(shared)i(by)g(the)g(client)g(and)g(owner)o(\320and)g(this)f
(selection)g(must)g(be)h(made)g(in)g(the)g(client)g(before)g(it)g(has)
225 1553 y(communicated)c(with)h(the)g(owner)m(.)267
1607 y(Second,)16 b(the)e(type)h(of)g(the)f(surrogate)h(must)e(be)i
(selected.)26 b(That)14 b(is,)i(we)f(must)e(determine)h(the)h(type)225
1657 y Fh(TSrg)c Fn(corresponding)f(to)h(the)g(type)f
Fh(TImpl)h Fn(of)g(the)g(real)g(object)g(in)g(the)g(owner)m(.)16
b(But)11 b(there)g(can)h(be)f(more)225 1706 y(than)e(one)h(possible)e
(surrogate)h(type)h(available)f(in)g(the)g(client,)h(since)g
Fh(TSrg)f Fn(is)g(not)g(uniquely)f(determined)225 1756
y(by)13 b Fh(TImpl)p Fn(.)19 b(As)13 b(we)g(shall)g(see,)h(this)e
(situation)f(arises)i(quite)f(commonly)g(when)g(new)h(versions)g(of)g
(net-)225 1806 y(work)f(interfaces)g(are)g(released.)18
b(The)11 b(ambiguity)f(is)h(resolved)h(by)f(the)h Fi(narr)n(owest)f
(surr)n(ogate)g(rule)p Fn(:)k(the)225 1856 y(surrogate)f(will)f(have)h
(the)g(most)f(speci\256c)h(type)g(of)g(all)g(surrogate)f(types)h(that)f
(are)i(consistent)e(with)g(the)225 1906 y(type)c(of)h(the)g(object)f
(in)g(the)h(owner)g(and)g(for)g(which)f(stubs)g(are)h(available)g(in)f
(the)h(client)f(and)h(in)f(the)h(owner)m(.)225 1955 y(This)h(rule)g(is)
g(unambiguous)e(because)j(Modula-3)f(has)g(single)g(inheritance)g(only)
m(.)267 2009 y(Since)g(the)g(type)g(of)g(the)g(surrogate)g(depends)g
(on)g(what)g(stubs)f(have)h(been)g(registered)h(in)e(the)h(owner)h(as)
225 2059 y(well)g(as)g(in)f(the)h(client,)g(it)g(can')o(t)g(be)h
(determined)e(statically)m(.)17 b(A)12 b(runtime)f(type)g(test)h(will)f
(almost)g(always)225 2108 y(be)h(necessary)f(after)h(the)g(surrogate)f
(is)g(created.)225 2254 y Fk(1.3)50 b(Examples)225 2341
y Fn(The)12 b(narrowest)g(surrogate)f(rule)h(is)g(useful)f(when)h
(network)f(interfaces)i(change)f(over)g(time,)f(as)h(they)f(al-)225
2391 y(ways)d(do.)14 b(This)7 b(section)g(presents)g(some)g(examples)h
(to)f(illustrate)g(this)f(utility)m(.)13 b(The)8 b(examples)f(also)g
(show)1060 2516 y(4)p eop
%%Page: 5 13
5 12 bop 75 141 a Fn(how)9 b(network)g(objects)g(generalize)i(and)e
(simplify)f(features)i(of)g(conventional)e(RPC.)j(The)f(examples)f(are)
75 191 y(based)i(on)g(the)h(following)e(trivial)g(interface)i(to)f(a)h
(\256le)g(service:)175 297 y Fh(INTERFACE)24 b(FS;)175
371 y(IMPORT)g(NetObj;)175 446 y(TYPE)224 490 y(File)h(=)g(NetObj.T)f
(OBJECT)g(METHODS)274 533 y(getChar\(\):)g(CHAR;)274
577 y(eof\(\):)h(BOOLEAN)224 620 y(END;)224 664 y(Server)g(=)g
(NetObj.T)f(OBJECT)g(METHODS)274 707 y(open\(name:)g(TEXT\):)h(File)224
751 y(END;)175 832 y(END)f(FS.)75 916 y Fn(The)13 b(interface)h(above)g
(is)f(written)f(in)h(Modula-3.)21 b(It)13 b(declares)h(object)f(types)g
Fh(FS.File)p Fn(,)h(a)f(subtype)g(of)75 966 y Fh(NetObj.T)g
Fn(extended)g(with)g(two)h(methods,)f(and)h Fh(FS.Server)p
Fn(,)f(a)h(subtype)f(of)h Fh(NetObj.T)f Fn(with)g(one)75
1015 y(extra)g(method.)18 b(Any)12 b(data)h(\256elds)g(would)e(go)i
(between)f Fh(OBJECT)h Fn(and)f Fh(METHODS)p Fn(,)g(but)g(these)h
(types)f(are)75 1065 y(pure.)24 b(It)15 b(is)e(conventional)g(to)h
(name)g(the)h(principal)e(type)h(in)g(an)g(interface)h
Fh(T)p Fn(;)f(thus)g Fh(NetObj.T)f Fn(is)h(the)75 1115
y(principal)d(type)g(in)g(the)g Fh(NetObj)g Fn(interface.)117
1168 y(In)i(our)h(design,)g(all)f(network)g(objects)g(are)i(subtypes)d
(of)i(the)g(type)f Fh(NetObj.T)p Fn(.)g(Thus)g(the)h(interface)75
1218 y(above)e(de\256nes)h(two)f(network)g(object)g(types,)g(one)g(for)
h(opening)e(\256les,)i(the)g(other)f(for)g(reading)h(them.)k(If)75
1268 y(the)c(stub)g(generator)h(is)f(pointed)g(at)h(the)f(interface)h
Fh(FS)p Fn(,)g(it)f(produces)h(a)g(module)e(containing)h(client)g(and)
75 1317 y(server)f(stubs)e(for)i(both)f(types.)117 1370
y(Here)h(is)f(a)g(sketch)g(of)h(an)f(implementation)e(of)j(the)f
Fh(FS)g Fn(interface:)175 1476 y Fh(MODULE)24 b(Server)g(EXPORTS)h
(Main;)175 1551 y(IMPORT)f(NetObj,)g(FS;)175 1625 y(TYPE)224
1669 y(File)h(=)g(FS.File)f(OBJECT)274 1712 y(<buffers,)g(etc.>)224
1756 y(OVERRIDES)274 1800 y(getChar)h(:=)f(GetChar;)274
1843 y(eof)h(:=)g(Eof)224 1887 y(END;)224 1930 y(Svr)g(=)g(FS.Server)f
(OBJECT)274 1974 y(<directory)g(cache,)h(etc.>)224 2018
y(OVERRIDES)274 2061 y(open)g(:=)g(Open)224 2105 y(END;)175
2179 y(<code)f(for)h(GetChar,)f(Eof,)g(and)h(Open>;)175
2254 y(BEGIN)224 2298 y(NetObj.Export\(NEW\(Svr\),)e("FS1"\);)224
2341 y(<pause)i(indefinitely>)175 2391 y(END)f(Server.)910
2516 y Fn(5)p eop
%%Page: 6 14
6 13 bop 225 141 a Fn(The)10 b(call)g Fh(NetObj.Export\(obj,)24
b(nm\))10 b Fi(exports)f Fn(the)h(network)g(object)g
Fh(obj)p Fn(;)g(that)g(is,)g(it)g(places)g(a)h(ref-)225
191 y(erence)h(to)e(it)h(in)f(a)h(table)g(under)g(the)g(name)g
Fh(nm)p Fn(,)g(whence)g(clients)f(can)i(retrieve)f(it.)k(The)c(table)f
(is)h(typically)225 241 y(contained)g(in)g(an)g Fi(agent)g
Fn(process)h(running)e(on)h(the)g(same)h(machine)f(as)g(the)g(server)m
(.)267 292 y(Here)h(is)f(a)g(client,)g(which)h(assumes)e(that)h(the)g
(server)h(is)f(running)g(on)g(a)g(machine)g(named)h Fh(server)p
Fn(:)325 391 y Fh(MODULE)24 b(Client)g(EXPORTS)h(Main;)374
434 y(IMPORT)g(NetObj,)f(FS,)h(IO;)325 505 y(VAR)374
549 y(s:)g(FS.Server)f(:=)h(NetObj.Import\("FS1",)e
(NetObj.Locate\("server"\)\);)374 593 y(f)i(:=)g
(s.open\("/usr/dict/words"\);)325 664 y(BEGIN)374 707
y(WHILE)g(NOT)g(f.eof\(\))f(DO)g(IO.PutChar\(f.getChar\(\)\);)f(END)325
757 y(END)h(Client.)225 836 y Fn(The)10 b(call)g Fh
(NetObj.Locate\(nm\))e Fn(returns)i(a)g(handle)g(on)f(the)h(agent)g
(process)g(running)f(on)g(the)h(machine)225 886 y(named)j
Fh(nm)p Fn(.)20 b(The)13 b(call)g(to)g Fh(NetObj.Import)f
Fn(returns)h(the)g(network)f(object)h(stored)g(in)f(the)h(agent')m(s)g
(ta-)225 935 y(ble)h(under)f(the)h(name)g Fh(FS1)p Fn(;)g(in)g(our)f
(example)h(this)f(will)g(be)h(the)f Fh(Svr)h Fn(object)f(exported)h(by)
g(the)f(server)m(.)225 985 y Fh(Import)p Fn(,)e Fh(Export)p
Fn(,)h(and)f Fh(Locate)g Fn(are)h(described)f(further)h(in)f(the)g
(section)g(below)g(on)g(bootstrapping.)267 1036 y(The)j(client)h
(program)f(invokes)g(the)h(remote)g(methods)e Fh(s.open)p
Fn(,)j Fh(f.getChar)p Fn(,)f(and)g Fh(f.eof)p Fn(.)26
b(The)225 1086 y(network)14 b(object)h Fh(s)g Fn(was)f(exported)h(by)f
(name,)i(using)e(the)h(agent)f(running)g(on)h(the)f(machine)h
Fh(server)p Fn(.)225 1136 y(But)d(the)g(object)g Fh(f)g
Fn(is)g(anonymous;)f(that)g(is,)h(it)g(is)g(not)f(present)h(in)g(any)g
(agent)g(table.)18 b(The)12 b(vast)g(majority)225 1186
y(of)f(network)h(objects)e(are)i(anonymous;)e(only)h(those)g
(representing)g(major)g(services)g(are)h(named.)267 1237
y(For)d(comparison,)g(here)g(is)g(the)f(same)h(functionality)e(as)i(it)
f(would)h(be)g(implemented)e(with)h(an)h(RPC)h(that)225
1287 y(is)h(not)g(object-oriented,)h(such)f(as)h(DCE)g(RPC[20)q(].)17
b(The)11 b(interface)i(would)d(de\256ne)j(a)f(\256le)g(as)f(an)h
Fi(opaque)225 1337 y(type)p Fn(:)325 1435 y Fh(INTERFACE)24
b(FS;)325 1506 y(TYPE)g(T;)325 1578 y(PROC)g(Open\(n:)g(TEXT\):)h(T;)
325 1621 y(PROC)f(GetChar\(f:)g(T\):)h(CHAR;)325 1665
y(PROC)f(Eof\(f:)h(T\):)f(BOOL;)325 1742 y(END)g(FS.)225
1821 y Fn(A)11 b(conventional)g(RPC)i(stub)d(generator)i(would)f
(transform)g(this)f(interface)i(into)f(a)g(client)g(stub,)g(a)h(server)
225 1871 y(stub,)f(and)g(a)h(modi\256ed)f(client)g(interface)h
(containing)e(explicit)g(binding)g(handles:)325 1969
y Fh(INTERFACE)24 b(FSClient;)325 2041 y(IMPORT)g(FS;)325
2112 y(TYPE)g(Binding;)325 2183 y(PROCEDURE)g(Import\(hostName:)f
(TEXT\):)h(Binding;)325 2226 y(PROCEDURE)g(Open\(b:)g(Binding,)g(n:)h
(TEXT\):)f(FS.T;)325 2270 y(PROCEDURE)g(GetChar\(b:)g(Binding,)g(f:)h
(FS.T\):)f(CHAR;)325 2314 y(PROCEDURE)g(Eof\(b:)g(Binding,)g(f:)h
(FS.T\):)f(BOOL;)325 2391 y(END)g(FSClient.)1060 2516
y Fn(6)p eop
%%Page: 7 15
7 14 bop 75 141 a Fn(The)8 b(server)h(would)e(implement)f(the)i
Fh(FS)g Fn(interface)g(and)g(the)g(client)f(would)h(use)f(the)h
Fh(FSClient)g Fn(interface.)75 191 y(In)13 b Fh(FSClient)p
Fn(,)g(the)f(type)h Fh(Binding)f Fn(represents)h(a)g(handle)f(on)h(a)g
(server)g(exporting)f(the)h Fh(FS)g Fn(interface,)75
241 y(and)h(the)f(type)g Fh(T)h Fn(represents)g(a)g(so-called)f
Fi(context)h(handle)f Fn(on)g(an)h(open)f(\256le)h(in)f(one)h(of)f
(these)h(servers.)75 291 y(Here)e(is)f(the)g(same)g(client)g
(computation)f(coded)i(using)e(the)h(conventional)f(version:)175
377 y Fh(MODULE)24 b(Client;)175 442 y(IMPORT)g(FSClient,)g(IO;)175
507 y(VAR)224 551 y(b)h(:=)g(FSClient.Import\("server"\);)224
594 y(f)g(:=)g(FSClient.Open\(b,)e("/usr/dict/words"\);)175
638 y(BEGIN)224 682 y(WHILE)i(NOT)g(FSClient.Eof\(b,)e(f\))i(DO)274
725 y(IO.PutChar\(FSClient.GetChar\(b,)d(f\)\))224 769
y(END)175 819 y(END)i(Client.)75 890 y Fn(Comparing)10
b(the)h(two)f(versions,)h(we)g(see)g(that)g(the)g(network)f(object)h
Fh(s)f Fn(plays)h(the)f(role)h(of)g(the)g(binding)e Fh(b)p
Fn(,)75 940 y(and)h(the)h(network)f(object)g Fh(f)g Fn(plays)g(the)g
(role)h(of)f(the)g(context)g(handle)g Fh(f)p Fn(.)16
b(Network)10 b(objects)g(subsume)f(the)75 990 y(two)i(notions)f(of)h
(binding)f(and)i(context)e(handle.)117 1039 y(In)f(the)g(conventional)f
(version,)i(the)f(signatures)f(of)h(the)g(procedures)h(in)f
Fh(FSClient)f Fn(dif)o(fer)i(from)f(those)75 1089 y(in)g
Fh(FS)p Fn(,)h(because)g(the)f(binding)f(must)g(be)h(passed.)15
b(Thus)9 b(the)g(signature)g(is)g(dif)o(ferent)h(for)f(local)g(and)h
(remote)75 1139 y(calls.)k(\(In)8 b(this)f(example,)i(DCE)f(RPC)h
(could)e(infer)h(the)g(binding)e(from)i(the)f(context)h(handle,)g
(allowing)f(the)75 1189 y(signatures)k(to)h(be)g(preserved;)g(but)g
(the)f(DCE)i(programmer)e(must)g(be)h(aware)h(of)f(both)g(notions.\))k
(More-)75 1239 y(over)n(,)d(although)e(conventional)h(systems)f(tend)h
(to)g(allow)f(bindings)g(to)h(be)g(communicated)g(freely)m(,)h(they)75
1288 y(don')o(t)e(do)h(the)f(same)h(for)g(context)f(handles:)k(It)d(is)
f(an)h(error)g(\(which)g(the)g(system)e(must)h(detect\))h(to)f(pass)g
(a)75 1338 y(context)g(handle)g(to)g(any)g(server)h(but)f(the)g(one)h
(that)e(created)j(it.)117 1388 y(The)8 b(conventional)f(version)g
(becomes)h(even)g(more)g(awkward)h(when)f(the)f(same)h(address)g(space)
h(is)e(both)75 1438 y(a)12 b(client)g(and)g(a)h(server)f(of)g(the)g
(same)g(interface.)19 b(In)12 b(our)g Fh(FS)g Fn(example,)h(for)f
(example,)h(a)f(server)h(address)75 1488 y(space)c(must)e(instantiate)g
(the)h(opaque)g(type)g Fh(FS.T)g Fn(to)f(a)i(concrete)g(type)f
(containing)f(the)h(buf)o(fers)h(and)f(other)75 1537
y(data)k(representing)h(an)f(open)g(\256le.)19 b(On)12
b(the)h(other)f(hand,)h(a)f(client)g(address)h(space)g(must)e
(instantiate)g(the)75 1587 y(opaque)h(type)g Fh(FS.T)f
Fn(to)h(a)g(concrete)h(type)e(representing)h(a)g(context)g(handle.)17
b(\(This)11 b(type)h(is)f(declared)i(in)75 1637 y(the)f(client)g(stub)f
(module.\))18 b(These)12 b(con\257icting)g(requirements)g(make)g(it)g
(dif)o(\256cult)g(for)h(a)f(single)g(address)75 1687
y(space)f(to)f(be)h(both)f(a)h(client)f(and)h(a)g(server)g(of)g(the)g
(same)f(interface.)16 b(This)10 b(problem)g(is)g(called)h
Fi(type)g(clash)p Fn(.)75 1737 y(It)f(can)h(be)g(\256nessed)g(by)f
(compromising)f(on)h(type)g(safety;)h(but)f(the)g(network)g(object)g
(solution)f(avoids)h(the)75 1787 y(problem)h(neatly)g(and)g(safely)m(.)
117 1847 y(Object)f(subtyping)e(together)i(with)g(the)g(narrowest)h
(surrogate)f(rule)h(make)f(it)g(easy)g(to)g(ship)g(a)h(new)f(ver)o(-)75
1897 y(sion)f(of)h(the)g(server)h(that)f(supports)f(both)g(old)h(and)g
(new)g(clients,)g(at)g(least)g(in)g(the)g(common)f(case)h(in)g(which)75
1947 y(the)h(only)g(changes)g(are)h(to)f(add)g(additional)f(methods.)k
(For)e(example,)f(suppose)g(that)g(we)g(want)g(to)g(ship)f(a)75
1997 y(new)i(\256le)h(server)f(in)g(which)g(the)g(\256les)g(have)h(a)f
(new)g(method)f(called)i Fh(close)p Fn(.)k(First,)12
b(we)h(de\256ne)g(the)f(new)75 2046 y(type)f(as)g(an)h(extension)e(of)i
(the)f(old)g(type:)175 2133 y Fh(TYPE)224 2177 y(NewFS.File)24
b(=)h(FS.File)f(OBJECT)h(METHODS)274 2220 y(close\(\))224
2270 y(END;)75 2341 y Fn(Since)15 b(an)f(object)f(of)h(type)g
Fh(NewFS.File)f Fn(includes)g(all)h(the)g(methods)f(of)h(an)g
Fh(FS.File)p Fn(,)g(the)g(stub)f(for)75 2391 y(a)i Fh(NewFS.File)e
Fn(is)h(also)g(a)h(stub)f(for)h(an)f Fh(FS.File)p Fn(.)24
b(When)15 b(a)g(new)f(client\320that)g(is,)h(a)g(client)e(linked)910
2516 y(7)p eop
%%Page: 8 16
8 15 bop 225 141 a Fn(with)10 b(stubs)g(for)h(the)f(new)h
(type\320opens)f(a)h(\256le,)h(it)e(will)g(get)g(a)h(surrogate)g(of)g
(type)f Fh(NewFS.File)p Fn(,)h(and)g(be)225 191 y(able)j(to)f(invoke)g
(its)f Fh(close)h Fn(method.)21 b(When)14 b(an)g(old)f(client)g(opens)g
(a)h(\256le,)g(it)f(will)g(get)g(a)h(surrogate)g(of)225
241 y(type)e Fh(FS.File)p Fn(,)g(and)g(will)f(be)h(able)g(to)f(invoke)h
(only)f(its)g Fh(getChar)g Fn(and)h Fh(eof)g Fn(methods.)k(A)c(new)g
(client)225 291 y(dealing)f(with)f(an)i(old)f(server)h(must)e(do)h(a)h
(runtime)e(type)h(test)g(to)g(check)h(the)f(type)g(of)h(its)e
(surrogate.)267 341 y(The)g(extreme)g(case)h(of)g(the)f(narrowest)h
(surrogate)f(rule)g(occurs)h(when)f(a)h(network)f(object)g(is)g
(imported)225 390 y(into)h(a)h(program)g(that)g(has)g(no)f(stubs)g
(linked)g(into)h(it)f(at)h(all.)17 b(In)12 b(this)f(case)i(the)f
(surrogate)g(will)f(have)h(type)225 440 y Fh(NetObj.T)p
Fn(,)i(since)g(every)h(program)f(automatically)f(gets)h(\(empty\))g
(stubs)f(for)i(this)e(type.)25 b(Y)-5 b(ou)14 b(might)225
490 y(think)9 b(that)h(a)h(surrogate)f(of)g(type)g Fh(NetObj.T)g
Fn(is)g(useless,)g(since)g(it)g(has)g(no)g(methods.)k(But)d(the)f
(surrogate)225 540 y(can)h(be)g(passed)g(on)g(to)f(another)h(program,)g
(where)h(its)e(type)g(can)i(become)e(more)h(speci\256c.)16
b(For)c(example,)225 590 y(the)j(agent)g(process)g(that)f(implements)g
Fh(NetObj.Import)g Fn(and)h Fh(NetObj.Export)e Fn(is)i(a)g(trivial)g
(one-)225 639 y(page)9 b(program)f(containing)g(a)h(table)f(of)h
(objects)f(of)g(type)h Fh(NetObj.T)p Fn(.)f(The)h(agent)f(needs)h(no)f
(information)225 689 y(about)13 b(the)g(actual)h(subtypes)e(of)h(these)
h(objects,)g(since)f(it)g(doesn')o(t)g(call)g(their)g(methods,)g(it)g
(only)g(passes)225 739 y(them)e(to)g(third)f(parties.)225
865 y Fk(1.4)50 b(Failur)o(e)13 b(semantics)g(and)e(alerts)225
946 y Fn(An)f(ordinary)h(procedure)g(call)f(has)h(no)f(special)h
(provision)e(for)i(notifying)e(the)h(caller)h(that)f(the)h(callee)g
(has)225 996 y(crashed,)16 b(since)f(the)f(caller)h(and)g(the)f(callee)
h(are)h(the)e(same)h(program.)25 b(But)14 b(a)h(remote)g(procedure)g
(call)225 1045 y(mechanism)e(must)f(de\256ne)j(some)e
Fi(failur)n(e)f(semantics)h Fn(that)g(cover)h(this)f(situation,)g(in)g
(order)h(to)g(make)f(it)225 1095 y(possible)d(to)h(program)g(reliable)h
(applications.)267 1145 y(In)i(theory)m(,)i(distributed)d(computations)
g(can)i(be)g(more)g(reliable)g(than)f(centralized)h(ones,)h(since)f(if)
f(a)225 1195 y(machine)g(crashes,)h(the)f(program)g(can)h(shift)e(the)h
(computation)e(to)i(use)g(other)g(machines)g(that)f(are)i(still)225
1245 y(working.)21 b(But)13 b(it)g(isn')o(t)f(easy)i(to)f(put)f(this)h
(theory)g(into)f(practice.)22 b(Many)13 b(distributed)f(systems)g(end)h
(up)225 1295 y(being)c Fi(less)g Fn(reliable)g(than)g(their)g
(centralized)h(equivalents,)f(because)h(they)f(are)h(vulnerable)f(to)g
(the)g(failure)225 1344 y(of)j(many)g(machines)g(instead)f(of)i(just)e
(one.)18 b(Leslie)12 b(Lamport,)g(prominent)f(both)h(as)g(a)h(theorist)
e(and)h(as)g(a)225 1394 y(suf)o(fering)h(user)n(,)i(has)e(facetiously)g
(de\256ned)h(a)f(distributed)f(system)g(as)i(one)f(in)g(which)g
(\252the)g(failure)h(of)f(a)225 1444 y(computer)e(you)g(didn')o(t)f
(even)i(know)f(existed)g(can)h(render)g(your)f(own)g(computer)g
(unusable\272.)267 1494 y(Many)h(methodologies)f(and)i(tools)f(have)i
(been)f(proposed)g(to)f(aid)h(in)g(programming)f(replicated)h(dis-)225
1544 y(tributed)g(services)h(that)f(survive)g(the)g(failures)h(of)g
(individual)e(replicas.)22 b(Our)14 b(network)f(object)h(system)225
1594 y(is)c(intended)f(to)h(provide)f(a)i(more)f(fundamental)f
(communications)f(primitive:)13 b(replicated)d(services)g(can)225
1643 y(be)i(built)e(out)g(of)i(network)f(objects,)g(but)g(so)g(can)h
(non-replicated)f(services.)267 1693 y(The)j(failure)h(semantics)e(of)i
(network)f(objects)g(are)h(similar)e(to)i(those)e(of)i(many)f
(conventional)f(RPC)225 1743 y(systems.)j(The)d(runtime)e(raises)h(the)
g(exception)g Fh(NetObj.Error)f Fn(in)g(the)h(client)g(if)g(the)g
(owner)g(crashes)225 1793 y(while)c(the)g(method)g(call)g(is)g(in)g
(progress.)14 b(Therefore,)c(in)e(serious)g(applications,)g(all)g
(methods)g(of)g(network)225 1843 y(objects)13 b(should)f(include)i
(this)e(exception)h(in)h(their)f Fh(RAISES)g Fn(set.)22
b(\(Failure)14 b(to)g(include)f(the)g(exception)225 1893
y(would)d(cause)i(the)f(client)g(to)f(crash)i(in)f(this)f(situation,)g
(which)h(is)f(usually)h(not)f(what)h(you)g(want)g(a)g(serious)225
1943 y(application)f(to)h(do.\))267 1993 y(Unfortunately)m(,)i(there)g
(is)f(no)h(absolutely)f(reliable)h(way)g(that)f(one)h(machine)g(can)g
(tell)g(if)g(another)g(has)225 2042 y(crashed,)i(since)f(the)g
(communication)e(network)i(can)g(fail,)h(and)f(a)g(live)g(machine)f
(can')o(t)i(distinguish)c(it-)225 2092 y(self)f(from)f(a)h(dead)g
(machine)f(if)h(it)f(cannot)h(communicate.)k(Therefore,)d(the)f
(exception)f Fh(NetObj.Error)225 2142 y Fn(doesn')o(t)j(guarantee)g
(that)f(the)h(owner)g(has)g(crashed:)k(possibly)10 b(communication)g
(has)i(failed.)17 b(In)12 b(the)g(lat-)225 2192 y(ter)g(case,)g(the)f
(method)f(call)i(in)f(the)g(owner)g(may)g(continue)g(to)g(execute,)h
(even)g(while)f(the)g(client)g(runtime)225 2242 y(raises)k
Fh(NetObj.Error)p Fn(.)26 b(The)15 b(abandoned)g(computation)e(in)i
(the)f(owner)i(is)e(called)h(an)h Fi(orphan)p Fn(.)25
b(T)m(o)225 2291 y(build)14 b(an)h(application)e(that)i(is)f(robust)g
(in)g(the)h(presence)g(of)g(communication)e(failures,)j(the)f(program-)
225 2341 y(mer)10 b(must)e(ensure)i(that)f(the)h(computation)e(meets)h
(its)g(speci\256cation)h(even)g(in)f(the)h(presence)g(of)g(orphaned)225
2391 y(computations.)1060 2516 y(8)p eop
%%Page: 9 17
9 16 bop 117 141 a Fn(Modula-3)10 b(provides)h(a)h(mechanism)f(for)g
Fi(alerting)g Fn(a)h(thread.)k(This)11 b(is)g(not)g(an)g(interrupt,)h
(but)f(a)h(polite)75 191 y(request)h(for)g(the)g(thread)g(to)g(stop)f
(at)h(the)g(next)g(convenient)f(point)g(and)h(raise)g(a)h
(pre-de\256ned)g(exception.)75 241 y(When)f(programming)e(a)i(lengthy)e
(computation)g(that)h(might)g(for)h(any)f(reason)h(be)g(subject)f(to)g
(cancella-)75 291 y(tion,)f(it)g(is)g(good)f(style)h(to)g(check)h
(periodically)e(to)h(see)h(if)f(the)h(thread)f(has)g(been)h(alerted.)
117 340 y(If)j(a)h(thread)f(engaged)g(in)g(a)g(remote)g(call)g(is)g
(alerted,)i(the)e(runtime)f(raises)h Fh(NetObj.Error)f
Fn(in)h(the)75 390 y(calling)c(thread)h(and)f(simultaneously)e
(attempts)i(to)g(notify)g(and)g(alert)h(the)g(server)g(thread)g
(executing)f(the)75 440 y(call.)k(The)c(reason)g(that)g
Fh(NetObj.Error)f Fn(is)g(raised)h(is)f(that)h(there)g(is)f(no)h
(guarantee)g(that)g(the)f(attempt)g(to)75 490 y(alert)i(the)f(server)h
(thread)f(will)g(succeed;)g(therefore,)i(an)e(orphan)h(may)f(have)g
(been)h(created.)117 540 y(The)f(network)g(object)f(system)g(also)h
(uses)g(alerts)g(to)g(handle)g(the)g(situation)f(in)g(which)h(a)h
(client)e(crashes)75 589 y(while)g(it)f(has)h(an)g(outstanding)e
(remote)i(method)f(call.)16 b(In)10 b(this)f(case,)i(the)f(network)g
(object)g(runtime)f(alerts)75 639 y(the)h(thread)f(that)h(is)f
(executing)g(the)h(method)e(call)i(in)f(the)h(owner)m(.)16
b(Therefore,)11 b(most)e(methods)f(of)i(network)75 689
y(objects)h(should)f(include)h Fh(Thread.Alerted)f Fn(in)h(their)g
Fh(RAISES)g Fn(sets.)75 834 y Fj(2)58 b(Implementation)75
931 y Fn(This)13 b(subsection)g(describes)g(the)h(structure)g(of)f(our)
h(implementation.)21 b(Much)13 b(of)h(the)f(lower)h(levels)g(of)75
981 y(our)c(system)e(are)i(similar)f(to)g(that)g(of)h(conventional)f
(RPC,)i(as)f(described)f(by)h(Birrell)g(and)f(Nelson[4].)15
b(W)l(e)75 1031 y(will)10 b(concentrate)i(on)f(the)h(implementation)d
(aspects)i(that)g(are)h(new)g(in)e(network)i(objects.)75
1154 y Fk(2.1)50 b(Assumptions)75 1235 y Fn(W)l(e)10
b(implemented)f(our)g(system)g(with)g(Modula-3)g(and)g(Unix,)h(but)f
(our)h(design)f(would)f(work)i(on)f(any)h(sys-)75 1285
y(tem)g(that)g(provides)f(threads,)i(garbage)g(collection,)f(and)h
(object)f(types)g(with)f(single)h(inheritance.)15 b(At)10
b(the)75 1335 y(next)h(level)g(of)h(detail,)f(we)h(need)f(the)g
(following)f(capabilities)h(of)g(the)h(underlying)e(system:)124
1421 y(1.)21 b(Object)11 b(types)g(with)f(single)h(inheritance.)124
1502 y(2.)21 b(Threads)11 b(\(lightweight)f(processes\).)124
1583 y(3.)21 b(Some)11 b(form)g(of)h(reliable,)g(inter)o
(-address-space)g(communication.)124 1664 y(4.)21 b(Garbage)14
b(collection,)f(together)g(with)g(a)g(hook)g(for)h(registering)e(a)i
(cleanup)f(routine)g(for)h(selected)179 1713 y(objects)d(to)f(be)i
(called)f(when)h(they)f(are)h(collected)f(\(or)h(explicitly)e(freed\).)
124 1794 y(5.)21 b(Object-oriented)11 b(buf)o(fered)h(streams)f
(\(readers)h(and)g(writers\).)124 1875 y(6.)21 b(Runtime)12
b(type)g(support)g(as)h(follows.)19 b(Given)12 b(an)h(object,)g(to)g
(determine)f(its)g(type;)h(given)f(a)h(type:)179 1925
y(to)d(determine)h(its)f(supertype,)h(to)f(allocate)h(and)g(object)g
(of)g(the)g(type,)g(and)g(to)f(enumerate)h(the)g(sizes)179
1975 y(and)g(types)g(of)g(the)h(\256elds)f(of)g(the)h(type.)124
2056 y(7.)21 b(A)11 b(method)g(of)g(communicating)f(object)h(types)f
(from)i(one)f(address)g(space)h(to)f(another)m(.)117
2142 y(W)l(e)h(will)e(elaborate)i(on)f(the)g(last)g(item.)117
2192 y(The)i(Modula-3)f(compiler)h(and)g(linker)g(generate)h(numerical)
f(typecodes)h(that)e(are)j(unique)d(within)g(a)75 2242
y(given)h(address)g(space.)22 b(But)13 b(they)g(are)h(not)f(unique)f
(across)i(address)f(spaces)g(and)g(therefore)i(cannot)e(be)75
2291 y(used)e(to)g(communicate)f(types)h(between)h(address)f(spaces.)16
b(Therefore,)c(the)g(Modula-3)e(compiler)h(com-)75 2341
y(putes)g(a)i Fi(\256ngerprint)d Fn(for)j(every)f(object)g(type)f
(appearing)h(in)g(the)g(program)g(being)f(compiled.)17
b(A)12 b(\256nger)o(-)75 2391 y(print)e(is)g(a)i(sixty-four)e(bit)g
(checksum)g(with)g(the)h(property)f(that)h(\(with)f(overwhelming)g
(probability\))f(two)910 2516 y(9)p eop
%%Page: 10 18
10 17 bop 225 141 a Fn(types)12 b(have)h(the)g(same)f(\256ngerprint)h
(only)f(if)h(they)f(are)i(structurally)e(identical.)19
b(Thus)12 b(a)h(\256ngerprint)f(de-)225 191 y(notes)7
b(a)i(type)e(independently)g(of)h(any)g(address)g(space.)14
b(Every)8 b(address)g(space)h(contains)e(two)g(tables)h(map-)225
241 y(ping)j(between)i(its)e(typecodes)h(and)g(the)g(equivalent)f
(\256ngerprint.)18 b(T)m(o)11 b(communicate)g(a)i(typecode)f(from)225
291 y(one)g(address)g(space)h(to)f(another)n(,)h(the)f(typecode)g(is)g
(converted)g(into)f(the)i(corresponding)e(\256ngerprint)h(in)225
340 y(the)f(sending)f(address)h(space)h(and)f(the)f(\256ngerprint)h(is)
g(converted)g(into)f(the)h(corresponding)f(typecode)h(in)225
390 y(the)d(receiving)g(address)g(space.)15 b(If)8 b(the)g(receiving)g
(program)g(does)g(not)f(contain)h(a)g(code)g(for)h(the)e(type)h(being)
225 440 y(sent,)j(then)g(the)h(second)f(table)g(lookup)f(will)h(fail.)
225 566 y Fk(2.2)50 b(Pickles)225 647 y Fn(W)l(e)9 b(use)e(a)h
(mechanism)f(known)g(as)h Fi(pickles)g Fn(to)f(handle)h(the)g(more)f
(complex)g(cases)i(of)f(marshaling,)f(specif-)225 696
y(ically)j(those)f(that)h(involve)g(references)h(types)f(as)g(ar)o
(guments)g(or)g(results.)15 b(Our)10 b(pickles)g(package)h(is)e(sim-)
225 746 y(ilar)j(to)f(the)h(value)g(transmission)e(mechanism)h
(described)g(by)h(Herlihy)g(and)f(Liskov[12)o(],)i(who)e(seem)h(to)225
796 y(be)i(the)g(\256rst)h(to)f(have)g(described)g(the)g(problem)g(in)g
(detail.)23 b(However)n(,)16 b(our)f(package)f(is)g(more)g(general)225
846 y(because)e(it)f(handles)g(subtyping)e(and)j(dynamic)e(types.)267
896 y(For)j(simple)e(usage,)j(our)f(pickle)f(package)i(provides)e(a)h
(simple)f(interface.)20 b Fh(Pickle.Write\(ref,)225 946
y(wr\))15 b Fn(writes)g(a)h(\257attened)f(representation)g(of)h(the)f
(dynamically)f(typed)h(value)g Fh(ref)g Fn(to)g(the)g(writer)g
Fh(wr)p Fn(.)225 995 y Fh(Pickle.Read\(rd\))c Fn(reads)h(the)g
(representation)g(of)g(a)g(value)g(from)g(the)g(reader)h
Fh(rd)f Fn(and)g(returns)g(a)h(dy-)225 1045 y(namically)e(typed)f
(reference)k(to)d(a)g(copy)g(of)h(the)f(original)g(value.)267
1095 y(The)h(pickle)g(package)i(relies)e(on)g(the)h(compile-time)e(and)
h(runtime)g(type)g(support)g(described)g(earlier)n(,)225
1145 y(and)d(in)g(particular)g(on)f(the)h(existence)g(of)g(type)g
(\256ngerprints.)14 b(Given)9 b(this)f(support,)h(the)g(basic)f(method)
g(for)225 1195 y(writing)j(a)h(pickle)f(is)g(quite)g(simple.)k(It)d
(writes)f(the)h(\256ngerprint)f(of)h(the)g(given)f(value')m(s)h(type)f
(on)h(the)f(byte)225 1245 y(stream,)k(followed)f(by)g(the)g(referent')m
(s)i(data)e(\256elds.)25 b(The)14 b(method)g(recurses)h(on)f(any)g
(constituent)f(val-)225 1294 y(ues)e(that)f(are)i(themselves)e
(references)j(types.)i(Reading)c(is)g(the)f(inverse)h(operation:)j
(read)e(a)f(\256ngerprint,)225 1344 y(allocate)g(a)h(value,)g(examine)f
(the)g(type,)h(read)g(data)f(\256elds)g(and)h(recursively)f(read)h
(reference)h(\256elds.)267 1394 y(One)8 b(minor)g(complication)f(is)h
(the)h(problem)f(of)g(keeping)g(the)h(values)f(independent)g(of)h
(machine)f(archi-)225 1444 y(tecture)i(\(for)f(example,)h(byte)f(order)
h(or)f(word)g(length\).)14 b(W)l(e)d(do)d(this)h(by)g(encoding)f(the)i
(salient)e(properties)225 1494 y(of)g(the)g(architecture)h(in)f(a)h
(small)e(number)h(of)g(bytes)g(at)g(the)g(start)g(of)g(the)g(pickle,)h
(then)f(writing)f(the)h(pickle)g(in)225 1544 y(the)h(sender)r(')m(s)h
(native)f(form.)14 b(This)9 b(approach)g(is)g(ef)o(\256cient)h(in)f
(homogeneous)f(cases,)i(and)g(no)e(more)i(costly)225
1593 y(than)h(anything)g(else)g(in)g(heterogeneous)g(cases.)17
b(W)l(e)12 b(assume)f(that)g(all)g(architectures)h(can)g(be)g
(described)225 1643 y(by)f(our)h(header)m(.)17 b(If)12
b(there)g(were)g(an)f(aberrant)i(architecture,)f(its)f(pickle)g
(package)h(would)f(be)g(required)h(to)225 1693 y(map)f(to)g(and)g(from)
h(a)f(standard)g(one)h(on)f(sending)f(and)i(receiving.)267
1743 y(A)d(slightly)f(more)i(signi\256cant)g(complication)e(is)h
(detecting)h(and)g(dealing)f(with)g(multiple)g(occurrences)225
1793 y(of)h(the)g(same)f(reference)j(within)d(a)h(single)f(pickled)g
(value.)15 b(This)9 b(happens)h(in)f(cyclic)h(structures)f(and)h(also)
225 1843 y(in)i(graph-like)g(structures)g(that)g(are)h(not)f(trees.)19
b(\(W)l(e)13 b(make)f(no)g(attempt)g(to)g(preserve)h(sharing)f(between)
225 1893 y(separate)g(pickles.\))267 1943 y(When)g(writing)f(a)i
(pickle,)g(the)f(sender)h(maintains)e(a)i(hash)f(table)g(keyed)h(by)f
(references.)20 b(The)13 b(values)225 1992 y(in)g(this)f(table)h(are)h
(small)e(integers,)i(allocated)f(sequentially)f(within)f(each)j
(particular)g(pickle.)20 b(When)13 b(a)225 2042 y(reference)f(is)d
(\256rst)h(encountered)g(in)f(writing)g(a)h(pickle,)g(it)g(is)f
(entered)h(in)g(the)f(table)h(and)g(allocated)g(a)g(small)225
2092 y(integer)m(.)15 b(This)9 b(integer)g(is)f(written)h(on)g(the)g
(byte)g(stream)g(after)g(the)g(reference')m(s)j(\256ngerprint,)e(as)f
(the)g(de\256n-)225 2142 y(ing)h(occurrence.)17 b(Then)10
b(the)g(pickle)g(package)i(writes)e(the)g(referent)i(by)e(recursing.)15
b(If)c(a)g(reference)h(is)e(en-)225 2192 y(countered)j(for)g(a)g
(second)f(or)h(subsequent)f(time)f(in)i(a)g(single)e(pickle,)j(the)e
(reference')m(s)j(small)d(integer)g(is)225 2241 y(found)e(in)f(the)h
(hash)g(table)g(and)g(written)f(on)h(the)g(byte)g(stream)f(as)i(a)f
(subsequent)f(occurrence;)i(in)f(this)f(case)225 2291
y(there)j(is)f(no)g(need)g(to)g(examine)g(or)h(write)f(the)g(referent.)
267 2341 y(When)k(reading)h(a)g(pickle,)h(the)f(receiver)h(maintains)d
(an)i(array)g(indexed)g(by)f(these)h(small)f(integers.)225
2391 y(When)d(it)f(encounters)h(the)g(\256rst)g(occurrence)h(of)f(a)g
(reference')m(s)j(small)10 b(integer)n(,)j(it)e(allocates)h(the)g
(storage)1049 2516 y(10)p eop
%%Page: 11 19
11 18 bop 75 141 a Fn(and)13 b(records)g(the)f(new)h(reference)i(in)d
(the)h(appropriate)f(entry)h(of)g(the)f(array)m(,)j(and)d(proceeds)h
(to)g(read)g(the)75 191 y(referent)f(from)e(the)h(byte)g(stream.)k
(When)c(it)f(encounters)h(a)g(subsequent)f(occurrence)i(of)f(the)f
(reference')m(s)75 241 y(small)g(integer)n(,)i(it)f(just)f(uses)h(the)h
(reference)h(obtained)e(by)g(indexing)f(the)h(table.)117
291 y(The)d(default)g(behavior)f(of)i(the)f(pickle)f(package)i(isn')o
(t)f(satisfactory)f(for)i(all)e(types.)14 b(Problems)8
b(can)g(arise)75 341 y(if)j(the)f(concrete)h(representation)g(of)g(an)f
(abstract)h(type)g(isn')o(t)f(an)g(appropriate)h(way)g(to)f
(communicate)g(the)75 390 y(value)g(between)h(address)g(spaces.)k(T)m
(o)10 b(deal)h(with)f(this,)g(the)g(pickle)g(package)h(permits)f
(clients)g(to)g(specify)75 440 y(custom)f(procedures)g(for)h(pickling)f
(\(and)g(therefore)i(for)e(marshaling\))g(particular)h(data)f(types.)15
b(T)m(ypically)75 490 y(the)9 b(implementer)g(of)g(an)h(abstract)g
(data)f(type)h(speci\256es)g(such)f(a)h(custom)e(procedure)i(if)g(the)f
(type')m(s)h(values)75 540 y(aren')o(t)f(transferable)f(by)f
(straightforward)h(copying.)13 b(W)l(e)c(use)f(this)e(facility)i(to)f
(marshal)g(network)h(objects,)75 590 y(readers,)17 b(and)e(writers)f
(that)h(are)g(embedded)g(in)f(structures)g(that)h(would)f(ordinarily)g
(be)g(marshaled)h(by)75 639 y(value.)117 689 y(The)d(narrowest)g
(surrogate)h(rule)f(places)h(a)f(serious)g(constraint)f(on)i(the)f
(pickles)f(design:)17 b(since)12 b(pick-)75 739 y(ling)e(and)g
(unpickling)f(an)h(object)g(can)h(make)g(its)e(type)h(less)g
(speci\256c,)i(the)e(unpickler)g(must)g(check)h(that)f(an)75
789 y(unpickled)i(object)g(is)g(legal)g(at)g(the)h(position)d(in)i
(which)h(it)e(occurs.)20 b(It)12 b(is)g(possible)f(for)i(the)f
(unpickler)g(to)75 839 y(check)h(this)e(because)i(the)f(runtime)f
(provides)h(the)g(ability)f(to)h(enumerate)h(the)f(types)f(of)i(the)f
(\256elds)g(of)h(an)75 889 y(object.)117 939 y(There)8
b(are)h(many)f(subtleties)f(in)g(the)h(design)g(of)g(the)g(pickles)g
(package.)15 b(The)8 b(ability)f(to)h(register)g(custom)75
989 y(pickling)h(procedures)i(for)g(selected)g(types)f(has)g(a)h
(tricky)f(interaction)g(with)g(subtyping.)j(It)e(is)f(also)g(tricky)75
1038 y(to)k(de\256ne)i(and)e(ef)o(\256ciently)h(compute)f(type)h
(\256ngerprints)f(for)h(recursive)g(and)g(opaque)f(types.)25
b(But)15 b(the)75 1088 y(details)c(are)h(beyond)f(the)g(scope)g(of)h
(the)f(present)g(work.)75 1214 y Fk(2.3)50 b(Garbage)12
b(collection)75 1295 y Fn(Our)f(system)e(includes)h(network-wide,)h
(reference-counting)h(garbage)f(collection.)j(For)e(each)f(network)75
1345 y(object,)f(the)f(runtime)f(records)i(the)f(set)g(of)g(clients)f
(containing)g(surrogates)h(for)h(the)f(object)g(\(the)g
Fi(dirty)f(set)p Fn(\).)75 1394 y(As)g(long)e(as)i(this)f(set)h(is)f
(non-empty)m(,)h(the)f(runtime)g(retains)h(a)g(pointer)f(to)g(the)h
(object.)14 b(The)7 b(retained)h(pointer)75 1444 y(protects)h(the)g
(object)g(from)g(the)h(owner)r(')m(s)f(garbage)h(collector)n(,)g(even)g
(if)f(no)g(local)h(references)h(to)e(it)f(remain.)75
1494 y(When)13 b(a)g(surrogate)g(is)f(created,)j(the)d(client)h
(runtime)e(adds)i(its)f(address)h(space)g(to)f(the)h(dirty)f(set)h(for)
g(the)75 1544 y(concrete)c(object)f(by)g(making)f(a)i(\252dirty)e
(call\272)i(to)f(the)g(owner)m(.)15 b(When)8 b(a)h(surrogate)f(is)g
(reclaimed,)h(the)f(client)75 1594 y(runtime)j(deletes)g(its)g(address)
h(space)g(from)g(the)g(dirty)f(set)g(by)h(making)e(a)j(\252clean)f
(call\272.)17 b(When)12 b(the)f(dirty)75 1643 y(set)i(becomes)h(empty)m
(,)f(the)g(owner)r(')m(s)h(runtime)f(discards)g(the)g(retained)h
(pointer)n(,)g(allowing)e(the)h(owner)r(')m(s)75 1693
y(local)d(garbage)g(collector)f(to)h(reclaim)f(the)h(object)f(if)h(no)f
(local)h(references)h(remain.)k(T)m(o)9 b(trigger)h(the)f(clean)75
1743 y(call,)k(the)g(client)f(runtime)g(relies)g(on)h(the)f(assumed)g
(ability)g(to)g(register)h(cleanup)f(hooks)g(for)h(surrogates)75
1793 y(with)e(the)g(local)g(collector)m(.)117 1843 y(This)e(scheme)i
(will)f(not)g(garbage-collect)h(cycles)f(that)g(span)h(address)f
(spaces.)16 b(T)m(o)10 b(avoid)g(this)g(storage)75 1893
y(leak,)i(programmers)f(are)h(responsible)e(for)i(explicitly)e
(breaking)h(such)g(cycles.)117 1943 y(If)h(program)h
Fh(A)f Fn(sends)g(program)g Fh(B)h Fn(a)f(reference)j(to)d(an)g(object)
g(owned)h(by)f(a)h(third)e(program)h Fh(C)p Fn(,)h(and)g
Fh(A)75 1993 y Fn(then)g(drops)f(its)g(reference)j(to)d(the)h(object,)g
(we)g(must)f(ensure)h(that)f(the)h(dirty)f(call)h(from)f
Fh(B)h Fn(precedes)h(the)75 2042 y(clean)e(call)g(from)f
Fh(A)p Fn(,)h(to)f(avoid)h(the)f(danger)h(that)f(the)h(object)f(at)h
Fh(C)f Fn(will)g(be)h(prematurely)f(collected.)16 b(This)75
2092 y(is)10 b(not)g(a)g(problem)g(if)g(the)h(object)f(is)g(sent)g(as)g
(an)h(ar)o(gument)f(to)g(a)h(remote)f(method)f(call,)i(since)g(in)f
(this)f(case)75 2142 y(the)j(calling)g(thread)g(retains)g(a)h
(reference)h(to)e(the)g(object)g(on)g(its)g(stack)g(while)g(it)f
(blocks)h(waiting)f(for)i(the)75 2192 y(return)i(message,)g(which)f
(cannot)h(precede)g(the)g(unmarshaling)e(of)h(the)h(ar)o(gument.)25
b(But)14 b(if)h(the)f(object)75 2242 y(is)g(sent)g(as)h(a)f(result)g
(rather)h(than)f(an)h(ar)o(gument,)g(the)g(danger)f(is)g(real.)26
b(Our)14 b(solution)f(is)h(to)g(require)h(an)75 2291
y(acknowledgement)f(to)g(any)g(result)h(message)f(that)g(contains)g(a)h
(network)f(object:)21 b(the)14 b(procedure)h(that)75
2341 y(executes)c(the)h(call)f(in)g(the)g(owner)g(blocks)g(waiting)f
(for)h(the)g(acknowledgement,)g(with)g(the)g(reference)i(to)75
2391 y(the)c(object)g(on)f(its)g(stack.)15 b(The)9 b(stack)g(reference)
i(protects)e(the)f(object)h(from)g(the)g(garbage)g(collector)m(.)15
b(This)900 2516 y(1)n(1)p eop
%%Page: 12 20
12 19 bop 225 141 a Fn(solution)6 b(increases)i(the)f(message)h(count)f
(for)h(method)e(calls)i(that)f(return)h(network)f(objects,)h(but)f(it)g
(doesn')o(t)225 191 y(greatly)j(increase)g(the)g(latency)g(of)g(such)g
(calls,)g(since)g(the)g(thread)g(waiting)f(for)h(the)g(acknowledgement)
f(is)225 241 y(not)i(on)g(the)g(critical)g(path.)267
291 y(By)i(maintaining)f(the)h(set)g(of)g(clients)g(containing)f
(surrogates)h(rather)h(than)f(a)g(simple)g(count,)g(we)h(are)225
341 y(able)9 b(to)g(remove)g(clients)g(from)g(the)g(dirty)f(set)h(when)
g(they)g(exit)g(or)g(crash.)15 b(The)10 b(mechanism)e(for)h(detecting)
225 390 y(that)k(clients)f(have)h(crashed)h(is)e(transport-speci\256c,)
i(but)f(for)g(all)g(reasonable)g(transports)f(there)i(is)e(some)225
440 y(danger)d(that)e(a)i(network)f(partition)f(that)h(prevents)g
(communication)e(between)j(the)f(owner)h(and)f(client)g(will)225
490 y(be)i(misinterpreted)f(as)g(a)h(client)g(crash.)15
b(In)10 b(this)f(case,)i(the)f(owner)r(')m(s)g(object)f(might)g(be)g
(garbage)i(collected)225 540 y(prematurely)m(.)j(Because)9
b(communication)e(is)g(unreliable,)i(the)f(risk)g(of)g(premature)g
(collection)f(is)h(inherent)225 590 y(in)i(any)h(strategy)f(that)h
(avoids)f(storage)g(leaks)h(in)f(long-running)g(servers.)15
b(Since)d(we)f(never)g(reuse)g(object)225 639 y(IDs,)h(we)f(can)h
(detect)g(premature)f(collection)g(if)g(it)g(occurs.)267
689 y(Dirty)j(calls)h(are)h(synchronous)e(with)h(surrogate)g(creation,)
i(but)e(clean)g(calls)g(are)h(performed)g(in)f(the)225
739 y(background)c(and)h(can)g(be)f(batched.)16 b(If)c(a)g(clean)g
(call)g(fails,)f(it)g(will)g(be)g(attempted)g(again.)16
b(If)c(a)g(dirty)f(call)225 789 y(fails,)f(the)f(client)g(schedules)g
(the)g(surrogate)g(to)g(be)h(cleaned)f(\(since)h(the)f(dirty)g(call)g
(might)f(have)h(added)h(the)225 839 y(client)f(to)g(the)h(dirty)f(set)g
(before)i(failing\))e(and)g(raises)h(the)f(exception)h
Fh(NetObj.Error)p Fn(.)k(Clean)c(and)f(dirty)225 889
y(calls)g(carry)h(sequence)g(numbers)e(that)h(increase)h(monotonically)
d(with)i(respect)h(to)e(any)i(given)f(client:)k(the)225
938 y(owner)e(ignores)g(any)g(clean)h(or)f(dirty)g(call)g(that)g(is)g
(out)f(of)i(sequence.)k(This)10 b(requires)i(the)f(owner)g(to)g(store)
225 988 y(a)f(sequence)g(number)f(for)h(each)h(entry)e(in)h(the)f
(dirty)g(set,)h(as)g(well)g(as)f(a)h(sequence)h(number)e(for)h(each)g
(client)225 1038 y(for)h(which)g(a)h(call)f(has)g(failed.)k(The)d
(sequence)f(numbers)g(for)g(clients)f(that)h(have)g(successfully)g
(removed)225 1088 y(themselves)f(from)i(the)f(dirty)f(set)i(can)f(be)h
(discarded.)267 1138 y(A)d(companion)g(paper[3])h(presents)g(the)f
(details)g(of)h(the)g(collection)f(algorithm)f(and)i(a)g(proof)f(of)h
(its)f(cor)o(-)225 1188 y(rectness.)225 1313 y Fk(2.4)50
b(T)l(ransports)225 1394 y Fn(There)15 b(are)g(many)f(protocols)g(for)h
(communicating)d(between)j(address)f(spaces)h(\(for)g(example,)g
(shared)225 1444 y(memory,)10 b(TCP,)g(and)g(UDP\),)h(and)e(many)g
(irksome)g(dif)o(ferences)i(between)e(them.)15 b(W)l(e)10
b(insulate)f(the)g(main)225 1494 y(part)g(of)h(the)f(network)g(object)g
(runtime)g(from)g(these)h(dif)o(ferences)g(via)f(the)h(abstract)f(type)
g Fh(Transport.T)p Fn(.)267 1594 y(A)i Fh(Transport.T)g
Fn(object)g(generates)h(and)g(manages)f(connections)g(between)h
(address)g(spaces.)17 b(Dif-)225 1643 y(ferent)11 b(subtypes)e(are)i
(implemented)d(using)h(dif)o(ferent)i(communication)d(mechanisms.)14
b(For)d(example,)f(a)225 1693 y Fh(TCPTransport.T)g Fn(is)h(a)h
(subtype)e(that)h(uses)g(TCP)-5 b(.)267 1743 y(Each)13
b(subtype)e(is)i(required)f(to)h(provide)f(a)h(way)g(of)g(naming)e
(address)i(spaces.)20 b(A)13 b(transport-speci\256c)225
1793 y(name)h(for)h(an)g(address)f(space)h(is)f(called)g(an)h
Fi(endpoint)p Fn(.)23 b(Endpoints)13 b(are)i(not)f(expected)h(to)f(be)g
(human-)225 1843 y(sensible.)g(Naming)8 b(conventions)f(ensure)j(that)e
(an)h(endpoint)f(generated)h(by)g(one)f(transport)h(subtype)f(will)225
1893 y(be)h(meaningful)f(only)g(to)g(other)h(instances)f(of)h(the)g
(same)g(subtype.)14 b(\(Some)9 b(use)f(the)h(term)g(\252endpoint\272)f
(in)g(a)225 1942 y(weaker)i(sense,)g(meaning)e(little)g(more)h(than)g
(a)g(port)g(number)m(.)15 b(For)10 b(us,)f(dif)o(ferent)h(instances)e
(of)i(a)f(program)225 1992 y(are)j(identi\256ed)f(by)g(dif)o(ferent)h
(endpoints.\))267 2042 y(The)j Fh(fromEndpoint)f Fn(method)g(of)h(a)g
Fh(Transport.T)f Fn(enables)h(creation)h(of)f(connections)f(to)h(rec-)
225 2092 y(ognized)f(endpoints.)22 b(If)14 b Fh(tr)g
Fn(is)f(a)i Fh(Transport.T)e Fn(and)h Fh(ep)g Fn(is)f(an)h(endpoint)f
(recognized)h(by)g Fh(tr)p Fn(,)h(then)225 2142 y Fh
(tr.fromEndpoint\(ep\))c Fn(returns)i(a)h Fh(Location)e
Fn(\(described)i(in)e(the)h(next)g(paragraph\))h(that)f(gener)o(-)225
2192 y(ates)f(connections)e(to)h(the)h(address)f(space)h(named)f(by)g
Fh(ep)p Fn(.)16 b(If)c Fh(tr)f Fn(doesn')o(t)g(recognize)h
Fh(ep)p Fn(,)g(then)f(such)h(an)225 2241 y(invocation)e(returns)h
Fh(NIL)p Fn(.)267 2291 y(A)g Fh(Location)g Fn(is)f(an)i(object)f(whose)
g Fh(new)g Fn(method)f(generates)i(connections)f(to)g(a)g(particular)h
(address)225 2341 y(space.)j(When)8 b(a)h(client)f(has)g(\256nished)g
(using)g(a)g(connection,)h(it)f(should)f(pass)h(the)g(connection)g(to)g
(the)g Fh(free)225 2391 y Fn(method)j(of)h(the)g(location)f(that)g
(generated)i(it.)k(This)11 b(allows)g(transports)g(to)h(manage)g(the)g
(allocation)f(and)1049 2516 y(12)p eop
%%Page: 13 21
13 20 bop 75 141 a Fn(deallocation)13 b(of)g(connections)g(so)g(as)g
(to)g(amortize)h(the)f(overhead)h(of)f(connection)g(establishment)f
(and)75 191 y(maintenance.)117 241 y(The)f(system)f(uses)h(the)g(type)g
Fh(StubLib.Conn)f Fn(to)h(represent)h(connections.)i(It)e(is)e
(perfectly)i(possible)75 291 y(to)d(implement)f(a)i(class)g(of)f
(connection)h(that)f(communicates)f(with)h(datagrams)g(according)h(to)f
(a)h(protocol)75 341 y(that)h(makes)g(idle)f(connections)h(essentially)
f(free[4)q(].)16 b(That)11 b(is,)g(in)f(spite)h(of)g(its)g(name,)g
(implementations)75 390 y(of)f(the)f(type)h Fh(StubLib.Conn)e
Fn(need)i(not)f(be)h(connection-oriented)f(in)g(the)g(standard)h(sense)
f(of)h(the)g(term.)117 441 y(A)j(connection)g Fh(c)g
Fn(contains)f(a)i(reader)h Fh(c.rd)e Fn(and)g(a)h(writer)f
Fh(c.wr)p Fn(.)21 b(Connections)13 b(come)g(in)g(pairs;)h(if)75
490 y Fh(c)f Fn(and)f Fh(d)h Fn(are)g(paired,)h(whatever)f(is)f
(written)g(to)g Fh(c.wr)g Fn(can)h(be)g(read)g(from)g
Fh(d.rd)p Fn(,)g(and)f(vice-versa.)20 b(Or)o(-)75 540
y(dinarily)10 b Fh(c)i Fn(and)f Fh(d)g Fn(will)g(be)g(in)g(dif)o
(ferent)h(address)g(spaces.)j(V)-5 b(alues)11 b(are)i(marshaled)e(into)
f(a)i(connection')m(s)75 590 y(writer)i(and)g(unmarshaled)f(from)h(a)g
(connection')m(s)g(reader)m(.)24 b(Since)15 b(readers)f(and)g(writers)g
(are)g(buf)o(fered,)75 640 y(the)d(marshaling)e(code)i(can)g(treat)g
(them)f(either)h(as)g(streams)f(of)h(bytes)f(\(most)g(convenient\))h
(or)f(as)h(streams)75 690 y(of)g(datagrams)h(\(most)e(ef)o
(\256cient\).)117 740 y(One)f(of)h(the)f(two)h(connections)e(in)i(a)g
(pair)f(is)h(the)f Fi(client)g Fn(side)g(and)h(the)g(other)f(is)g(the)h
Fi(server)f Fn(side.)15 b(T)n(rans-)75 790 y(ports)d(are)h(required)g
(to)f(provide)h(a)f(thread)h(that)f(listens)g(to)g(the)g(server)i(side)
e(of)g(a)h(connection)f(and)h(calls)75 839 y(into)d(the)i(network)f
(object)g(runtime)f(when)h(a)h(message)f(arrives)h(indicating)e(the)h
(beginning)f(of)h(a)h(remote)75 889 y(call.)k(This)10
b(is)h(called)g Fi(dispatching)p Fn(,)f(and)i(is)f(described)g(further)
h(below)m(.)117 939 y(A)f(connection)h(is)f(required)h(to)g(provide)f
(a)h(way)g(of)g(generating)g(a)g(\252back)g(connection\272:)k(the)c
(location)75 989 y Fh(c.loc)f Fn(must)g(generate)h(connections)f(to)g
(the)h(address)f(space)i(at)e(the)h(other)f(side)h(of)f
Fh(c)p Fn(.)17 b(If)12 b Fh(c)g Fn(is)f(a)h(server)o(-)75
1039 y(side)f(connection,)g(the)g(connections)f(generated)i(by)f
Fh(c.loc)g Fn(have)g(the)g(opposite)f(direction)h(as)g
Fh(c)p Fn(;)g(if)g Fh(c)g Fn(is)75 1089 y(a)h(client-side)e
(connection,)i(they)f(have)g(the)g(same)h(direction)e(as)i
Fh(c)p Fn(.)117 1139 y(A)e(transport)h(is)f(responsible)g(for)h
(monitoring)e(the)h(liveness)g(of)h(address)g(spaces)g(for)g(which)g
(it)f(has)h(lo-)75 1189 y(cations)f(or)h(connections.)j(This)c(is)g
(discussed)f(in)i(more)f(detail)g(later)h(when)f(we)h(specify)f(the)h
(interface)g(to)75 1238 y(the)g(transport)g(system.)75
1365 y Fk(2.5)50 b(Basic)13 b(r)o(epr)o(esentations)75
1446 y Fn(W)l(e)h(will)d(now)i(describe)g(the)f(wire)h(representation)g
(of)g(network)f(objects,)h(the)f(client)h(and)f(server)i(stubs)75
1495 y(involved)c(in)h(remote)h(invocation,)f(and)g(the)g(algorithms)f
(we)i(use)g(to)f(marshal)g(and)g(unmarshal)g(network)75
1545 y(objects.)k(In)c(these)h(descriptions)e(we)h(will)g(use)g
(Modula-like)f(pseudocode.)117 1595 y(The)h(wire)h(representation)g
(for)g(a)g(network)f(object)h(is)f(a)h(pair)g Fh(\(sp,)24
b(i\))12 b Fn(where)g Fh(sp)g Fn(is)f(a)h Fh(SpaceID)f
Fn(\(a)75 1645 y(number)e(that)h(identi\256es)f(the)g(owner)h(of)g(the)
g(object\))f(and)h Fh(i)g Fn(is)f(an)h Fh(ObjID)f Fn(\(a)i(number)e
(that)g(distinguishes)75 1695 y(dif)o(ferent)j(objects)f(with)f(the)h
(same)h(owner\):)175 1796 y Fh(TYPE)24 b(WireRep)g(=)h(RECORD)g(sp:)f
(SpaceID;)g(i:)h(ObjID)g(END;)75 1871 y Fn(Each)13 b(address)g(space)h
(maintains)d(an)i Fi(object)g(table)f Fh(objtbl)h Fn(that)f(contains)h
(all)f(its)g(surrogates)h(and)g(all)75 1921 y(its)e(network)g(objects)f
(for)i(which)f(any)g(other)h(space)f(holds)g(a)h(surrogate:)175
2022 y Fh(VAR)24 b(objtbl:)h(WireRep)f(->)g(NetObj.T;)75
2097 y Fn(W)l(e)11 b(use)g(the)f(notation)g Fh(A)24 b(->)h(B)11
b Fn(to)f(name)g(the)h(type)f(of)h(a)g(table)f(with)g(domain)f(type)i
Fh(A)f Fn(and)h(element)f(type)75 2147 y Fh(B)p Fn(.)h(W)l(e)h(will)e
(use)h(array)h(notation)e(for)h(accessing)g(the)g(table,)h(even)f
(though)f(it)g(is)h(implemented)e(as)j(a)f(hash)75 2197
y(table.)k(W)l(e)e(write)e Fh(domain\(tbl\))f Fn(to)h(denote)g(the)g
(set)h(of)f(elements)g(of)g(the)g(domain)g(of)g Fh(tbl)p
Fn(.)117 2247 y(W)l(e)e(now)g(specify)g(the)g(representation)f(of)h
(the)g(opaque)g(type)g Fh(NetObj.T)p Fn(.)f(In)h(Modula-3,)g(the)g
Fh(REVEAL)75 2297 y Fn(statement)h(permits)h(such)g(a)h
(speci\256cation)f(to)g(be)g(visible)g(within)f(a)h(bounded)g(scope.)
175 2391 y Fh(REVEAL)899 2516 y Fn(13)p eop
%%Page: 14 22
14 21 bop 374 141 a Fh(NetObj.T)25 b(=)f(OBJECT)424 185
y(srgt,)h(inTbl:)f(BOOLEAN;)424 228 y(wrep:)h(WireRep;)424
272 y(loc:)g(Location;)424 315 y(disp:)g(Dispatcher)374
359 y(END;)325 432 y(TYPE)f(Dispatcher)g(=)h(PROC\(c:)f(StubLib.Conn;)g
(obj:)g(NetObj.T\);)225 505 y Fn(The)15 b(\256eld)g Fh(obj.srgt)f
Fn(indicates)g(whether)h Fh(obj)f Fn(is)g(a)h(surrogate.)26
b(The)14 b(\256eld)h Fh(obj.inTbl)f Fn(indicates)225
555 y(whether)e Fh(obj)g Fn(is)f(present)h(in)f Fh(objTbl)p
Fn(,)h(and)g(this)f(is)g(guaranteed)h(to)g(be)g(the)f(case)i(if)f
Fh(obj)f Fn(is)h(a)g(surrogate)225 605 y(or)e(if)g(another)h(address)f
(space)h(holds)e(a)h(surrogate)h(for)f(it.)15 b(If)10
b Fh(obj.inTbl)g Fn(is)f Fh(TRUE)p Fn(,)i(then)f Fh(obj.wrep)f
Fn(is)225 655 y(the)i(wire)h(representation)f(of)g(the)h(object.)267
705 y(If)k Fh(obj)g Fn(is)g(a)g(surrogate)g(is)g(then)g
Fh(obj.loc)f Fn(is)h(a)g Fh(Location)g Fn(that)f(generates)i
(connections)e(to)h(the)225 754 y(owner)r(')m(s)9 b(address)g(space)g
(at)g Fh(obj.wrep.sp)p Fn(,)f(and)h Fh(obj.disp)f Fn(is)g(unused.)14
b(Otherwise,)c(if)e Fh(obj.inTbl)225 804 y Fn(is)k Fh(TRUE)p
Fn(,)g(then)g Fh(obj.disp)g Fn(is)g(the)g(dispatcher)g(procedure)h(for)
g(the)f(object,)h(and)f Fh(obj.loc)g Fn(is)g(unused.)225
854 y(The)f(call)g Fh(obj.disp\(c,)24 b(obj\))11 b Fn(unmarshals)f(a)h
(method)f(number)h(and)g(ar)o(guments)g(from)g Fh(c)p
Fn(,)g(calls)g(the)225 904 y(appropriate)g(method)g(of)g
Fh(obj)p Fn(,)h(and)f(marshals)g(the)g(result)g(to)g
Fh(c)p Fn(.)225 1028 y Fk(2.6)50 b(Remote)13 b(invocation)225
1108 y Fn(T)m(o)8 b(illustrate)g(the)g(steps)g(in)h(a)g(remote)f
(method)g(invocation)f(we)i(continue)f(with)g(our)h(example)f(of)h(a)g
(simple)225 1158 y(\256le)g(service.)15 b(In)9 b(that)g(example,)h(we)f
(de\256ned)g(the)g(type)g Fh(FS.Server)f Fn(with)g(a)h(single)f(method)
g Fh(open)p Fn(.)15 b(The)225 1208 y(corresponding)c(stub-generated)g
(surrogate)g(type)g(declaration)h(looks)e(like)h(this:)325
1298 y Fh(TYPE)374 1342 y(SrgSvr)25 b(=)g(FS.Server)f(OBJECT)424
1385 y(OVERRIDES)474 1429 y(open)h(:=)f(SrgOpen)424 1473
y(END;)325 1540 y(PROCEDURE)g(SrgOpen\(obj:)f(SrgSvr;)i(n:)f(TEXT\):)h
(FS.File)f(=)374 1583 y(VAR)424 1627 y(c)h(:=)g(obj.loc.new\(\);)424
1670 y(res:)g(FS.File;)374 1714 y(BEGIN)424 1757 y(OutNetObj\(c,)f
(obj\);)424 1801 y(OutInteger\(c,)g(0\);)424 1845 y(OutText\(c,)g(n\);)
424 1888 y(<flush)h(buffers)f(to)h(network>;)424 1932
y(res)g(:=)g(InNetObj\(c\);)424 1975 y(obj.loc.free\(c\);)424
2019 y(RETURN)g(res)374 2069 y(END)g(SrgOpen;)225 2142
y Fn(The)11 b(procedures)g Fh(OutNetObj)g Fn(and)f Fh(InNetObj)h
Fn(are)h(described)f(in)f(the)h(next)g(subsection.)j(Procedures)225
2192 y(for)c(marshaling)e(basic)h(types)g(\(like)g Fh(OutInteger)p
Fn(\))f(are)i(in)f(the)h Fh(StubLib)e Fn(interface)i(which)f(we)h
(specify)225 2242 y(later)j(in)g(the)f(report.)20 b(\(Actually)m(,)14
b Fh(StubLib.OutRef)d Fn(subsumes)h(both)g Fh(OutNetObj)g
Fn(and)h Fh(OutText)p Fn(,)225 2291 y(but)e(we)g(ignore)h(that)e
(here.\))267 2341 y(The)f(method)f(being)h(invoked)g(is)g(identi\256ed)
g(on)g(the)g(wire)h(by)f(its)g(index;)g(the)g Fh(open)g
Fn(method)g(has)g(index)225 2391 y(zero.)21 b(The)13
b(code)h(presented)f(would)f(crash)h(with)g(a)g(narrow)h(fault)e(if)h
(the)g(network)g(object)g(returned)g(by)1049 2516 y(14)p
eop
%%Page: 15 23
15 22 bop 75 141 a Fh(InNetObj)12 b Fn(were)i(not)e(of)h(type)f
Fh(FS.File)p Fn(.)19 b(For)14 b(example,)f(this)f(would)g(happen)g(if)h
(appropriate)g(stubs)75 191 y(had)f(not)g(been)g(linked)g(into)f(the)h
(client)g(or)g(owner)m(.)18 b(The)13 b(actual)f(system)f(would)g(raise)
i(an)f(exception)g(in-)75 241 y(stead)f(of)h(crashing.)117
291 y(On)d(the)h(server)h(side,)f(the)g(thread)g(forked)g(by)g(the)f
(transport)h(to)f(service)i(a)f(connection)f Fh(c)h Fn(calls)g(into)f
(the)75 340 y(network)g(object)h(runtime)e(when)i(it)f(detects)g(an)h
(incoming)e(RPC)j(call.)k(The)10 b(procedure)g(it)f(calls)g(executes)75
390 y(code)j(something)d(like)i(this:)175 488 y Fh(VAR)24
b(obj)h(:=)g(InNetObj\(c\);)e(BEGIN)i(obj.disp\(c,)f(obj\))g(END;)75
562 y Fn(The)12 b(dispatcher)g(procedures)g(are)h(typically)e(written)h
(by)g(the)g(stub)f(generator)m(.)19 b(The)12 b(dispatcher)f(for)i(the)
75 612 y(type)e Fh(FS.Server)g Fn(would)f(look)h(something)e(like)i
(this:)175 703 y Fh(PROCEDURE)24 b(SvrDisp\(c:)g(StubLib.Conn;)f(obj:)i
(FS.Server\))f(=)224 747 y(VAR)h(methID)f(:=)h(InInteger\(c\);)f(BEGIN)
274 790 y(IF)h(methID)f(=)h(0)g(THEN)324 834 y(VAR)374
877 y(n)g(:=)f(InText\(c\);)374 921 y(res)h(:=)f(obj.open\(n\);)324
965 y(BEGIN)374 1008 y(OutNetObj\(c,)g(res\);)374 1052
y(<flush)g(buffers)g(to)h(network>)324 1095 y(END)274
1139 y(ELSE)324 1182 y(<error,)f(non-existent)g(method>)274
1226 y(END)224 1276 y(END)h(SvrDisp;)75 1350 y Fn(The)8
b(stubs)f(have)h(a)g(narrow)g(interface)h(to)e(the)h(rest)f(of)h(the)g
(system:)k(they)c(call)f(the)h Fh(new)g Fn(and)f Fh(free)h
Fn(methods)75 1399 y(of)i Fh(Location)e Fn(objects)h(to)g(obtain)g(and)
g(release)h(connections,)g(and)f(they)g(register)h(their)f(surrogate)g
(types)75 1449 y(and)i(dispatcher)g(procedures)h(where)g(the)f(runtime)
g(can)h(\256nd)f(them,)g(in)g(the)g(global)g(table)g
Fh(stubs)p Fn(:)175 1541 y Fh(VAR)24 b(stubs:)h(Typecode)f(->)g
(StubRec;)175 1615 y(TYPE)g(StubRec)g(=)h(RECORD)g(srgType:)f
(TypeCode;)g(disp:)g(Dispatcher)g(END;)75 1688 y Fn(An)11
b(address)h(space)f(has)h(stubs)e(for)h Fh(tc)h Fn(if)f(and)g(only)g
(if)g Fh(tc)g Fn(is)g(in)g(the)g(domain)g(of)g Fh(stubs)p
Fn(.)k(If)d Fh(tc)f Fn(is)g(in)g(the)75 1738 y(domain)g(of)h
Fh(stubs)p Fn(,)g(then)g Fh(stubs[tc].srgType)f Fn(is)g(the)h(typecode)
g(for)g(the)g(surrogate)g(type)g(for)g Fh(tc)p Fn(,)75
1788 y(and)e Fh(stubs[tc].disp)f Fn(is)g(the)h(owner)g(dispatcher)g
(procedure)g(for)h(handling)d(calls)i(to)g(objects)f(of)h(type)75
1838 y Fh(tc)p Fn(.)117 1888 y(A)g(stub)g(module)f(that)h(declares)h(a)
g(surrogate)f(type)g Fh(srgTC)g Fn(and)h(dispatcher)f
Fh(disp)g Fn(for)h(a)g(network)f(ob-)75 1937 y(ject)i(type)g
Fh(tc)h Fn(also)f(sets)g Fh(stubs[tc])24 b(:=)g(\(srgTC,)h(disp\))p
Fn(.)18 b(The)12 b(network)g(object)g(runtime)g(auto-)75
1987 y(matically)e(registers)h(a)h(surrogate)f(type)h(and)f(null)f
(dispatcher)h(for)h(the)f(type)g Fh(NetObj.T)p Fn(.)117
2037 y(In)d(the)g(actual)g(system)f(the)h Fh(stubs)g
Fn(table)g(is)f(indexed)h(by)g(stub)f(protocol)g(version)h(as)g(well)g
(as)g(type)g(code,)75 2087 y(to)13 b(make)g(it)f(easy)h(for)h(a)f
(program)g(to)f(support)g(multiple)g(protocol)g(versions.)20
b(The)13 b(actual)g(system)f(also)75 2137 y(includes)e(code)g(for)h
(relaying)f(exceptions)f(raised)i(in)f(the)g(owner)g(to)g(the)g
(client,)h(and)f(for)h(relaying)f(thread)75 2186 y(alerts)h(from)g(the)
h(client)f(to)g(the)g(owner)m(.)75 2311 y Fk(2.7)50 b(Marshaling)12
b(network)f(objects)75 2391 y Fn(The)g(call)h Fh(OutNetObj\(c,)24
b(obj\))11 b Fn(writes)g(the)g(wire)g(representation)g(of)h
Fh(obj)f Fn(to)g(the)g(connection)g Fh(c)p Fn(:)899 2516
y(15)p eop
%%Page: 16 24
16 23 bop 325 141 a Fh(PROCEDURE)24 b(OutNetObj\(c:)f(StubLib.Conn;)h
(obj:)h(NetObj.T\))f(=)374 185 y(BEGIN)424 228 y(IF)h(obj)g(=)f(NIL)h
(THEN)474 272 y(OutWireRep\(c,)f(\(-1,-1\)\);)424 315
y(ELSE)474 359 y(IF)h(NOT)f(obj.inTbl)g(THEN)524 403
y(VAR)h(i)f(:=)h(NewObjID\(\);)f(BEGIN)574 446 y(obj.wrep)g(:=)h
(\(SelfID\(\),)f(i\);)574 490 y(objtbl[obj.wrep])f(:=)i(obj;)574
533 y(obj.inTbl)f(:=)g(TRUE;)574 577 y(obj.srgt)g(:=)h(FALSE;)574
621 y(obj.disp)f(:=)h(GetDisp\(TYPECODE\(obj\)\))524
664 y(END)474 708 y(END;)474 751 y(OutWireRep\(c,)f(obj.wrep\))424
795 y(END)374 839 y(END)h(OutNetObj;)325 906 y(PROCEDURE)f
(GetDisp\(tc:)g(INTEGER\):)g(Dispatcher)g(=)374 949 y(BEGIN)424
993 y(WHILE)h(NOT)f(tc)h(IN)g(domain\(stubs\))e(DO)i(tc)g(:=)g
(Supertype\(tc\))e(END;)424 1036 y(RETURN)i(stubs[tc].disp)374
1086 y(END)g(GetDisp;)225 1159 y Fn(In)9 b(the)f(above)h(we)g(assume)f
(that)g Fh(NewObjID\(\))f Fn(returns)i(an)g(unused)e(object)i(ID,)g
(that)f Fh(SelfID\(\))g Fn(returns)225 1209 y(the)i Fh(SpaceID)f
Fn(of)h(the)g(caller)n(,)i(and)e(that)f Fh(Supertype\(tc\))g
Fn(returns)h(the)g(code)g(for)g(the)g(supertype)g(of)g(the)225
1259 y(type)h(whose)g(code)h(is)f Fh(tc)p Fn(.)267 1309
y(The)i(corresponding)h(call)g Fh(InNetObj\(c\))f Fn(reads)h(a)g(wire)g
(representation)g(from)g(the)f(connection)h Fh(c)225
1359 y Fn(and)d(returns)h(the)f(corresponding)f(network)h(object)g
(reference:)325 1449 y Fh(PROCEDURE)24 b(InNetObj\(c:)g
(StubLib.Conn\):)f(NetObj.T)h(=)374 1493 y(VAR)h(wrep)g(:=)f
(InWireRep\(c\);)g(BEGIN)424 1536 y(IF)h(wrep.i)f(=)h(-1)g(THEN)474
1580 y(RETURN)f(NIL)424 1623 y(ELSIF)h(wrep)f(IN)h(domain\(objtbl\))f
(THEN)474 1667 y(RETURN)g(objtbl[wrep])424 1711 y(ELSE)474
1754 y(RETURN)g(NewSrgt\(wrep,)g(c\))424 1798 y(END)374
1848 y(END)h(InNetObj;)225 1921 y Fn(The)14 b(call)f
Fh(NewSrgt\(wrep,)24 b(c\))13 b Fn(creates)i(a)f(surrogate)f(for)h(the)
g(network)f(object)g(whose)h(wire)g(repre-)225 1971 y(sentation)d(is)g
Fh(wrep)p Fn(,)h(assuming)f(that)g Fh(c)h Fn(is)g(a)g(connection)f(to)h
(an)g(address)g(space)g(that)g(knows)f Fh(wrep.sp)p Fn(.)225
2020 y(\(W)l(e)g(say)f(that)f(an)h(address)g(space)g
Fh(sp1)g Fi(knows)g Fn(an)g(address)f(space)i Fh(sp2)e
Fn(if)h Fh(sp1=sp2)f Fn(or)h(if)g Fh(sp1)f Fn(contains)225
2070 y(some)i(surrogate)g(owned)g(by)g Fh(sp2)p Fn(.\))267
2120 y Fh(NewSrgt)h Fn(locates)h(the)g(owner)n(,)h(determines)e(the)h
(typecode)g(of)g(the)g(surrogate,)h(and)f(enters)g(it)f(in)h(the)225
2170 y(object)e(table:)325 2260 y Fh(PROCEDURE)24 b(NewSrgt\(wrep:)f
(WireRep;)i(c:)f(StubLib.Conn\):)g(NetObj.T)g(=)374 2304
y(VAR)424 2347 y(loc)h(:=)g(FindSpace\(wrep.sp,)e(conn\);)424
2391 y(tc)i(:=)g(ChooseTC\(loc,)e(wrep.i\);)1049 2516
y Fn(16)p eop
%%Page: 17 25
17 24 bop 274 141 a Fh(res)25 b(:=)g(Allocate\(tc\);)224
185 y(BEGIN)274 228 y(res.wrep)f(:=)h(wrep;)274 272 y(res.srgt)f(:=)h
(TRUE;)274 315 y(res.inTbl)f(:=)h(TRUE;)274 359 y(objtbl[wrep])f(:=)h
(res;)274 403 y(RETURN)g(res)224 452 y(END)g(NewSrgt;)75
524 y Fn(The)9 b(call)h Fh(FindSpace\(sp,)24 b(c\))9
b Fn(returns)g(a)h Fh(Location)f Fn(that)g(generates)g(connections)g
(to)g Fh(sp)p Fn(,)h(or)g(raises)75 574 y Fh(NetObj.Error)d
Fn(if)i(this)f(is)g(impossible.)k(It)d(requires)f(that)h
Fh(c)f Fn(be)h(a)g(connection)f(to)g(an)h(address)f(space)h(that)75
624 y(knows)j(about)f Fh(sp)p Fn(.)19 b(The)12 b(call)g
Fh(ChooseTC\(loc,)24 b(i\))12 b Fn(implements)f(the)h(narrowest)g
(surrogate)g(rule.)19 b(It)75 674 y(returns)8 b(the)h(local)f(code)g
(for)h(the)f(local)h(surrogate)f(type)g(for)h(the)f(object)g(whose)g
(ID)h(is)f Fh(i)g Fn(and)g(whose)h(owner)75 724 y(is)j(the)f(address)h
(space)h(to)e(which)h Fh(loc)g Fn(generates)g(connections.)17
b(The)12 b(call)g Fh(Allocate\(tc\))f Fn(allocates)75
773 y(an)h(object)f(with)f(type)h(code)h Fh(tc)p Fn(.)117
823 y(T)m(o)d(implement)g Fh(FindSpace)g Fn(without)f(resorting)i(to)f
(broadcast,)i(each)g(address)f(space)g(maintains)f(in-)75
873 y(formation)14 b(about)g(its)f(own)h(transports)g(and)h(the)f
(endpoints)f(of)i(the)f(address)g(spaces)h(it)f(knows)g(about.)75
923 y(This)d(information)f(is)h(maintained)f(in)h(the)g(variables)g
Fh(tr)g Fn(and)h Fh(names)p Fn(:)175 1011 y Fh(VAR)24
b(tr:)h(SEQ[Transport.T];)175 1061 y(VAR)f(names:)h(SpaceID)f(->)h
(SEQ[Endpoint];)75 1133 y Fn(The)10 b(sequence)g Fh(tr)g
Fn(lists)e(the)i(transports)f(available)g(in)h(this)e(space,)j(in)f
(decreasing)g(order)g(of)g(desirability)m(.)75 1182 y(T)m(ypically)m(,)
k(it)g(is)f(initialized)g(by)h(the)g(network)g(object)g(runtime)f(and)h
(is)f(constant)h(thereafter)m(.)25 b(For)15 b(any)75
1232 y(space)e Fh(sp)p Fn(,)g(the)g(sequence)g Fh(names[sp])f
Fn(contains)f(the)i(endpoints)e(for)i Fh(sp)f Fn(recognized)h(by)g
Fh(sp)p Fn(')m(s)g(trans-)75 1282 y(ports.)i(W)l(e)d(write)f
Fh(SEQ[T])g Fn(to)g(denote)g(the)g(type)h(of)f(sequences)h(of)f
(elements)g(of)g(type)g Fh(T)p Fn(.)117 1332 y(The)i(fast)g(path)g
(through)g Fh(FindSpace)f Fn(\256nds)i(an)f(entry)g(for)h
Fh(sp)f Fn(in)g Fh(names)p Fn(;)h(this)e(entry)h(is)g(the)g(list)g(of)
75 1382 y(names)f(for)h Fh(sp)f Fn(recognized)g(by)g
Fh(sp)p Fn(')m(s)h(transports.)18 b(These)12 b(names)g(are)h(presented)
f(to)g(the)g(transports)g Fh(tr)75 1431 y Fn(available)h(in)h(this)e
(space;)j(if)f(one)f(is)g(recognized,)i(a)f(common)f(transport)g(has)g
(been)h(found;)g(if)g(none)f(is)75 1481 y(recognized,)f(there)g(is)f
(no)g(common)f(transport.)117 1531 y(The)g(\256rst)h(time)f(an)h
(address)g(space)g(receives)g(a)g(reference)i(to)d(an)h(object)g(owned)
f(by)h Fh(sp)p Fn(,)g(there)g(will)f(be)75 1581 y(no)f(entry)g(for)h
Fh(sp)f Fn(in)g(the)h(space')m(s)g(name)f(table.)15 b(In)9
b(this)g(case,)i Fh(FindSpace)d Fn(obtains)h(the)g(name)g(sequence)75
1631 y(for)j Fh(sp)g Fn(by)g(making)f(an)h(RPC)i(call)e(to)f(the)h
(address)g(space)h(from)f(which)g(it)f(received)i(the)f(reference)i
(into)75 1681 y Fh(sp)p Fn(.)h(This)10 b(is)h(our)f(\256rst)h(example)g
(of)g(an)g(RPC)h(call)f(that)f(is)g(nested)h(inside)f(an)h
(unmarshaling)e(routine;)h(we)75 1730 y(will)i(use)h(the)f(notation)g
Fh(RPC\(loc,)24 b(P\(args\)\))12 b Fn(to)h(indicate)f(an)h(RPC)h(call)f
(to)f Fh(P\(args\))h Fn(directed)g(at)75 1780 y(the)d(address)h(space)g
(identi\256ed)f(by)g(the)g(location)g Fh(loc)p Fn(.)15
b(Here)c(is)f(the)g(implementation)f(of)h Fh(FindSpace)p
Fn(:)175 1868 y Fh(PROCEDURE)24 b(FindSpace\(sp:)f(SpaceID;)i(c:)f
(StubLib.Conn\):)g(Location)g(=)224 1912 y(BEGIN)274
1955 y(IF)h(NOT)g(sp)f(IN)h(domain\(names\))f(THEN)324
1999 y(names[sp])g(:=)h(RPC\(c.loc,)f(GetNames\(sp\)\);)274
2042 y(END;)274 2086 y(VAR)h(nm)g(:=)f(names[sp];)g(BEGIN)324
2130 y(FOR)h(i)g(:=)f(0)h(TO)g(LAST\(tr\))f(DO)374 2173
y(FOR)h(j)f(:=)h(0)g(TO)g(LAST\(nm\))f(DO)424 2217 y(VAR)g(loc)h(:=)g
(tr[i].fromEndpoint\(nm[j]\);)d(BEGIN)474 2260 y(IF)i(loc)h(#)g(NIL)f
(THEN)h(RETURN)f(loc)h(END)424 2304 y(END)374 2347 y(END)324
2391 y(END;)899 2516 y Fn(17)p eop
%%Page: 18 26
18 25 bop 474 141 a Fh(RAISE)25 b(NetObj.Error)424 185
y(END)374 228 y(END)g(FindSpace;)325 304 y(PROCEDURE)f(GetNames\(sp\))f
(=)i(BEGIN)g(RETURN)f(names[sp])g(END)h(GetNames;)225
380 y Fn(Placing)14 b(the)g Fh(i)f Fn(loop)g(outside)g(the)h
Fh(j)g Fn(loop)f(gives)g(priority)g(to)g(the)h(client')m(s)g(transport)
f(preference)j(over)225 430 y(the)c(owner)r(')m(s)h(transport)f
(preference.)20 b(The)12 b(choice)h(is)f(arbitrary:)17
b(usually)11 b(the)h(only)g(point)f(of)h(transport)225
480 y(preference)17 b(is)e(to)g(obtain)f(a)i(shared)f(memory)g
(transport)g(if)g(one)g(is)g(available,)i(and)e(this)f(will)h(happen)
225 530 y(whichever)d(loop)e(is)h(outside.)267 580 y(The)d(only)f
(remaining)g(procedure)i(is)f Fh(ChooseTC)p Fn(,)f(which)h(must)f
(implement)g(the)h(narrowest)g(surrogate)225 630 y(rule.)18
b(According)12 b(to)g(this)f(rule,)i(the)f(surrogate)g(type)g(depends)g
(on)g(which)g(stubs)f(have)h(been)h(registered)225 680
y(in)c(the)h(client)f(and)g(in)h(the)f(owner:)14 b(it)9
b(must)g(determine)g(the)g(narrowest)h(supertype)f(for)h(which)f(both)g
(client)225 730 y(and)i(owner)g(have)g(a)g(registered)g(stub.)j(This)c
(requires)h(a)g(call)g(to)f(the)h(owner)g(at)f(surrogate)h(creation)g
(time,)225 779 y(which)i(we)g(combine)g(with)f(the)h(call)g(required)h
(by)f(the)g(garbage)g(collector:)19 b(the)13 b(call)g
Fh(Dirty\(i,)24 b(sp\))225 829 y Fn(adds)10 b Fh(sp)h
Fn(to)f(the)g(dirty)g(set)g(for)h(object)g(number)f Fh(i)g
Fn(and)h(returns)f(the)h(supertypes)e(of)i(the)g(object')m(s)f(type)g
(for)225 879 y(which)h(stubs)f(are)i(registered)g(in)f(the)g(owner)m(.)
325 974 y Fh(PROCEDURE)24 b(Dirty\(i:)g(ObjID;)g(sp:)h(SpaceID\):)f
(SEQ[Fingerprint])f(=)374 1018 y(VAR)424 1062 y(tc)i(:=)g
(TYPE\(objtbl[\(SelfID\(\),)e(i\)]\);)424 1105 y(res:)i
(SEQ[Fingerprint])e(:=)i(<empty)f(sequence>;)374 1149
y(BEGIN)424 1192 y(<add)h(sp)g(to)f(object)h(i's)f(dirty)h(set>;)424
1236 y(WHILE)g(NOT)f(tc)h(IN)g(domain\(stubs\))e(DO)i(tc)g(:=)g
(Supertype\(tc\))e(END)424 1280 y(LOOP)474 1323 y
(res.addhi\(TCToFP\(tc\)\);)474 1367 y(IF)i(tc)g(=)f
(TYPECODE\(NetObj.T\))g(THEN)g(EXIT)h(END;)474 1410 y(tc)g(:=)g
(Supertype\(tc\))424 1454 y(END;)424 1498 y(RETURN)g(res)374
1541 y(END)g(Dirty;)325 1611 y(PROCEDURE)f(ChooseTC\(loc:)f(Location;)h
(i:)h(ObjID\):)f(INTEGER)h(=)374 1654 y(VAR)g(fp:)g(SEQ[Fingerprint];)e
(BEGIN)424 1698 y(fp)i(:=)g(RPC\(c.loc,)f(Dirty\(i,)g(SelfID\(\)\)\);)
424 1741 y(FOR)h(j)g(:=)f(0)h(TO)g(LAST\(fp\))f(DO)474
1785 y(IF)h(FPToTC\(fp[j]\))e(IN)i(domain\(stubs\))f(THEN)524
1829 y(RETURN)g(stubs\(FPToTC\(fp[j]\)\).srgType)474
1872 y(END)424 1916 y(END)374 1966 y(END)h(ChooseTC;)225
2042 y Fn(The)9 b(loops)e(in)h Fh(Dirty)g Fn(are)i(guaranteed)f(to)f
(terminate,)h(because)g(stubs)e(are)j(automatically)d(registered)h(for)
225 2092 y Fh(NetObj.T)p Fn(.)13 b(In)g Fh(ChooseTC)g
Fn(we)g(assume)g(that)f Fh(TCToFP)h Fn(and)g Fh(FPToTC)g
Fn(convert)g(between)g(equivalent)225 2141 y(typecodes)d(and)h
(\256ngerprints)f(\(if)h(there)g(is)f(no)h(local)f(typecode)h(for)g
Fh(fp)p Fn(,)g(we)g(assume)f(that)h Fh(FPToTC\(fp\))225
2191 y Fn(returns)j(some)h(illegal)e(typecode)i(never)g(present)f(in)h
Fh(stubs)p Fn(\).)25 b(W)l(e)15 b(also)f(assume)g(that)h
Fh(s.addhi\(x\))225 2241 y Fn(extends)c(the)g(sequence)h
Fh(s)f Fn(with)g(the)g(new)h(element)e Fh(x)p Fn(.)267
2291 y(This)g(concludes)h(our)h(description)e(of)i(the)f(algorithms)f
(for)i(marshaling)f(network)g(objects.)k(W)l(e)d(have)225
2341 y(omitted)7 b(a)i(number)f(of)h(details.)14 b(For)9
b(example,)h(to)e(avoid)g(cluttering)g(up)g(the)h(program,)g(we)g(have)
g(ignored)225 2391 y(synchronization;)15 b(the)g(real)g(program)g(must)
e(protect)i(the)g(various)f(global)g(tables)g(with)g(locks.)26
b(Some)1049 2516 y(18)p eop
%%Page: 19 27
19 26 bop 75 141 a Fn(care)13 b(is)f(required)h(to)f(avoid)g(deadlock;)
g(for)h(example,)f(it)g(is)g(not)g(attractive)g(to)g(hold)g(a)g(lock)g
(all)g(the)h(way)75 191 y(through)8 b(a)h(call)f(to)g
Fh(NewSrgt)p Fn(.)14 b(Instead,)c(we)e(make)h(an)g(entry)f(in)g(the)h
(surrogate)f(table)g(at)h(the)f(beginning)g(of)75 241
y(the)j(procedure,)h(recording)f(that)f(a)i(surrogate)f(is)f(under)h
(construction,)f(and)h(do)g(not)f(reacquire)i(the)f(table)75
291 y(lock)i(until)f(the)i(end)f(of)g(the)h(sequence,)g(when)g(the)f
(surrogate)g(has)h(been)f(fully)g(constructed.)21 b(A)14
b(thread)75 340 y(that)d(encounters)g(a)h(surrogate)f(under)h
(construction)e(simply)f(waits)i(for)h(it)f(to)g(be)g(constructed.)75
489 y Fk(2.8)50 b(Marshaling)12 b(str)o(eams)75 578 y
Fn(An)h(important)f(feature)i(of)f(our)g(treatment)g(of)g(streams)g(is)
g(that)f(data)i(is)e(not)h(communicated)f(via)h(RPC,)75
627 y(but)f(by)g(the)g(underlying)f(transport-speci\256c)i
(communication.)k(This)11 b(facility)h(is)g(analogous)g(to)g(the)g(re-)
75 677 y(mote)e(pipes)g(of)h(DCE)h(RPC,)g(but)e(with)h(a)g(critical)f
(dif)o(ference:)16 b(the)11 b(streams)f(we)h(pass)g(are)h(not)e
(limited)f(in)75 727 y(scope)j(to)f(the)h(duration)f(of)h(the)g(RPC)i
(call.)j(When)12 b(we)g(marshal)g(a)g(stream)g(from)f(process)h(A)g(to)
g(process)75 777 y(B,)h(process)f(B)h(acquires)f(a)g(surrogate)h
(stream)e(attached)i(to)e(the)h(same)g(data)h(as)f(the)g(original)f
(stream.)18 b(In)75 827 y(process)10 b(B)h(the)f(surrogate)g(stream)g
(can)h(be)f(used)g(at)g(will,)g(long)f(after)i(the)f(call)h(that)e
(passed)h(it)g(is)g(\256nished.)75 876 y(In)h(contrast,)g(in)f(a)h
(scheme)g(such)f(as)h(the)g(pipes)f(provided)g(in)g(DCE,)i(the)e(data)h
(in)f(the)h(pipe)f(must)g(be)h(com-)75 926 y(municated)g(in)g(its)g
(entirety)h(at)f(the)h(time)f(of)h(the)f(RPC)i(call)f(\(and)g(at)g(a)g
(particular)f(point)g(in)g(the)h(call)g(too\).)75 976
y(Our)h(facility)g(is)g(also)f(analogous)h(to)g(the)g(remote)g(pipes)f
(of)i(Gif)o(ford)f(and)g(Glasser[10],)h(but)f(is)g(simpler)75
1026 y(and)e(more)h(transparent.)117 1080 y(Readers)g(and)f(writers)h
(are)g(marshaled)f(very)h(similarly;)d(to)i(be)h(de\256nite,)g
(consider)f(a)h(reader)g Fh(rd)p Fn(.)k(The)75 1130 y(sending)7
b(process)i(has)f(a)h(concrete)g(reader)g Fh(rd)f Fn(in)g(hand.)14
b(The)9 b(marshaling)e(code)i(must)e(create)i(a)g(surrogate)75
1179 y(reader)j Fh(rdsrg)e Fn(in)g(the)h(receiving)f(process,)h(such)g
(that)f Fh(rdsrg)g Fn(delivers)h(the)f(contents)g(of)h
Fh(rd)p Fn(.)k(The)c(gen-)75 1229 y(eral)f(strategy)f(is)g(to)g
(allocate)h(a)g(connection)f(between)h(the)f(sender)h(and)f(receiver)n
(,)j(allocate)e Fh(rdsrg)f Fn(in)g(the)75 1279 y(receiver)j(so)e(that)g
(it)g(reads)h(from)f(the)g(connection,)h(and)f(fork)h(a)g(thread)f(in)g
(the)h(sender)f(that)g(reads)h(buf)o(fers)75 1329 y(from)g
Fh(rd)f Fn(and)h(sends)g(them)f(over)h(the)g(connection.)k(\(The)c
(thread)g(could)f(be)h(avoided)g(by)f(doing)g(an)h(RPC)75
1379 y(to)h(\256ll)g(the)g(buf)o(fer)i(of)e Fh(rdsrg)g
Fn(whenever)h(it)f(is)g(empty)m(,)g(but)g(this)f(would)h(increase)h
(the)f(per)o(-buf)o(fer)i(over)o(-)75 1428 y(head)f(of)h(the)f
(cross-address)g(space)h(stream.\))21 b(For)13 b(the)g(detailed)g
(strategy)g(we)g(explored)h(two)e(designs.)117 1532 y(In)h(the)g
(\256rst)g(design,)g(the)g(sender)g(uses)g(the)g(connection)f
Fh(c)p Fn(,)i(over)f(which)g Fh(rd)g Fn(is)g(to)f(be)h(marshaled,)h(to)
75 1582 y(create)e(a)f(new)g(connection)f Fh(nc)25 b(:=)f
(c.loc.new\(\))p Fn(.)15 b(The)c(sender)g(then)f(chooses)h(a)g(unique)f
(ID,)h(sends)75 1632 y(the)h(ID)h(over)g Fh(nc)p Fn(,)g(sends)f(the)h
(ID)f(over)h Fh(c)g Fn(as)f(the)h(wire)f(representation)h(of)f
Fh(rd)p Fn(,)i(and)e(forks)h(a)f(thread)h(that)75 1682
y(copies)f(data)h(from)g Fh(rd)g Fn(into)e Fh(nc)p Fn(.)20
b(In)13 b(the)f(receiving)h(process,)h(two)e(threads)h(are)g(involved.)
19 b(The)13 b(thread)75 1731 y(servicing)g(the)h(connection)f
Fh(nc)h Fn(reads)g(the)g(ID)g(\(distinguishing)d(it)i(from)h(an)g
(incoming)e(call)i(message\))75 1781 y(and)f(places)g(the)f(connection)
g(in)h(a)g(table)g(with)f(the)g(ID)h(as)g(key)m(.)20
b(The)13 b(thread)g(unmarshaling)e(the)i(reader)75 1831
y(looks)e(up)g(the)g(connection)g(in)g(the)h(table)f(and)h(allocates)f
(the)g(surrogate)h(reader)h Fh(rdsrg)e Fn(using)f(that)i(con-)75
1881 y(nection.)18 b(This)12 b(seems)g(simple,)g(but)f(the)i(details)e
(became)i(rather)g(complicated,)f(for)h(example)f(because)75
1931 y(of)f(the)h(dif)o(\256culty)f(of)g(freeing)h(connections)e(in)h
(the)h(table)f(when)g(calls)g(fail)g(at)h(inopportune)e(times.)117
1984 y(The)h(second)h(design)f(employs)f(a)i(network)f(object)h(called)
f(a)h Fh(Voucher)f Fn(with)g(a)h(method)f Fh(claim)g
Fn(that)75 2034 y(returns)i(a)g(reader)m(.)22 b(V)-6
b(ouchers)13 b(have)g(nonstandard)g(surrogates)f(and)h(dispatchers)g
(registered)g(for)g(them,)75 2084 y(but)e(are)h(otherwise)f(ordinary)g
(network)g(objects.)117 2138 y(T)m(o)j(marshal)g Fh(rd)p
Fn(,)i(the)f(sending)e(process)i(allocates)g(a)g(voucher)f
Fh(v)h Fn(with)f(a)h(data)g(\256eld)g Fh(v.rd)f Fn(of)h(type)75
2188 y(reader)n(,)d(sets)d Fh(v.rd)24 b(:=)h(rd)p Fn(,)10
b(and)g(calls)f Fh(OutNetObj\(v\))p Fn(.)14 b(When)9
b(the)h(receiving)f(process)h(unmarshals)75 2238 y(a)f(network)f
(object)g(and)h(\256nds)f(it)g(is)g(a)h(surrogate)g(reader)g(voucher)g
Fh(vs)p Fn(,)g(it)f(calls)h Fh(vs.claim\(\))e Fn(and)i(returns)75
2287 y(the)i(resulting)f(reader)m(.)117 2341 y(The)f
Fh(claim)f Fn(method)g(of)h(a)g(surrogate)g(voucher)h
Fh(vs)e Fn(invokes)g Fh(vs.loc.new\(\))g Fn(to)h(obtain)f(a)h(new)h
(con-)75 2391 y(nection)h Fh(nc)p Fn(.)k(It)d(then)f(marshals)g
Fh(vs)g Fn(to)g Fh(nc)g Fn(\(just)g(like)g(an)g(ordinary)g(surrogate)h
(method)e(call\).)16 b(But)c(then,)899 2516 y(19)p eop
%%Page: 20 28
20 27 bop 225 141 a Fn(instead)14 b(of)g(sending)g(ar)o(guments)f(and)i
(waiting)e(for)i(a)f(result,)h(it)f(allocates)g(and)g(returns)h(the)f
(surrogate)225 191 y(reader)e Fh(rdsrg)p Fn(,)g(giving)e(it)h(the)g
(connection)g Fh(nc)g Fn(as)g(a)h(source)g(of)f(data.)267
241 y(On)d(the)h(server)g(side,)g(the)g(voucher)g(dispatcher)f(is)h
(called)f(by)h(a)g(transport-supplied)e(thread,)j(just)e(as)g(for)225
291 y(an)j(ordinary)g(incoming)f(call.)15 b(The)c(ar)o(guments)g(to)g
(the)g(dispatcher)g(are)h(the)e(server)i(side)f(of)g(the)g(connec-)225
341 y(tion)h Fh(nc)g Fn(and)h(the)g(voucher)f Fh(vs)h
Fn(containing)f(the)g(original)g(reader)i Fh(vs.rd)p
Fn(.)19 b(The)13 b(dispatcher)f(procedure)225 390 y(plays)g(the)g(role)
h(of)f(the)h(forked)f(thread)h(in)f(the)h(\256rst)f(design:)k(it)c
(reads)h(buf)o(fers)g(from)g Fh(vs.rd)f Fn(and)g(sends)225
440 y(them)f(over)g Fh(nc)p Fn(.)267 490 y(The)e(second)g(design)g
(relies)g(on)g(the)g(transport)g(to)g(provide)g(the)g(required)g
(connection)g(and)g(thread,)i(and)225 540 y(relies)g(on)f(the)h
(ordinary)g(network)f(object)h(marshaling)f(machinery)h(to)f(connect)h
(the)g(surrogate)g(voucher)225 590 y(with)f(the)h(original)g(reader)m
(.)17 b(This)10 b(makes)h(the)g(protocol)f(simple,)h(but)f(it)h(costs)f
(three)i(messages)e(\(a)i(round)225 640 y(trip)e(for)g(the)g(dirty)g
(call)g(for)h(the)f(voucher;)h(then)f(another)g(message)g(to)g(launch)g
(the)g(voucher)g(dispatcher\).)225 689 y(It)i(would)f(be)i(easy)f
(enough)g(to)f(avoid)h(the)g(all-but-useless)f(dirty)h(call)g(by)f
(dedicating)h(a)g(bit)g(in)g(the)g(wire)225 739 y(representation)i(to)f
(identify)g(vouchers,)i(but)e(perhaps)h(not)g(so)f(easy)h(to)g(stomach)
f(the)h(change.)23 b(On)14 b(the)225 789 y(other)d(hand,)g(the)f
(\256rst)h(design)f(uses)g(only)g(one)h(message)f(\(to)g(communicate)g
(the)h Fh(ID)f Fn(from)h(the)f(sender)h(to)225 839 y(the)g(receiver\),)
i(and)f(this)e(message)h(could)g(perhaps)g(be)h(piggybacked)f(with)f
(the)i(\256rst)f(buf)o(fer)h(of)g(data.)267 889 y(W)l(e)j(chose)f(the)g
(second)g(design,)h(because:)21 b(\(1\))15 b(it)e(is)h(trivial)g(to)g
(implement;)f(\(2\))i(given)f(that)g(cross-)225 939 y(address)8
b(space)h(streams)f(are)i(intended)e(for)g(bulk)g(data)h(transfer)n(,)h
(it)e(is)g(not)g(clear)h(how)f(important)f(the)h(extra)225
989 y(messages)j(are;)h(and)f(\(3\))g(if)h(experience)g(leads)f(us)g
(to)g(get)g(rid)g(of)g(the)g(extra)h(messages,)f(it)g(is)f(not)h
(obvious)225 1038 y(whether)g(to)g(choose)h(the)f(\256rst)g(design)g
(or)g(to)g(optimize)g(the)g(second.)225 1164 y Fk(2.9)50
b(Bootstrapping)225 1245 y Fn(The)8 b(mechanisms)g(described)g(so)g
(far)h(produce)g(surrogate)f(network)g(objects)g(only)g(as)g(a)h
(result)f(of)h(method)225 1295 y(calls)g(on)g(other)g(surrogate)g
(network)f(objects.)15 b(W)l(e)9 b(have)h(as)f(yet)g(no)f(way)i(to)e
(for)o(ge)i(an)f(original)f(surrogate.)225 1345 y(T)m(o)14
b(do)g(this)f(we)i(need)g(the)f(ingredients)f(of)i(a)f(surrogate)h
(object:)20 b(a)15 b Fh(Location)p Fn(,)g(an)f(object)g(ID,)h(and)f(a)
225 1394 y(surrogate)f(type.)21 b(T)m(o)13 b(make)g(it)g(possible)f(to)
h(for)o(ge)h(the)f(object)g(ID)g(and)h(type,)g(we)f(adopt)g(the)g
(following)225 1444 y(convention:)h(every)e(program)f(into)f(which)h
(network)g(objects)g(are)h(linked)e(owns)h(a)h Fi(special)f(object)f
Fn(with)225 1494 y(an)i(ID)h(of)f(zero,)i(of)e(a)h(known)e(type.)18
b(The)12 b(methods)f(of)i(the)f(special)g(object)g(implement)e(the)i
(operations)225 1544 y(required)i(by)f(the)h(network)f(object)h
(runtime)f(\(reporting)g(in)g(clean)h(and)g(dirty)m(,)g
Fh(GetNames)p Fn(,)g(etc.\).)24 b(The)225 1594 y(special)10
b(object)f(also)g(has)h Fh(get)g Fn(and)g Fh(put)f Fn(methods)g
(implementing)e(a)j(table)g(of)g(named)f(network)h(objects.)225
1643 y(At)e(initialization)e(time)i(the)g(network)g(object)g(runtime)g
(allocates)g(a)h(special)f(object)g(with)f(ID)i(0)f(and)h(places)225
1693 y(it)i(in)g Fh(objtbl)p Fn(.)267 1743 y(All)e(that)g(remains)h(to)
f(for)o(ge)i(an)f(original)f(surrogate)h(is)g(to)f(obtain)g(a)i
Fh(Location)e Fn(valid)g(for)h(some)g(other)225 1793
y(program)g(into)f(which)g(network)h(objects)f(have)h(been)g(linked.)15
b(Fundamentally)m(,)9 b(the)h(only)f(way)h(to)f(obtain)225
1843 y(a)h Fh(Location)f Fn(is)g(to)g(call)h(some)f(transport')m(s)h
Fh(fromEndpoint)e Fn(method\320that)g(is,)i(the)g(program)f(for)o(ging)
225 1893 y(the)g(surrogate)g(must)f(know)h(an)g(address)h(where)f
(something)f(is)h(listening.)k(For)d(this)e(step)h(the)g(application)
225 1943 y(has)f(two)f(choices.)15 b(W)l(e)8 b(provide)g(a)g(network)f
(object)h(agent)g(that)f(listens)g(at)g(a)i(well-known)e(TCP)h(port;)h
(thus)225 1992 y(a)g(surrogate)h(for)f(the)g(agent')m(s)g(special)g
(object)g(can)h(be)f(for)o(ged)h(given)e(the)h(IP)h(name)f(of)g(the)g
(node)g(on)g(which)225 2042 y(it)j(is)g(running.)19 b(If)13
b(every)g(node)f(runs)h(the)f(agent)h(from)f(its)g(start-up)g(script,)h
(then)g(no)f(other)h(well-known)225 2092 y(ports)8 b(are)h(needed:)14
b(applications)7 b(can)i(export)f(their)h(objects)f(by)g(putting)f
(them)h(in)g(the)g(table)h(managed)f(by)225 2142 y(the)h(agent')m(s)g
(special)g(object,)h(and)f(their)g(clients)f(can)i(get)e(them)h(from)g
(the)g(same)g(table.)14 b(If)c(the)f(application)225
2192 y(writer)j(prefers)h(not)f(to)g(rely)g(on)g(the)g(agent,)h(he)f
(can)h(choose)f(his)f(own)h(transport)g(and)g(well-known)f(port)225
2241 y(and)h(con\256gure)g(his)f(program)g(to)h(listen)e(at)i(that)f
(port)h(and)f(to)h(for)o(ge)g(surrogates)f(for)h(the)g(special)f
(objects)225 2291 y(at)g(that)g(port.)267 2341 y(The)g(procedures)g
Fh(NetObj.Import)g Fn(and)g Fh(NetObj.Export)p Fn(,)f(which)h(appeared)
h(in)f(our)g(\256le)h(server)225 2391 y(example,)g(implement)d(object)i
(bootstrapping.)j(These)e(procedures)f(simply)f(for)o(ge)i(a)g
(surrogate)f(for)h(the)1049 2516 y(20)p eop
%%Page: 21 29
21 28 bop 75 141 a Fn(special)8 b(object)f(of)h(some)g(agent)g
(process,)h(and)f(then)f(invoke)h(the)g Fh(get)f Fn(or)h
Fh(put)g Fn(method)f(on)h(that)f(surrogate.)75 315 y
Fj(3)58 b(Public)15 b(Interfaces)75 412 y Fn(In)g(this)f(section)g(and)
h(the)g(next,)h(we)g(present)e(the)h(major)g(system)f(interfaces)h
(exactly)g(as)g(they)g(appear)75 462 y(in)10 b(the)g(network)g(objects)
f(programmers)h(library)m(.)15 b(This)9 b(section)h(describes)g(the)g
Fh(NetObj)p Fn(,)g Fh(NetStream)p Fn(,)75 511 y(and)f
Fh(NetObjNotifier)e Fn(interfaces,)j(as)f(well)f(as)h(the)g(stub)e
(generator)m(.)16 b(These)9 b(interfaces)g(are)h(suf)o(\256cient)75
561 y(for)h(most)e(network)h(objects)g(clients.)15 b(The)10
b(following)f(section)h(presents)g(important)f(internal)h(interfaces)75
611 y(that)h(are)h(not)f(used)g(by)g(most)f(clients.)117
661 y(The)g(interfaces)h(in)f(this)f(section)h(depend)g(on)g(a)h(few)g
(local-level)f(facilities)f(from)i(the)f(SRC)i(Modula-3)75
711 y(runtime)e(library[18,)i(13].)j(W)l(e)e(summarize)d(these)i
(dependencies)f(here:)135 803 y Fl(\017)21 b Fn(An)8
b Fh(Atom.T)g Fn(is)f(a)i(unique)f(representation)g(for)g(a)h(set)f(of)
g(equal)g(texts)g(\(like)g(a)g(Lisp)g(atomic)g(symbol\).)179
853 y(Atoms)i(are)i(often)f(used)h(to)e(parameterize)j(exceptions.)135
937 y Fl(\017)21 b Fn(An)13 b Fh(AtomList.T)f Fn(is)h(a)g(linked)g
(list)f(of)h(atoms.)20 b(Atom)12 b(lists)g(are)i(used)f(for)g
(propagating)g(lists)f(of)179 987 y(nested)f(exception)g(parameters)h
(up)f(the)g(call)g(stack.)135 1071 y Fl(\017)21 b Fn(A)15
b Fh(Rd.T)h Fn(represents)f(an)h(abstract)g(data)f(source.)28
b(The)16 b Fh(Rd)f Fn(interface)i(provides)e(operations)f(for)179
1121 y(reading)d(data)h(and)f(re-positioning)f(the)h(stream.)135
1205 y Fl(\017)21 b Fn(A)8 b Fh(Wr.T)f Fn(represents)i(an)f(abstract)g
(data)g(sink.)13 b(The)8 b Fh(Wr)g Fn(interface)h(provides)e
(operations)g(for)i(writing)179 1254 y(data)i(and)h(re-positioning)d
(the)i(stream.)135 1338 y Fl(\017)21 b Fh(Thread.Alerted)10
b Fn(is)h(the)g(exception)g(to)g(be)g(raised)h(by)f(an)g(alerted)h
(thread.)135 1422 y Fl(\017)21 b Fn(The)13 b Fh(WeakRef)f
Fn(interface)h(allows)f(clients)g(to)g(register)h(garbage)g(collection)
f(\256nalization)g(proce-)179 1472 y(dures)f(for)h(objects)f(in)h(the)f
(traced)h(heap.)17 b(In)12 b(other)f(words,)h(a)g(client)f(can)h
(obtain)f(noti\256cation)g(just)179 1522 y(prior)g(to)g(collection)f
(of)i(heap)f(storage.)75 1648 y Fk(3.1)50 b(NetObj)11
b(interface)75 1729 y Fn(This)j(is)g(the)g(primary)g(public)g
(interface)h(for)g(using)f(network)g(objects.)25 b(Before)15
b(listing)e(the)i(interface,)75 1779 y(here)d(are)g(a)g(few)g
(de\256nitions.)117 1829 y(A)h Fi(pr)n(ogram)f(instance)h
Fn(is)g(an)h(activation)e(of)i(a)f(program.)22 b(The)13
b(same)g(program)h(can)f(have)h(many)f(in-)75 1879 y(stances)h(running)
f(concurrently)g(or)h(consecutively)m(.)22 b(A)14 b(program)g(instance)
f(can)h(be)g(thought)f(of)h(as)g(an)75 1929 y(address)8
b(space,)h(although)e(the)h(design)f(does)h(not)f(preclude)i(the)e
(implementation)f(of)i(a)g(program)g(instance)75 1978
y(by)j(a)h(suite)e(of)i(address)f(spaces.)117 2028 y(Recall)g(that)g
(an)g(agent)g(is)g(a)g(program)g(that)f(provides)h(a)g(table)g(that)f
(maps)h(names)g(to)f(network)h(objects.)75 2078 y(Any)g(program)g(can)h
(be)g(an)g(agent,)f(but)g(every)h(machine)g(has)f(a)h(particular)f
(default)h(agent.)k(Owners)11 b(typ-)75 2128 y(ically)g(make)g(network)
f(objects)h(available)g(to)f(clients)h(by)f(inserting)g(them)h(into)f
(an)h(agent')m(s)g(table,)h(using)75 2178 y(the)h(procedure)g
Fh(NetObj.Export)p Fn(.)18 b(Clients)13 b(typically)e(use)i
Fh(NetObj.Import)e Fn(to)i(retrieve)g(network)75 2228
y(objects)e(from)g(the)g(table.)175 2322 y Fh(INTERFACE)24
b(NetObj;)175 2391 y(IMPORT)g(Atom,)g(AtomList,)g(Thread;)899
2516 y Fn(21)p eop
%%Page: 22 30
22 29 bop 325 141 a Fh(TYPE)374 185 y(T)25 b(<:)g(ROOT;)374
235 y(Address)g(<:)f(REFANY;)225 313 y(NetObj.T)9 b Fn(is)h(the)g(root)
f(type)h(of)g(all)g(network)f(objects.)15 b(A)10 b Fh(NetObj.Address)e
Fn(designates)i(a)g(program)225 363 y(instance.)325 461
y Fh(PROCEDURE)24 b(Locate)g(\(host:)g(TEXT\):)h(Address)424
511 y(RAISES)g({Invalid,)f(Error,)g(Thread.Alerted};)325
576 y Fg(Return)12 b(an)g(address)h(for)f(the)g(default)g(agent)g(at)h
(the)f(machine)g(whose)f(human-sensible)g(name)h(is)325
625 y Ff(host)p Fg(.)225 704 y Fn(The)i(naming)g(convention)f(used)h
(by)g Fh(Locate)g Fn(is)f(system-dependent.)23 b(For)15
b(example,)g(in)f(an)h(Internet)225 754 y(environment,)10
b Fh(Locate\("decsrc.pa.dec.com"\))e Fn(returns)i(the)g(address)h(of)f
(the)g(default)h(agent)f(on)225 804 y(the)h(machine)g
Fh(decsrc)g Fn(in)g(the)g(DEC)h(Palo)g(Alto)e(Internet)i(domain.)267
855 y Fh(Locate)d Fn(raises)i Fh(Invalid)f Fn(if)g(it)g(determines)g
(that)g Fh(host)g Fn(is)g(not)f(a)i(valid)f(name.)15
b(It)10 b(raises)h Fh(Error)f Fn(if)g(it)225 904 y(is)e(unable)g(to)g
(interpret)g(the)g(name)h(or)f(determine)g(its)g(validity)m(,)g
(typically)f(because)i(it)f(is)g(unable)g(to)g(contact)225
954 y(the)j(naming)g(authority)m(,)f(or)i(if)f(there)h(is)f(no)g
(standard)g(agent)g(running)g(on)g(the)g(speci\256ed)h(host.)325
1053 y Fh(PROCEDURE)24 b(Export\(name:)f(TEXT;)i(obj:)f(T;)h(where:)g
(Address)f(:=)g(NIL\))424 1102 y(RAISES)h({Error,)f(Thread.Alerted};)
325 1167 y Fg(Set)13 b Ff(table[name])24 b(:=)h(obj)13
b Fg(where)h Ff(table)f Fg(is)g(the)g(table)h(provided)e(by)h(the)h
(agent)f(whose)325 1217 y(address)e(is)f Ff(where)p Fg(,)h(or)g(by)g
(the)f(default)h(agent)g(for)g(the)g(local)g(machine)g(if)g
Ff(where=NIL)p Fg(.)f(This)g(can)325 1267 y(be)h(used)g(with)g
Ff(obj=NIL)g Fg(to)g(remove)g(an)g(entry)h(from)f(the)g(table.)325
1365 y Fh(PROCEDURE)24 b(Import\(name:)f(TEXT;)i(where:)f(Address)h(:=)
f(NIL\):)h(T)424 1415 y(RAISES)g({Error,)f(Thread.Alerted};)325
1480 y Fg(Return)12 b Ff(table[name])f Fg(where)i Ff(table)f
Fg(is)g(the)g(table)g(provided)g(by)g(the)g(agent)g(whose)g(address)325
1529 y(is)f Ff(where)p Fg(,)g(or)h(by)g(the)f(default)h(agent)f(for)h
(the)g(local)f(machine)g(if)h Ff(where=NIL)p Fg(.)f Ff(Import)g
Fg(returns)325 1579 y Ff(NIL)g Fg(if)g Ff(table)g Fg(contains)g(no)g
(entry)g(for)h Ff(name)p Fg(.)325 1678 y Fh(EXCEPTION)24
b(Error\(AtomList.T\),)f(Invalid;)325 1749 y(VAR)h(\(*CONST*\))374
1792 y(CommFailure,)g(MissingObject,)g(NoResources,)374
1836 y(NoTransport,)g(UnsupportedDataRep,)f(Alerted:)i(Atom.T;)325
1913 y(END)f(NetObj.)225 1991 y Fn(The)15 b(exception)f
Fh(NetObj.Error)g Fn(indicates)g(that)g(a)h(failure)g(occured)g(during)
g(a)g(remote)f(method)g(in-)225 2041 y(vocation.)23 b(Every)14
b(remote)g(method)g(should)e(therefore)j(include)f(this)f(exception)h
(in)g(its)f(raises)h(clause.)225 2091 y(If)e Fh(NetObj.Error)f
Fn(is)h(not)f(raised,)i(then)f(the)f(invocation)g(completed)h
(successfully)m(.)k(If)d(it)e(is)h(raised,)g(it)225 2141
y(may)c(or)g(may)g(not)g(have)h(completed)e(successfully)m(.)14
b(It)8 b(is)g(possible)f(that)h(an)g(orphaned)h(remote)f(invocation)225
2191 y(continued)j(to)f(execute)i(at)g(the)f(owner)n(,)h(while)f(the)g
(client)g(raised)g Fh(NetObj.Error)p Fn(.)267 2242 y(The)i(\256rst)g
(atom)g(in)g(the)g(ar)o(gument)g(to)g Fh(NetObj.Error)f
Fn(explains)g(the)h(reason)h(for)f(the)h(failure;)g(any)225
2291 y(subsequents)7 b(atoms)g(provide)h(implementation-speci\256c)e
(detail.)14 b(The)9 b(atom)e Fh(CommFailure)g Fn(indicates)225
2341 y(communication)j(failure,)i(which)f(might)f(be)h(network)g
(failure)h(or)g(a)f(crash)h(on)f(a)h(remote)f(machine.)16
b(The)225 2391 y(atom)d Fh(MissingObject)g Fn(indicates)g(that)h(some)f
(network)h(object,)h(either)f(the)g(one)g(whose)f(method)g(is)1049
2516 y(22)p eop
%%Page: 23 31
23 30 bop 75 141 a Fn(invoked)11 b(or)h(an)h(ar)o(gument)e(to)h(that)g
(method,)f(has)h(been)h(garbage-collected)f(by)g(its)g(owner)m(.)18
b(\(This)11 b(indi-)75 191 y(cates)i(that)e(the)h(owner)h(mistakenly)e
(determined)g(that)h(one)g(of)h(its)e(clients)h(was)g(dead.\))19
b Fh(NoResources)75 241 y Fn(indicates)c(that)g(the)g(call)g(failed)g
(because)h(of)g(a)f(lack)h(of)f(resources,)i(for)f(example)f(Unix)g
(\256le)h(descrip-)75 291 y(tors.)f Fh(NoTransport)9
b Fn(indicates)h(that)h(an)f(attempt)g(to)g(unmarshal)g(an)h(object)f
(failed)h(because)g(the)f(client)75 340 y(and)j(owner)h(shared)f(no)g
(common)f(transport)h(protocol)f(implementation)f(and)j(were)g
(therefore)g(unable)75 390 y(to)f(communicate.)20 b Fh
(UnsupportedDataRep)11 b Fn(indicates)h(a)i(mismatch)e(between)h(the)g
(network)g(repre-)75 440 y(sentation)d(of)h(data)f(and)h(the)g(ability)
e(of)i(a)g(receiver)h(to)e(handle)h(it,)g(for)g(example)f(a)h(64-bit)f
Fh(INTEGER)g Fn(with)75 490 y(non-zero)15 b(high-order)g(bits)f(is)g
(not)g(meaningful)g(as)h(an)g Fh(INTEGER)g Fn(on)f(a)h(32-bit)f
(machine.)26 b Fh(Alerted)75 540 y Fn(indicates)12 b(that)g(a)h(client)
f(thread)h(was)g(alerted)f(in)h(the)f(middle)g(of)g(a)h(remote)g(call)f
(and)h(that)f(an)h(orphaned)75 589 y(remote)8 b(computation)e(might)h
(still)g(be)h(in)g(progress.)14 b(\(Threads)8 b(alerted)h(in)e(remote)h
(calls)g(might)f(also)g(raise)75 639 y Fh(Thread.Alerted)p
Fn(;)i(in)g(which)h(case)g(it)g(is)f(guaranteed)h(that)g(no)f(orphans)h
(remain.\))15 b(If)10 b(the)g(\256rst)g(atom)f(in)75
689 y(the)h(ar)o(gument)g(list)f(does)h(not)f(appear)i(in)f(this)f
(interface,)i(a)g(network)e(object)h(runtime)f(error)i(is)f(indicated.)
75 815 y Fk(3.2)50 b(NetStr)o(eam)12 b(interface)75 896
y Fn(The)f Fh(NetStream)g Fn(interface)h(describes)f(the)h(marshaling)e
(of)h(readers)i(and)e(writers,)h(and)f(provides)g(pro-)75
945 y(cedures)h(that)f(you)g(will)f(need)i(to)f(use)g(if)g(you)g(plan)g
(to)g(reuse)h(a)g(stream)f(after)h(marshaling)e(it.)117
995 y(The)g(network)f(object)h(runtime)f(allows)h(subtypes)f(of)h
Fh(Rd.T)f Fn(and)i Fh(Wr.T)e Fn(to)h(be)g(marshaled)g(as)g(parame-)75
1045 y(ters)h(and)g(as)g(results)f(of)h(remote)g(method)f(invocation.)k
(T)m(o)d(communicate)f(a)h(reader)h(or)f(writer)g(from)g(one)75
1095 y(program)g(to)g(another)n(,)g(a)h(surrogate)f(stream)g(is)g
(created)h(in)f(the)g(receiving)g(program.)k(W)l(e)d(call)f(the)g
(origi-)75 1145 y(nal)e(reader)i(or)e(writer)g(the)h(concrete)g
(stream.)k(Data)c(is)f(copied)g(over)g(the)g(network)g(between)h(the)f
(concrete)75 1195 y(stream)f(and)h(the)f(surrogate)g(stream.)15
b(Surrogate)9 b(streams)f(are)h(free-standing)g(entities,)f(valid)g
(beyond)g(the)75 1244 y(scope)j(of)f(the)g(remote)h(call)f(that)g
(produced)h(them.)j(Data)d(can)g(be)g(transmitted)e(on)h(a)h(surrogate)
f(stream)h(at)75 1294 y(close)g(to)g(the)g(bandwidth)g(supported)f(by)h
(the)g(underlying)g(transport.)117 1344 y(The)e(initial)e(position)h
(of)h(the)g(surrogate)g(reader)h(or)f(writer)g(equals)g(the)g(position)
e(of)i(the)g(corresponding)75 1394 y(concrete)g(stream)g(at)g(the)f
(time)g(it)h(was)f(marshaled.)15 b(All)8 b(surrogate)h(readers)g(and)g
(writers)g(are)g(unseekable.)75 1444 y(Data)i(is)f(transferred)h
(between)g(surrogates)f(and)h(concrete)g(streams)f(in)h(background.)j
(Therefore,)f(unde-)75 1494 y(\256ned)g(behaviour)f(will)f(result)h(if)
h(you)f(1\))g(perform)h(local)f(operations)g(on)g(the)g(concrete)h
(stream)f(while)g(a)75 1544 y(surrogate)f(for)h(it)e(exists,)h(or)g
(2\))g(create)i(two)d(surrogates)h(for)h(the)f(same)g(stream)g(by)g
(marshaling)f(it)g(twice.)75 1593 y(There)j(is)e(a)i(mechanism,)e
(described)h(below)m(,)h(for)f(shutting)f(down)g(a)i(surrogate)f
(stream)f(so)h(that)g(the)g(un-)75 1643 y(derlying)f(stream)g(can)h(be)
f(remarshaled.)117 1693 y(Calling)g Fh(Wr.Flush)g Fn(on)h(a)g
(surrogate)g(writer)h(\257ushes)e(all)h(outstanding)e(data)i(to)g(the)g
(concrete)h(writer)75 1743 y(and)e(\257ushes)g(the)g(concrete)h(writer)
m(.)k(Calling)10 b Fh(Wr.Close)h Fn(\257ushes)g(and)g(then)g(closes)f
(both)h(the)g(surrogate)75 1793 y(and)g(the)h(concrete)g(writer)m(.)k
(Similarly)m(,)11 b(a)g(call)h(on)f Fh(Rd.Close)f Fn(on)i(a)f
(surrogate)h(closes)f(both)f(readers.)117 1843 y(Clients)d(who)g
(marshal)g(streams)g(retain)h(responsibility)d(for)j(closing)e(them.)14
b(For)8 b(example,)h Fh(Rd.Close)75 1893 y Fn(on)i(a)h(surrogate)f(can)
g(fail)h(due)f(to)g(the)g(network,)g(leaving)g(the)g(owner)g
(responsible)g(for)g(closing)f(the)i(con-)75 1942 y(crete)h(reader)m(.)
19 b(The)12 b Fh(WeakRef)g Fn(interface)g(can)h(be)f(used)g(to)g
(register)g(a)g(GC)h(cleanup)f(procedure)g(for)h(this)75
1992 y(purpose.)117 2042 y(The)g Fh(ReleaseWr)f Fn(procedure)i(is)f
(used)g(to)f(shut)h(down)f(a)i(surrogate)f(writer)g(so)g(that)g(the)g
(underlying)75 2092 y(writer)e(can)g(be)g(reused.)16
b(It)10 b(\257ushes)h(any)g(buf)o(fered)g(data,)h(closes)e(the)h
(surrogate,)g(and)g(frees)g(any)g(network)75 2142 y(resources)g
(associated)f(with)f(the)i(surrogate.)k(It)10 b(leaves)h(the)f
(concrete)h(writer)f(in)g(a)h(state)f(where)h(it)f(can)h(be)75
2192 y(reused)h(locally)e(or)i(remarshaled.)117 2242
y(Similarly)m(.)24 b(the)14 b Fh(ReleaseRd)g Fn(procedure)h(is)f(used)h
(to)f(shut)f(down)h(a)h(surrogate)g(reader)h(so)e(that)g(the)75
2291 y(underlying)d(reader)i(can)g(be)f(reused.)19 b(It)12
b(closes)f(the)h(surrogate,)h(frees)g(any)f(network)g(resources)h
(associ-)75 2341 y(ated)h(with)g(the)g(surrogate,)h(and)f(leaves)g(the)
g(concrete)h(reader)g(in)f(a)g(state)g(where)h(it)f(can)g(be)h(reused)f
(lo-)75 2391 y(cally)d(or)g(remarshaled.)k(There)d(is)e(an)i(important)
d(dif)o(ference)j(between)g(releasing)e(readers)i(and)f(writers:)899
2516 y(23)p eop
%%Page: 24 32
24 31 bop 225 141 a Fh(ReleaseRd)11 b Fn(discards)g(any)g(data)g(buf)o
(fered)i(in)e(the)g(surrogate)g(or)h(in)f(transit.)325
233 y Fh(INTERFACE)24 b(NetStream;)325 301 y(IMPORT)g(Rd,)h(Wr,)f
(Thread;)325 368 y(PROCEDURE)g(ReleaseRd\(rd:)f(Rd.T\))424
418 y(RAISES)i({Rd.Failure,)e(Thread.Alerted};)325 480
y Fg(If)12 b Ff(rd)f Fg(is)g(a)h(surrogate)g(reader)n(,)h(release)f
(all)g(network)f(resources)h(associated)f(with)g Ff(rd)p
Fg(,)h(discard)f(all)325 530 y(buf)o(fered)h(data,)g(close)f
Ff(rd)p Fg(,)h(but)f(do)g(not)g(close)g(the)g(concrete)h(reader)h(for)e
Ff(rd)p Fg(.)16 b(This)11 b(procedure)h(is)f(a)325 580
y(no-op)g(if)g Ff(rd)g Fg(is)g(not)g(a)g(surrogate.)325
671 y Fh(PROCEDURE)24 b(ReleaseWr\(wr:)f(Wr.T\))424 721
y(RAISES)i({Wr.Failure,)e(Thread.Alerted};)325 783 y
Fg(If)12 b Ff(wr)h Fg(is)f(a)g(surrogate)h(writer)n(,)g(\257ush)f
Ff(wr)p Fg(,)h(release)h(all)e(network)g(resources)h(associated)f(with)
f Ff(wr)p Fg(,)325 833 y(close)g Ff(wr)p Fg(,)h(but)f(do)g(not)g(close)
h(the)f(concrete)i(writer)e(for)h Ff(wr)p Fg(.)k(This)11
b(procedure)h(is)f(a)h(no-op)g(if)f Ff(wr)h Fg(is)325
883 y(not)e(a)i(surrogate.)325 981 y Fh(END)24 b(NetStream.)225
1129 y Fk(3.3)50 b(NetObjNoti\256er)10 b(interface)225
1209 y Fn(The)f Fh(NetObjNotifier)f Fn(interface)h(allows)f(the)h
(holder)g(of)g(a)g(surrogate)g(object)f(to)h(request)g(noti\256cation)
225 1259 y(of)15 b(when)g(the)g(object')m(s)g(owner)g(becomes)g
(inaccessible.)26 b(This)15 b(can)g(be)g(useful,)h(for)g(example,)g(if)
f(it)f(is)225 1309 y(necessary)f(to)g(remove)f(surrogates)h(from)g(a)g
(table)f(upon)g(termination)g(of)h(the)f(programs)h(holding)e(their)225
1359 y(corresponding)g(concrete)h(objects.)325 1451 y
Fh(INTERFACE)24 b(NetObjNotifier;)325 1518 y(IMPORT)g(NetObj;)325
1586 y(TYPE)374 1630 y(OwnerState)g(=)h({Dead,)g(Failed};)374
1697 y(NotifierClosure)f(=)h(OBJECT)f(METHODS)424 1741
y(notify\(obj:)g(NetObj.T;)g(st:)h(OwnerState\);)374
1784 y(END;)325 1858 y(PROCEDURE)f(AddNotifier\(obj:)f(NetObj.T;)h(cl:)
h(NotifierClosure\);)325 1920 y Fg(Arrange)12 b(that)g(a)h(call)f(to)g
Ff(cl.notify)f Fg(will)h(be)g(scheduled)g(when)g Ff(obj)g
Fg(becomes)g(inaccessible.)325 1970 y(If)h Ff(obj)g Fg(is)g(not)g(a)h
(surrogate)f(object)g(then)g Ff(AddNotifier)f Fg(has)h(no)g(ef)o(fect.)
23 b(If)14 b Ff(obj)f Fg(is)g(already)325 2020 y(inaccessible)d(at)h
(the)g(time)f Ff(AddNotifier)f Fg(is)i(called,)g(then)g(a)g(call)f(to)h
Ff(cl.notify)f Fg(is)g(scheduled)325 2070 y(immediately)m(.)325
2168 y Fh(END)24 b(NetObjNotifier.)225 2242 y Fn(The)9
b Fh(notify)g Fn(method)f(of)i(a)g Fh(NotifierClosure)d
Fn(object)i(is)g(invoked)g(when)g(the)g(concrete)h(object)f(cor)o(-)225
2291 y(responding)k(to)g(the)h(surrogate)f Fh(obj)h Fn(becomes)f
(inaccessible.)23 b(The)14 b(procedure)g Fh(AddNotifier)f
Fn(must)225 2341 y(have)d(been)g(called)g(to)f(enable)h(this)f
(noti\256cation.)14 b(There)c(may)f(be)h(more)g(than)f(one)h
Fh(NotifierClosure)225 2391 y Fn(for)h(the)f(same)h(surrogate.)k(At)10
b(noti\256cation)g(time,)g(the)h Fh(st)f Fn(ar)o(gument)h(is)f
Fh(Dead)g Fn(if)h(and)f(only)g(if)h(the)f(object)1049
2516 y(24)p eop
%%Page: 25 33
25 32 bop 75 141 a Fn(owner)13 b(is)g(known)f(to)g(be)h(permanently)g
(inaccessible.)20 b(Otherwise)12 b Fh(st)h Fn(is)g Fh(Failed)p
Fn(.)19 b(It)13 b(is)g(possible)e(for)75 191 y Fh(notify)g
Fn(to)h(be)g(called)f(multiple)g(times)f(on)i(the)f(same)h(object.)17
b(Any)11 b(invocations)g(on)g Fh(obj)h Fn(are)g(guaran-)75
241 y(teed)f(to)g(fail)h(in)f(a)g(timely)f(fashion)h(subsequent)g(to)g
(a)g(closure)h(noti\256cation)e(with)h Fh(st)24 b(=)h(Dead)p
Fn(.)117 291 y(In)13 b(general,)i(a)e(surrogate)g(object)g(can)h(still)
e(be)h(collected)h(if)f(a)h(noti\256er)f(closure)g(is)g(registered)g
(for)h(it.)75 340 y(However)n(,)d(if)f(the)f(closure)h(object)g
(contains)f(a)h(reference)h(to)f(the)f(surrogate,)i(then)e(its)g
(registration)g(might)75 390 y(delay)i(or)h(prevent)f(collection.)k
(Therefore)d(this)f(should)f(be)h(avoided.)117 440 y(Although)h(this)h
(interface)h(is)g(or)o(ganized)g(to)f(enable)h(noti\256cation)f(of)h
(owner)g(death)g(on)g(a)g(per)g(object)75 490 y(basis,)e(in)g(practice)
h(this)f(is)g(achieved)g(by)h(monitoring)d(the)i(state)g(of)h(the)f
(owner)r(')m(s)h(address)f(space.)19 b(This)75 540 y(means)11
b(that)g(death)h(noti\256cation)e(will)h(be)h(more)f(or)g(less)h
(simultaneous)d(for)j(all)f(surrogates)g(whose)h(con-)75
589 y(crete)g(objects)f(have)h(the)f(same)g(owner)m(.)75
713 y Fk(3.4)50 b(The)13 b(stub)e(generator)75 794 y
Fn(The)e(stub)e(generator)i(is)f(a)h(program)f(that)g(generates)h
(stubs)e(for)i(Modula-3)f(network)g(object)g(types.)14
b(There)75 844 y(are)d(restrictions)f(on)h(the)f(subtypes)g(of)g
Fh(NetObj.T)g Fn(for)h(which)g(the)f(stub)g(generator)h(can)g(produce)g
(stubs;)75 893 y(a)h(network)f(object)g(type)g(that)g(obeys)g(them)f
(is)h(said)g(to)g(be)h Fi(valid)p Fn(.)j(Here)d(is)f(a)g(list)g(of)g
(these)g(restrictions:)124 981 y(1.)21 b(A)12 b(valid)f(network)h
(object)g(type)g(must)f(be)h(pure,)h(that)e(is)h(it)g(cannot)f(contain)
h(data)g(\256elds,)h(either)f(in)179 1031 y(its)e(declaration)i(or)f
(in)g(a)h(revelation.)124 1112 y(2.)21 b(T)m(o)14 b(generate)h(stubs)f
(for)h(a)g(network)f(object)g Fh(I.T)p Fn(,)h(the)f(stub)g(generator)h
(must)e(be)i(able)g(to)f(deter)o(-)179 1162 y(mine)d(a)i(complete)e
(revelation)h(for)h(all)e(opaque)i(supertypes)e(of)h
Fh(I.T)g Fn(\(including)f Fh(I.T)h Fn(itself,)g(if)g(it)179
1212 y(is)f(opaque\))g(up)g(to)g Fh(NetObj.T)p Fn(.)124
1294 y(3.)21 b(A)10 b(method)f(ar)o(gument)h(may)g(not)g(be)g(of)g
(type)g Fh(PROCEDURE)g Fn(or)g(have)g(a)h(component)e(that)h(is)g(of)g
(type)179 1343 y Fh(PROCEDURE)p Fn(.)h(\(A)h(network)f(object)g(with)g
(an)h(appropriate)f(method)g(can)h(always)f(be)h(sent)f(instead)179
1393 y(of)g(a)h(procedure.\))124 1475 y(4.)21 b(A)9 b(Modula-3)f
(method)g(declaration)h(speci\256es)g(the)g(set)g(of)g(exceptions)f
(that)h(the)g(method)f(can)h(raise.)179 1525 y(It)k(is)f(possible)g(to)
h(specify)g(\(via)g Fh(RAISES)g(ANY)p Fn(\))g(that)f(any)h(exception)g
(can)g(be)h(raised,)g(but)e(this)g(is)179 1574 y(not)f(allowed)g(for)g
(a)h(valid)f(network)g(object)g(type.)124 1656 y(5.)21
b(The)11 b(methods)f(of)i(the)f(type)g(and)g(its)g(supertypes)g(must)f
(have)i(distinct)d(names.)117 1743 y(Given)i(a)i(valid)f(network)f
(object)h(type,)h(the)f(stub)f(generator)i(lays)f(down)g(code)g(that)g
(implements)e(pa-)75 1793 y(rameter)k(marshaling)e(and)i(remote)f
(invocation)f(for)i(that)f(type')m(s)g(methods.)20 b(For)14
b(both)f(ar)o(guments)g(and)75 1843 y(results,)i(subtypes)e(of)h
Fh(NetObj.T)f Fn(are)i(marshaled)f(as)h(network)f(references,)i
(subtypes)e(of)g Fh(Rd.T)g Fn(and)75 1893 y Fh(Wr.T)c
Fn(are)i(marshaled)e(as)h(surrogate)f(streams,)h(and)f(all)h(other)f
(parameters)h(are)h(marshaled)e(by)g(copying.)75 1943
y(The)h(copying)g(is)g(performed)g(by)h(the)f(pickles)f(package)i(if)g
(the)f(parameter)h(is)f(a)h(reference.)117 1993 y Fh(VALUE)e
Fn(and)g Fh(READONLY)g Fn(parameters)h(are)h(copied)e(only)g(once,)i
(from)e(the)g(caller)i(to)e(the)g(owner)h(of)g(the)75
2042 y(object.)j Fh(VAR)7 b Fn(parameters)h(are)h(normally)d(copied)i
(from)f(caller)h(to)g(owner)g(on)f(the)g(call,)i(and)f(from)f(owner)h
(to)75 2092 y(caller)h(when)f(the)g(call)h(returns.)14
b(The)9 b(pragma)f Fh(<*OUT*>)g Fn(on)g(a)h Fh(VAR)f
Fn(parameter)h(in)f(a)g(method)g(declaration)75 2142
y(indicates)g(that)h(the)f(parameter)i(may)e(be)h(given)f(an)h
(arbitrary)g(legal)g(value)g(when)f(the)h(method)f(is)g(invoked.)75
2192 y(The)14 b(stub)e(generator)i(may)g(use)f(this)g(information)f(to)
h(optimize)f(method)h(invocation)f(by)i(not)f(copying)75
2242 y(the)e(parameter)r(')m(s)h(value)g(from)f(caller)h(to)f(owner)m
(.)16 b(At)11 b(present,)h(the)f(stub)g(generator)g(does)h(not)e(make)i
(this)75 2291 y(optimization.)117 2341 y(Any)c(change)h(in)f
(marshaling)g(protocol)f(that)h(would)g(make)h(stubs)e(incompatible)g
(is)i(implemented)e(as)h(a)75 2391 y(new)g(version)f(of)h(the)g(stub)f
(generator)m(.)15 b(T)m(ypically)m(,)8 b(the)g(previous)f(version)g
(will)g(continue)g(to)h(be)g(supported)899 2516 y(25)p
eop
%%Page: 26 34
26 33 bop 225 141 a Fn(for)9 b(some)f(time)g(after)i(the)f(release)g
(of)g(a)g(new)g(one.)15 b(Thus,)9 b(multiple)e(versions)h(of)h(the)g
(stub)f(generator)h(may)225 191 y(sometimes)h(exist)g(at)i(the)f(same)g
(time.)267 241 y(Stubs)h(for)h(multiple)f(versions)g(may)h(be)g(linked)
f(into)g(the)h(same)g(program.)20 b(Method)12 b(invocation)g(be-)225
291 y(tween)f(two)f(programs)g(is)g(possible)g(so)g(long)g(as)h(the)f
(owner)h(and)g(the)f(caller)h(have)g(at)g(least)f(one)h(common)225
340 y(version)h(of)g(the)h(stubs)e(for)i(the)f(network)g(object)g(in)g
(question.)18 b(The)12 b(network)h(object)f(runtime)f(will)h(use)225
390 y(the)e(most)f(recent)h(version)g(of)g(the)g(protocol)f(that)g(is)h
(available)g(in)f(both)h(programs.)k(This)9 b(allows)h(gradual)225
440 y(migration)g(of)h(applications)g(from)g(the)g(old)g(to)g(the)g
(new)g(protocol.)225 587 y Fj(4)58 b(Internal)15 b(Interfaces)225
684 y Fn(In)10 b(this)f(section)g(we)i(present)f(the)f(main)h(internal)
f(systems)g(interfaces.)16 b(The)10 b(typical)f(programmer)h(using)225
734 y(network)h(objects)f(has)h(no)g(need)g(to)g(read)g(them,)g(but)g
(we)g(present)g(them)f(here)i(in)f(order)g(to)g(document)f(the)225
783 y(structure)h(of)f(the)h(system.)j(These)d(are)g(the)g(interfaces)g
(you)f(would)g(use)h(to)f(write)h(a)g(new)g(stub)f(generator)n(,)225
833 y(hand-code)g(stubs)e(for)i(some)e(particular)i(network)f(object)g
(type,)h(or)f(add)g(a)h(new)g(transport)e(to)h(the)g(system.)225
958 y Fk(4.1)50 b(StubLib)11 b(interface)225 1039 y Fn(This)g
(interface)i(contains)e(procedures)i(to)e(be)i(used)e(by)h(stub)f(code)
i(for)f(invoking)f(remote)g(object)h(meth-)225 1089 y(ods)i(and)g
(servicing)g(remote)h(invocations.)23 b(Each)15 b(stub)f(module)f
(provides)h(type-dependent)g(network)225 1138 y(support)e(for)i
(marshaling)f(and)g(unmarshaling)f(method)g(calls)i(for)f(a)h
(speci\256c)g(subtype)e(of)i Fh(NetObj.T)p Fn(.)225 1188
y(Usually)m(,)d(stubs)g(are)i(built)d(automatically)m(.)16
b(For)c(each)h Fh(NetObj.T)e Fn(subtype)g Fh(T)h Fn(intended)f(to)g
(support)g(re-)225 1238 y(mote)e(method)f(invocation)g(there)h(must)g
(be)g(both)f(a)i(client)f(and)g(a)g(server)h(stub.)k(The)c(client)e
(stub)h(de\256nes)g(a)225 1288 y(subtype)e(of)h Fh(T)f
Fn(in)h(which)f(every)h(method)f(is)g(overridden)h(by)f(a)h(procedure)h
(implementing)c(remote)j(method)225 1338 y(invocation.)15
b(Such)c(a)h(surrogate)f(object)g(is)g(constructed)g(by)g(the)h
(network)f(object)g(runtime)f(whenever)i(a)225 1387 y(reference)h(to)e
(a)h(non-local)f(object)g(is)g(encountered.)17 b(The)11
b(server)h(stub)f(consists)f(of)i(a)f(single)g(procedure)225
1437 y(of)j(type)f Fh(Dispatcher)g Fn(that)g(is)g(called)g(to)h
(unmarshal)e(and)i(dispatch)f(remote)g(invocations.)21
b(A)14 b(surro-)225 1487 y(gate)e(type)f(and)h(null)e(dispatcher)i(for)
f Fh(NetObj.T)g Fn(are)i(de\256ned)f(and)f(registered)h(by)f(the)h
(network)f(object)225 1537 y(system)f(itself.)325 1631
y Fh(INTERFACE)24 b(StubLib;)325 1699 y(IMPORT)g(Atom,)g(AtomList,)g
(NetObj,)h(Rd,)f(Wr,)h(Thread;)325 1774 y(TYPE)f(Conn)h(<:)f(ROOT;)225
1849 y Fn(A)15 b(remote)f(object)h(invocation)e(can)j(be)f(viewed)f(as)
h(an)g(exchange)g(of)g(messages)f(between)h(client)g(and)225
1899 y(server)m(.)21 b(The)13 b(messages)g(are)g(exchanged)h(via)e(an)h
(object)g(of)g(type)f Fh(Conn)p Fn(,)i(which)e(is)h(opaque)g(in)f(this)
g(in-)225 1949 y(terface.)19 b(The)13 b Fh(StubConn)e
Fn(interface)i(reveals)g(more)f(of)g(this)f(type')m(s)h(structure)h(to)
e(clients)h(who)g(wish)f(to)225 1998 y(hand-code)i(stubs)f(for)h(ef)o
(\256ciency)m(.)22 b(A)13 b Fh(Conn)f Fn(is)h(unmonitored:)j(clients)c
(must)g(not)g(access)i(it)e(from)h(two)225 2048 y(threads)e
(concurrently)m(.)325 2142 y Fh(TYPE)374 2185 y(Byte8)25
b(=)g(BITS)f(8)h(FOR)g([0..255];)374 2229 y(DataRep)g(=)g(RECORD)424
2273 y(private,)f(intFmt,)h(floatFmt,)f(charSet:)g(Byte8;)374
2316 y(END;)325 2391 y(VAR)g(\(*CONST*\))g(NativeRep:)g(DataRep;)1049
2516 y Fn(26)p eop
%%Page: 27 35
27 34 bop 75 141 a Fn(The)9 b(type)g Fh(DataRep)g Fn(describes)g(the)g
(format)g(used)g(to)g(encode)h(characters,)h(integers,)f(and)f
(\257oating)g(point)75 191 y(numbers)f(in)g(network)g(data.)14
b(Data)9 b(is)f(always)g(marshaled)g(in)g(the)g(sender)r(')m(s)h
(native)f(format.)14 b Fh(NativeRep)75 241 y Fn(is)d(a)h(runtime)e
(constant)h(that)g(describes)g(the)g(native)g(format)g(of)h(the)f
(current)h(environment.)117 291 y(Stubs)d(may)g(optimize)g(in-line)g
(unmarshaling)f(by)h(\256rst)h(checking)g(that)f(the)h(incoming)e
(representation)75 340 y(is)i(the)h(same)f(as)h(the)g(native)f(one)h
(for)g(all)f(data)h(types)f(relevant)h(to)f(the)h(call.)k(If)c(it)f(is)
h(not,)f(then)h(the)f(generic)75 390 y(data)h(unmarshaling)f(routines)h
(at)g(the)h(end)f(of)g(this)g(interface)h(should)e(be)i(used.)117
440 y(Automatic)e(conversion)g(between)i(the)f(data)g(representations)g
(is)f(performed)i(wherever)g(possible.)i(If)75 490 y(conversion)9
b(is)g(impossible,)f Fh(NetObj.Error)g Fn(is)h(raised)g(with)g
Fh(NetObj.UnsupportedDataRep)e Fn(in)75 540 y(the)k(ar)o(gument)g(atom)
g(list.)117 589 y(Concrete)g(values)f(for)h(the)f(elements)g(of)g
Fh(DataRep)g Fn(are)h(not)f(de\256ned)h(here)g(as)f(it)g(is)g(suf)o
(\256cient)h(to)f(com-)75 639 y(pare)g(against)f Fh(NativeRep)g
Fn(and)g(invoke)g(the)h(marshaling)e(procedures)i(de\256ned)g(below)f
(if)h(the)f(encoding)75 689 y(is)i(non-native.)175 777
y Fh(TYPE)224 821 y(Int32)25 b(=)50 b(BITS)24 b(32)h(FOR)f
([-16_7FFFFFFF-1..16_7FFFFFFF];)224 864 y(StubProtocol)g(=)h(Int32;)175
930 y(CONST)224 974 y(NullStubProtocol)f(=)h(-1;)224
1024 y(SystemStubProtocol)f(=)g(0;)75 1096 y Fn(The)14
b(type)f Fh(StubProtocol)g Fn(indicates)g(the)h(version)f(of)h(the)g
(stub)e(compiler)i(used)f(to)g(generate)i(a)f(par)o(-)75
1146 y(ticular)d(stub.)j(Multiple)c(stubs)g(for)h(the)g(same)g(network)
g(object)g(can)h(coexist)e(within)g(the)h(same)g(program)75
1195 y(\(for)g(example,)f(the)g(outputs)f(of)i(dif)o(ferent)f(stub)g
(compilers\).)k(During)c(surrogate)g(creation,)h(the)f(network)75
1245 y(object)h(runtime)f(negotiates)h(the)g(stub)g(protocol)f(version)
h(with)g(the)g(object)g(owner)m(.)117 1295 y Fh(NullStubProtocol)e
Fn(is)h(a)g(placeholder)h(to)f(indicate)g(the)h(absence)g(of)f(a)h
(stub)f(protocol)f(value.)16 b(The)75 1345 y(value)9
b Fh(SystemStubProtocol)f Fn(indicates)g(the)i(\256xed)f(stub)g
(encoding)f(used)h(by)g(the)g(runtime)g(to)f(imple-)75
1395 y(ment)j(primitives)e(that)i(operate)h(prior)f(to)g(any)h(version)
e(negotiation.)175 1489 y Fh(VAR)24 b(\(*CONST*\))g(UnmarshalFailure:)g
(Atom.T;)75 1561 y(UnmarshalFailure)10 b Fn(should)h(be)h(used)f(as)h
(an)g(ar)o(gument)f(to)h Fh(NetObj.Error)e Fn(whenever)j(stubs)d(en-)75
1611 y(counter)g(a)h(network)e(datum)h(that)f(is)h(incompatible)f(with)
g(the)h(tar)o(get)g(type.)15 b(For)c(example,)f(the)g(stub)f(code)75
1661 y(might)k(encounter)h(a)h Fh(CARDINAL)e Fn(value)h(greater)h(than)
f Fh(LAST\(CARDINAL\))f Fn(or)h(an)h(unrecognized)f(re-)75
1711 y(mote)d(method)f(speci\256cation.)175 1805 y Fh(TYPE)24
b(Typecode)g(=)h(CARDINAL;)75 1877 y(Typecode)11 b Fn(is)g(the)g(type)g
(of)g(those)g(values)g(returned)h(by)f(the)g(Modula-3)f
Fh(TYPECODE)h Fn(operator)m(.)175 1965 y Fh(PROCEDURE)24
b(Register\()274 2009 y(pureTC:)h(Typecode;)f(stubProt:)g
(StubProtocol;)274 2059 y(surrTC:)h(Typecode;)f(disp:)g(Dispatcher\);)
175 2120 y Fg(Let)11 b Ff(T)g Fg(be)h(the)f(type)h(whose)f(typecode)g
(is)g Ff(pureTC)p Fg(,)h(and)f(let)g Ff(srgT)g Fg(be)h(the)f(type)h
(whose)f(typecode)175 2169 y(is)h Ff(surrTC)p Fg(.)g(Set)h(the)f
(client)g(surrogate)h(type)f(and)g(dispatch)g(procedure)h(for)g
Ff(T)g Fg(to)f(be)g Ff(srgT)g Fg(and)175 2219 y Ff(disp)p
Fg(,)g(respectively)m(.)17 b(The)12 b Ff(stubProt)g Fg(parameter)g
(indicates)g(the)f(stub)h(compiler)f(version)g(that)175
2269 y(generated)h(the)f(stub)f(being)h(registered.)75
2341 y Fn(The)g(following)e(constraint)h(applies)h(to)f(stub)g
(registration.)15 b(If)c(stubs)f(are)h(registered)g(for)g(types)g
Fh(A)f Fn(and)h Fh(B)p Fn(,)75 2391 y(where)i Fh(B)f
Fn(is)f(a)i(supertype)e(of)h Fh(A)p Fn(,)h(then)e(the)h(protocol)g
(versions)f(registered)h(for)g Fh(B)g Fn(must)f(be)i(a)f(superset)g(of)
899 2516 y(27)p eop
%%Page: 28 36
28 35 bop 225 141 a Fn(the)12 b(versions)g(registered)g(for)h
Fh(A)p Fn(.)f(If)h(this)e(rule)h(is)g(violated,)g(attempts)f(to)h
(invoke)g(remote)g(methods)f(may)225 191 y(raise)h Fh(NetObj.Error)p
Fn(.)267 241 y(Note)e(that)f(a)i(concrete)g(object)f(of)g(type)g
Fh(A)g Fn(will)f(receive)i(method)e(invocations)g(only)h(for)g(stub)f
(versions)225 291 y(for)h(which)f Fh(A)g Fn(is)g(registered.)15
b(This)8 b(is)h(true)h(even)f(if)g(a)h(supertype)f(of)g
Fh(A)h Fn(is)f(registered)g(with)g(additional)f(stub)225
340 y(versions.)267 390 y Fh(Register)i Fn(must)g(be)i(called)f(before)
h(any)g(object)f(of)g(type)g Fh(T)h Fn(is)e(marshaled)i(or)f
(unmarshaled.)225 505 y Fo(Client)h(stub)g(pr)o(ocedur)o(es)225
586 y Fn(Here)g(is)e(a)i(simpli\256ed)e(sketch)h(of)g(the)g(procedure)g
(calls)g(performed)h(by)f(a)g(client)g(to)f(make)h(a)h(remote)f(call)
225 636 y(to)g(a)h(method)e(of)h Fh(obj)p Fn(:)391 708
y Fh(VAR)441 758 y(c)25 b(:=)f(StartCall\(obj,)g(stubProt\);)441
808 y(resDataRep:)g(DataRep;)391 857 y(BEGIN)441 907
y(<marshal)g(to)h("c")f(the)h(number)f(of)h(this)g(method>)441
957 y(<marshal)f(to)h("c")f(the)h(method)f(arguments>)441
1007 y(resDataRep)g(:=)h(AwaitResult\(conn\);)441 1057
y(<unmarshal)f(from)g("c")h(the)g(method)f(results>)441
1106 y(<results)g(will)h(be)f(in)h(wire)g(format)f("resDataRep">)441
1156 y(EndCall\(c,)g(TRUE\))391 1206 y(END;)225 1278
y Fn(For)15 b(both)e(ar)o(guments)h(and)g(results,)h(the)f(sender)g
(always)g(marshals)g(values)g(in)f(its)h(native)g(format;)h(the)225
1328 y(receiver)d(performs)e(any)h(conversions)f(that)g(may)g(be)h
(needed.)16 b(The)10 b(procedure)i(result)e(typically)f(begins)225
1378 y(with)i(an)h(integer)g(specifying)g(either)g(a)g(normal)f(return)
h(or)h(an)f(exceptional)f(return.)18 b(If)12 b(a)h(protocol)e(error)225
1428 y(occurs,)f(the)e(client)g(should)f(call)i Fh(EndCall\(c,)24
b(FALSE\))8 b Fn(instead)f(of)i Fh(EndCall\(c,)24 b(TRUE\))p
Fn(.)8 b(This)g(re-)225 1478 y(quires)g Fh(TRY)24 b(FINALLY)8
b Fn(instead)f(of)h(the)g(simple)f(straight-line)g(code)h(above;)h(a)g
(more)e(complete)h(example)225 1527 y(is)j(presented)g(in)g(the)g(next)
g(section.)267 1577 y(Here)h(are)g(the)f(speci\256cations)g(of)g(the)h
(client)f(protocol)f(procedures:)325 1666 y Fh(PROCEDURE)24
b(StartCall\(obj:)f(NetObj.T;)h(stubProt:)g(StubProtocol\):)g(Conn)424
1716 y(RAISES)h({NetObj.Error,)e(Wr.Failure,)h(Thread.Alerted};)325
1777 y Fg(Return)12 b(a)g(connection)g(to)f(the)h(owner)g(of)g
Ff(obj)p Fg(,)g(write)g(to)g(the)f(connection)h(a)g(protocol)f(request)
h(to)325 1827 y(perform)g(a)h(remote)f(method)f(call)i(to)f
Ff(obj)p Fg(,)h(using)e(the)h(data)h(representation)f
Ff(NativeRep)p Fg(.)17 b(The)325 1876 y(value)10 b Ff(stubProt)f
Fg(is)g(the)h(stub)f(protocol)g(version)h(under)g(which)f(the)h(ar)o
(guments)f(and)h(results)g(will)325 1926 y(be)h(encoded.)225
1999 y Fn(Upon)i(return)h(from)f Fh(StartCall)p Fn(,)h(the)f(client)g
(stub)g(should)f(marshal)h(a)h(speci\256cation)g(of)f(the)h(method)225
2048 y(being)d(invoked)f(followed)h(by)g(any)h(ar)o(guments.)325
2137 y Fh(PROCEDURE)24 b(AwaitResult\(c:)f(Conn\):)i(DataRep)424
2181 y(RAISES)g({NetObj.Error,)e(Rd.Failure,)h(Wr.Failure,)624
2230 y(Thread.Alerted};)325 2291 y Ff(AwaitResult)11
b Fg(indicates)h(the)h(end)g(of)g(the)f(ar)o(guments)g(for)h(the)g
(current)g(method)f(invocation,)325 2341 y(and)e(blocks)f(waiting)g
(for)i(a)f(reply)g(message)g(containing)f(the)h(result)g(of)g(the)g
(invocation.)k(It)c(returns)325 2391 y(the)h(data)g(representation)g
(used)h(to)e(encode)i(the)f(result)g(message.)1049 2516
y Fn(28)p eop
%%Page: 29 37
29 36 bop 75 141 a Fn(Upon)11 b(return)g(from)h Fh(AwaitResult)e
Fn(the)h(client)g(stub)g(should)f(unmarshal)g(any)i(results.)175
229 y Fh(PROCEDURE)24 b(EndCall\(c:)g(Conn;)g(reUse:)g(BOOLEAN\))274
272 y(RAISES)h({NetObj.Error,)e(Rd.Failure,)h(Wr.Failure,)474
322 y(Thread.Alerted};)175 383 y Ff(EndCall)11 b Fg(must)g(be)i(called)
f(at)h(the)f(end)g(of)h(processing)e(a)i(remote)f(invocation,)g
(whether)g(or)h(not)175 433 y(the)f(invocation)f(raised)i(an)f
(exception.)19 b(The)12 b(ar)o(gument)h Ff(reUse)f Fg(must)f(be)i
Ff(FALSE)f Fg(if)g(the)g(client)175 483 y(has)h(been)h(unable,)g(for)f
(any)h(reason,)g(to)f(unmarshal)g(either)g(a)h(normal)e(or)i
(exceptional)f(result.)175 533 y(It)f(is)h(always)f(safe)i(to)e(call)h
Ff(EndCall)f Fg(with)g Ff(reUse)h Fg(set)f(to)h Ff(FALSE)p
Fg(,)g(but)f(performance)h(will)f(be)175 582 y(improved)e(if)h
Ff(reUse)g Fg(is)g Ff(TRUE)g Fg(whenever)h(possible.)75
654 y Fh(EndCall)c Fn(determines,)g(by)g(examining)f
Fh(c)p Fn(,)i(whether)f(the)g(result)g(message)g(requires)g
(acknowledgement,)75 704 y(that)i(is,)h(whether)g(the)g(result)f
(contained)g(any)h(network)g(objects.)j(If)e(an)f(acknowledgement)f(is)
g(required,)75 754 y(it)h(is)g(sent.)k Fh(EndCall)c Fn(then)g(releases)
h Fh(c)p Fn(.)j(After)d Fh(EndCall)f Fn(returns,)g Fh(c)h
Fn(should)e(not)h(be)g(used.)75 869 y Fo(Server)i(dispatcher)g(pr)o
(ocedur)o(es)75 949 y Fn(Next)e(we)h(consider)f(the)g(server)o(-side)h
(stub,)f(which)g(consists)f(of)h(a)h(registered)g(dispatcher)f
(procedure.)175 1037 y Fh(TYPE)24 b(Dispatcher)g(=)h(PROCEDURE\()224
1080 y(c:)g(Conn;)g(obj:)f(NetObj.T;)g(rep:)h(DataRep;)f(stubProt:)g
(StubProtocol\))224 1130 y(RAISES)h({NetObj.Error,)e(Rd.Failure,)h
(Wr.Failure,)g(Thread.Alerted};)75 1202 y Fn(A)9 b(procedure)h(of)g
(type)f Fh(Dispatcher)f Fn(is)h(registered)h(for)f(each)i(network)e
(object)g(type)g Fh(T)g Fn(for)h(which)f(stubs)75 1252
y(exist.)15 b(The)10 b(dispatcher)g(is)g(called)g(by)g(the)h(network)f
(object)g(runtime)f(when)h(it)g(receives)h(a)g(remote)f(object)75
1302 y(invocation)i(for)i(an)f(object)g(of)g(type)g Fh(T)p
Fn(.)h(The)f Fh(rep)g Fn(ar)o(gument)g(indicates)g(the)g(data)g
(representation)g(used)75 1352 y(to)e(encode)h(the)f(ar)o(guments)g(of)
g(the)h(invocation.)i(The)e Fh(stubProt)f Fn(ar)o(gument)g(indicates)f
(the)i(version)f(of)75 1401 y(stub)f(protocol)g(used)g(to)g(encode)h
(the)f(call)h(ar)o(guments.)k(The)10 b(same)h(protocol)f(should)f(be)i
(used)f(to)g(encode)75 1451 y(any)h(results.)117 1501
y(The)i(dispatcher)f(procedure)i(is)e(responsible)g(for)i(unmarshaling)
d(the)i(method)f(number)h(and)g(any)g(ar)o(-)75 1551
y(guments,)e(invoking)e(the)j(concrete)g(object')m(s)f(method,)g(and)g
(marshaling)g(any)g(results.)117 1601 y(Here)h(is)f(a)g(simpli\256ed)f
(sketch)h(of)h(a)g(typical)e(dispatcher:)216 1673 y Fh(PROCEDURE)24
b(Dispatch\(c,)g(obj,)h(rep\))f(=)266 1722 y(BEGIN)316
1772 y(<unmarshal)g(from)g("c")h(the)g(method)f(number>)316
1822 y(<unmarshal)g(from)g("c")h(the)g(method)f(arguments>)316
1872 y(<arguments)g(will)g(be)h(in)g(the)f(wire)h(format)f("rep">)316
1922 y(<call)g(the)h(appropriate)f(method)g(of)h("obj">)316
1971 y(StartResult\(c\);)316 2021 y(<marshal)f(to)h("c")f(the)h(method)
f(result)h(or)f(exception>)266 2071 y(END)h(Dispatch;)75
2143 y Fn(Here)12 b(is)f(the)g(speci\256cation)g(of)h
Fh(StartResult)p Fn(:)175 2231 y Fh(PROCEDURE)24 b(StartResult\(c:)f
(Conn\))274 2280 y(RAISES)i({Wr.Failure,)e(Thread.Alerted};)175
2341 y Ff(StartResult)14 b Fg(must)f(be)j(called)f(by)f(the)h(server)h
(stub)e(to)h(initiate)e(return)i(from)g(a)h(remote)175
2391 y(invocation)10 b(before)i(marshaling)e(any)i(results.)899
2516 y Fn(29)p eop
%%Page: 30 38
30 37 bop 225 141 a Fn(Upon)8 b(return)h(from)f Fh(StartResult)g
Fn(the)g(stub)g(code)h(should)e(marshal)h(any)h(results)f(or)g(error)i
(indications.)225 257 y Fo(Marshaling)h(of)h(r)o(efer)o(ence)i(types)
225 338 y Fn(The)d(following)f(procedures)i(are)g(made)g(available)f
(for)h(marshaling)e(of)h(subtypes)g(of)g Fh(REFANY)p
Fn(.)325 430 y Fh(PROCEDURE)24 b(OutRef\(c:)g(Conn;)g(r:)h(REFANY\))424
480 y(RAISES)g({Wr.Failure,)e(Thread.Alerted};)325 542
y Fg(Marshal)12 b(the)g(data)h(structure)f(reachable)h(from)g
Ff(r)p Fg(.)19 b(Certain)13 b(datatypes)f(are)h(handled)f(specially:)
325 592 y(subtypes)g(of)h Ff(NetObj.T)f Fg(are)i(marshaled)f(as)g
(network)g(references.)23 b(Subtypes)12 b(of)i Ff(Rd.T)f
Fg(and)325 642 y Ff(Wr.T)e Fg(are)i(marshaled)e(as)h(surrogate)g
(streams.)17 b(The)12 b(types)f Ff(TEXT)h Fg(and)f Ff(REF)25
b(ARRAY)f(OF)h(TEXT)325 692 y Fg(are)14 b(marshaled)g(by)g(copying)f
(via)h(custom)f(code)h(for)h(speed.)23 b(All)14 b(others)f(are)i
(marshaled)f(by)325 741 y(copying)f(as)h(pickles.)22
b(Subtypes)13 b(of)h Ff(NetObj.T)p Fg(,)g Ff(Rd.T)p Fg(,)g(and)f
Ff(Wr.T)h Fg(which)f(are)i(embedded)325 791 y(within)10
b(other)h(datatypes)g(are)h(also)f(marshaled)g(by)g(reference.)325
884 y Fh(PROCEDURE)24 b(InRef\(c:)g(Conn;)g(rep:)h(DataRep;)f
(tc:=-1\):)g(REFANY)424 934 y(RAISES)h({NetObj.Error,)e(Rd.Failure,)h
(Thread.Alerted};)325 996 y Fg(Unmarshal)14 b(a)h(marshaled)f(subtype)g
(of)h Ff(REFANY)f Fg(as)h(pickled)f(by)g Ff(OutRef)p
Fg(.)25 b(If)16 b Ff(tc)e Fg(is)g(non-)325 1045 y(negative,)h(it)f(is)h
(the)f(typecode)h(for)g(the)f(intended)g(type)h(of)f(the)h(reference.)
27 b(The)15 b(exception)325 1095 y Ff(NetObj.Error\(UnmarshalFailure\))
6 b Fg(is)i(raised)i(if)f(the)f(unpickled)h(result)f(is)h(not)f(a)i
(subtype)325 1145 y(of)h(this)f(type.)16 b(If)c Ff(tc)f
Fg(is)g(negative,)g(no)g(type)g(checking)h(is)e(performed.)225
1219 y Fh(OutRef)g Fn(and)h Fh(InRef)f Fn(use)g(pickles)g(and)g
(therefore)i(are)f(af)o(fected)h(by)e(any)h(custom)e(pickling)g
(procedures)225 1269 y(that)g(have)h(been)g(registered.)15
b(The)9 b(network)g(objects)g(runtime)g(itself)g(registers)g
(procedures)h(for)g(pickling)225 1319 y(network)f(objects)g(and)h
(streams.)15 b(Therefore,)c(for)f(any)g(network)f(objects)g(or)h
(streams)f(that)g(are)i(reachable)225 1369 y(from)g(the)g(reference)j
Fh(r)d Fn(are)h(pickled)f(by)g(reference)i(as)f(described)f(elsewhere)h
(in)f(this)f(report.)225 1485 y Fo(Marshaling)h(of)h(generic)g(data)225
1565 y Fn(The)j Fh(StubLib)f Fn(interface)i(also)e(provides)g(a)h
(suite)f(of)h(procedures)g(to)g(facilitate)f(the)h(marshaling)f(and)225
1615 y(unmarshaling)8 b(of)h(primitive)e(data)j(types.)k(For)9
b(the)g(sake)h(of)f(brevity)m(,)g(we)g(use)g(the)g Fh(INTEGER)g
Fn(datatype)g(as)225 1665 y(an)i(example.)k(The)c(actual)g(interface)g
(provides)f(routines)g(to)h(handle)f(all)h(other)f(types)g(that)h(are)g
(primitive)225 1715 y(in)g(Modula-3)f(such)i(as)f Fh(CARDINAL)p
Fn(,)g Fh(REAL)p Fn(,)h(and)f Fh(LONGREAL)p Fn(.)325
1807 y Fh(PROCEDURE)24 b(OutInteger\(c:)f(Conn;)i(i:)g(INTEGER\))424
1857 y(RAISES)g({Wr.Failure,)e(Thread.Alerted};)325 1974
y(PROCEDURE)h(InInteger\(c:)f(Conn;)i(rep:)f(DataRep;)424
2018 y(min)h(:=)g(FIRST\(INTEGER\);)e(max)i(:=)f(LAST\(INTEGER\)\):)g
(INTEGER)424 2068 y(RAISES)h({NetObj.Error,)e(Rd.Failure,)h
(Thread.Alerted};)225 2142 y Fn(Since)16 b(all)f(marshaling)g
(procedures)h(output)e(their)h(parameters)h(in)f(the)h(native)f
(representation)g(of)h(the)225 2192 y(sender)n(,)11 b(they)e(can)g(be)h
(trivially)e(replaced)i(by)f(inline)f(code)i(that)f(manipulates)f(the)h
(writer)h(buf)o(fer)g(directly)m(.)225 2242 y(All)k(unmarshaling)g
(procedures)h(decode)g(the)g(incoming)e(wire)i(representation)f(as)h
(indicated)f(by)h Fh(rep)225 2291 y Fn(and)e(return)f(their)h(results)f
(in)g(native)g(format.)20 b(These)12 b(procedures)h(can)g(be)g
(replaced)h(by)e(inline)g(unmar)o(-)225 2341 y(shaling)j(code)h
(whenever)g(the)g(relevant)g(elements)f(of)h Fh(rep)g
Fn(match)f(the)h(corresponding)f(elements)h(of)225 2391
y Fh(NativeRep)p Fn(.)1049 2516 y(30)p eop
%%Page: 31 39
31 38 bop 117 141 a Fn(Finally)m(,)9 b(the)f Fh(StubLib)g
Fn(interface)h(provides)f(two)g(procedures)h(for)g(raising)f
Fh(NetObj)g Fn(exceptions)g(con-)75 191 y(veniently:)175
292 y Fh(PROCEDURE)24 b(RaiseUnmarshalFailure\(\))e(RAISES)j
({NetObj.Error};)175 355 y Fg(Raise)12 b Ff(NetObj.Error)e
Fg(with)g(UnmarshalFailure)i(in)e(the)i(ar)o(gument)f(list.)175
455 y Fh(PROCEDURE)24 b(RaiseCommFailure\(e:)f(AtomList.T\))h(RAISES)g
({NetObj.Error};)175 518 y Fg(Raise)12 b Ff(NetObj.Error)e
Fg(with)g(the)i(result)e(of)i(prepending)f Ff(NetObj.CommFailure)f
Fg(to)g Ff(e)p Fg(.)175 619 y Fh(END)24 b(StubLib.)75
745 y Fk(4.2)50 b(An)12 b(example)h(stub)75 826 y Fn(This)8
b(subsection)f(illustrates)h(the)g(use)h(of)f(the)h Fh(StubLib)f
Fn(interface)h(by)g(presenting)e(hand-generated)j(stub)75
876 y(code)i(for)f(a)h(simple)e(network)h(object)g(type,)h
Fh(Example.T)p Fn(:)175 945 y Fh(INTERFACE)24 b(Example;)175
1014 y(IMPORT)g(NetObj,)g(Thread;)175 1083 y(EXCEPTION)g(Invalid;)175
1152 y(TYPE)224 1196 y(T)h(=)g(NetObj.T)f(OBJECT)h(METHODS)274
1239 y(get\(key:)f(TEXT\))h(:)g(TEXT)374 1283 y(RAISES)f({Invalid,)g
(NetObj.Error,)g(Thread.Alerted};)224 1326 y(END;)175
1402 y(END)g(Example.)75 1477 y Fn(Notice)14 b(that)g(the)h(object)f
(methods)f(must)g(raise)i Fh(NetObj.Error)e Fn(or)i(else)f
(communications)f(failures)75 1527 y(will)g(be)i(treated)f(as)g
(checked)h(runtime)f(errors.)24 b(Also)14 b(notice)g(that)f
Fh(Thread.Alerted)g Fn(is)h(present)g(in)75 1577 y(the)h
Fh(RAISES)g Fn(clause)g(of)g(all)g(methods.)26 b(This)14
b(is)h(not)f(required,)j(but)e(is)f(strongly)g(advised.)27
b(If)15 b(an)h(ob-)75 1627 y(ject)d(method)g(does)g(not)f(propagate)i
(the)f Fh(Thread.Alerted)f Fn(exception,)i(then)f(not)g(only)f(is)h(it)
g(impos-)75 1676 y(sible)c(to)h(alert)g(remote)g(invocations,)f(but)g
(the)h(server)h(implementation)c(must)i(guarantee)i(that)e
Fh(Alerted)75 1726 y Fn(will)i(never)i(be)g(raised.)18
b(This)11 b(guarantee)i(must)e(hold)h(even)g(though)g(the)g(network)g
(object)g(runtime)f(uses)75 1776 y Fh(Thread.Alert)f
Fn(to)h(recover)i(server)f(threads)f(when)g(the)g(client)g(address)h
(space)f(dies.)117 1826 y(The)g(following)f(module)g(de\256nes)i(and)f
(registers)h(both)e(client)h(and)g(server)h(stubs)f(for)g
Fh(Example.T)p Fn(:)175 1895 y Fh(MODULE)24 b(Example;)175
1964 y(IMPORT)g(NetObj,)g(StubLib,)g(Thread,)h(Rd,)f(Wr;)175
2040 y(TYPE)g(P)h(=)g({)g(Get)f(};)50 b(R)25 b(=)f({)h(OK,)g(Invalid)f
(};)75 2115 y Fn(The)12 b(enumerated)g(types)f Fh(P)h
Fn(and)f Fh(R)h Fn(de\256ne)h(values)e(to)g(be)h(associated)g(with)f
(the)h(methods)e(of)i Fh(T)g Fn(and)f(with)75 2165 y(the)g(various)g
(results)g(\(normal)g(return)g(or)h(exception\))f(of)g(these)g
(methods.)175 2266 y Fh(TYPE)24 b(StubT)h(=)f(T)h(OBJECT)g(OVERRIDES)f
(get)g(:=)h(SurrogateGet;)f(END;)75 2341 y Fn(The)12
b(type)f Fh(StubT)g Fn(is)h(the)f(surrogate)h(object)f(type)g(for)h
Fh(T)p Fn(.)g(It)g(provides)f(method)g(overrides)g(that)h(perform)75
2391 y(remote)f(invocation.)899 2516 y(31)p eop
%%Page: 32 40
32 39 bop 325 141 a Fh(CONST)24 b(StubVersion)g(=)h
(StubLib.SystemStubProtocol;)225 220 y Fn(This)9 b(constant)f(will)g
(be)i(set)f(by)g(the)g(stub)f(generator)i(to)f(denote)g(the)g(stub)g
(generator)g(version)g(that)g(created)225 270 y(a)j(given)f(stub.)325
369 y Fh(PROCEDURE)24 b(SurrogateGet)f(\(t:)i(StubT;)f(key:)h(TEXT\))f
(:)h(TEXT)424 413 y(RAISES)g({Invalid,)f(NetObj.Error,)f
(Thread.Alerted})h(=)374 457 y(VAR)h(reuse)g(:=)f(FALSE;)474
500 y(rep:)h(StubLib.DataRep;)474 544 y(c:)g(StubLib.Conn;)474
587 y(res:)g(TEXT;)374 631 y(BEGIN)424 675 y(TRY)474
718 y(c)g(:=)g(StubLib.StartCall\(t,)e(StubVersion\);)474
762 y(TRY)524 805 y(StubLib.OutInt32\(c,)g(ORD\(P.Get\)\);)524
849 y(StubLib.OutRef\(c,)g(key\);)524 892 y(rep)i(:=)f
(StubLib.AwaitResult\(c\);)524 936 y(CASE)g(StubLib.InInt32\(c,)g
(rep\))g(OF)524 980 y(|)h(ORD\(R.OK\))f(=>)624 1023 y(res)g(:=)h
(StubLib.InRef\(c,)e(rep,)i(TYPECODE\(TEXT\)\);)624 1067
y(reuse)f(:=)h(TRUE;)524 1110 y(|)g(ORD\(R.Invalid\))e(=>)624
1154 y(reuse)h(:=)h(TRUE;)624 1198 y(RAISE)f(Invalid;)524
1241 y(ELSE)624 1285 y(StubLib.RaiseUnmarshalFailure\(\);)524
1328 y(END;)474 1372 y(FINALLY)524 1416 y(StubLib.EndCall\(c,)f
(reuse\);)474 1459 y(END;)424 1503 y(EXCEPT)424 1546
y(|)i(Rd.Failure\(ec\))f(=>)g(StubLib.RaiseCommFailure\(ec\);)424
1590 y(|)h(Wr.Failure\(ec\))f(=>)g(StubLib.RaiseCommFailure\(ec\);)424
1633 y(END;)424 1677 y(RETURN)h(res;)374 1727 y(END)g(SurrogateGet;)225
1806 y(Invoke)13 b Fn(is)g(the)g(server)h(stub)f(dispatcher)g(for)h
Fh(T)p Fn(.)g(It)g(is)f(called)g(when)h(the)f(network)g(object)g
(runtime)g(re-)225 1856 y(ceives)f(a)f(method)g(invocation)f(for)h(an)h
(object)f(of)g(type)g Fh(T)p Fn(.)325 1955 y Fh(PROCEDURE)24
b(Invoke\()424 1999 y(c:)h(StubLib.Conn;)f(obj:)g(NetObj.T;)g(rep:)h
(StubLib.DataRep;)424 2042 y(<*UNUSED*>)f(stubProt:)g
(StubLib.StubProtocol\))424 2086 y(RAISES)h({NetObj.Error,)e
(Rd.Failure,)h(Wr.Failure,)624 2130 y(Thread.Alerted})f(=)374
2173 y(VAR)i(t)g(:=)g(NARROW\(obj,)e(T\);)374 2217 y(BEGIN)424
2260 y(TRY)474 2304 y(CASE)i(StubLib.InInt32\(c,)e(rep\))h(OF)474
2347 y(|)h(ORD\(P.Get\))f(=>)h(GetStub\(c,)f(t,)g(rep\);)474
2391 y(ELSE)h(StubLib.RaiseUnmarshalFailure\(\);)1049
2516 y Fn(32)p eop
%%Page: 33 41
33 40 bop 324 141 a Fh(END;)274 185 y(EXCEPT)274 228
y(|)25 b(Invalid)f(=>)374 272 y(StubLib.StartResult\(c\);)374
315 y(StubLib.OutInt32\(c,)f(ORD\(R.Invalid\)\);)274
359 y(END;)224 409 y(END)i(Invoke;)75 487 y Fn(There)12
b(is)f(one)g(server)h(side)f(stub)g(procedure)h(for)f(each)h(method)f
(of)g Fh(T)p Fn(.)175 584 y Fh(PROCEDURE)24 b(GetStub)g(\(c:)h
(StubLib.Conn;)e(t:)i(T;)g(rep:)f(StubLib.DataRep\))274
628 y(RAISES)h({Invalid,)f(NetObj.Error,)f(Rd.Failure,)498
671 y(Wr.Failure,)h(Thread.Alerted})g(=)224 715 y(VAR)h(key,)g(res:)f
(TEXT;)224 758 y(BEGIN)274 802 y(key)h(:=)g(StubLib.InRef\(c,)e(rep,)i
(TYPECODE\(TEXT\)\);)274 846 y(res)g(:=)g(t.get\(key\);)274
889 y(StubLib.StartResult\(c\);)274 933 y(StubLib.OutInt32\(c,)e
(ORD\(R.OK\)\);)274 976 y(StubLib.OutRef\(c,)h(res\);)224
1026 y(END)h(GetStub;)75 1104 y Fn(All)9 b(stub)h(code)g(is)g
(registered)g(with)f(the)h(network)g(object)f(runtime)g(by)h(the)g
(main)g(body)f(of)h(the)g(stub)f(mod-)75 1154 y(ule.)15
b(The)d(protocol)e(number)h(is)g(set)g(to)g(the)h(stub)e(protocol)h
(constant)f(de\256ned)i(above.)175 1251 y Fh(BEGIN)224
1295 y(StubLib.Register\()274 1338 y(TYPECODE\(T\),)24
b(StubVersion,)g(TYPECODE\(StubT\),)f(Invoke\);)175 1388
y(END)h(Example.)75 1545 y Fk(4.3)50 b(StubConn)10 b(interface)75
1628 y Fn(A)k Fh(StubLib.Conn)f Fn(represents)h(a)g(bidirectional)f
(connection)h(used)f(to)h(invoke)f(remote)h(methods)f(by)75
1678 y(the)e(network)f(objects)g(runtime.)15 b(Here)c(we)g(reveal)h
(that)e(a)h(connection)f Fh(c)h Fn(consists)e(of)i(a)g(message)g
(reader)75 1728 y Fh(c.rd)g Fn(and)g(a)h(message)f(writer)h
Fh(c.wr)p Fn(.)117 1778 y(Connections)e(come)h(in)g(matching)g(pairs;)f
(the)i(two)e(elements)h(of)h(the)f(pair)g(are)h(typically)e(in)h(dif)o
(ferent)75 1828 y(address)h(spaces.)k(If)c Fh(c1)f Fn(and)h
Fh(c2)f Fn(are)i(paired,)f(the)f(tar)o(get)h(of)g Fh(c1.wr)f
Fn(is)g(equal)h(to)f(the)g(source)h(of)g Fh(c2.rd)p Fn(,)75
1878 y(and)f(vice)f(versa.)16 b(Thus)10 b(the)h(messages)f(written)g
(to)g Fh(c1.wr)g Fn(can)h(be)g(read)g(from)g Fh(c2.rd)p
Fn(,)g(and)f(vice)h(versa.)175 1975 y Fh(INTERFACE)24
b(StubConn;)175 2046 y(IMPORT)g(MsgRd,)g(MsgWr,)h(StubLib;)175
2116 y(REVEAL)f(StubLib.Conn)g(<:)g(Public;)175 2187
y(TYPE)g(Public)h(=)f(OBJECT)h(rd:)f(MsgRd.T;)g(wr:)h(MsgWr.T)f(END;)
175 2264 y(END)g(StubConn.)117 2341 y Fn(The)8 b(types)g
Fh(MsgWr.T)f Fn(and)h Fh(MsgRd.T)g Fn(are)h(subtypes)e(of)i(the)f
(standard)g(Modula-3)f(stream)h(types)g Fh(Wr.T)75 2391
y Fn(and)j Fh(Rd.T)p Fn(;)g(they)g(are)h(described)f(in)g(detail)f(in)h
(the)g(next)g(subsection.)j(Since)e(they)f(are)h(subtypes,)e(any)i(of)
899 2516 y(33)p eop
%%Page: 34 42
34 41 bop 225 141 a Fn(the)12 b(standard)g(stream)g(operations)g(can)g
(be)h(used)e(on)h(them.)18 b(For)13 b(example,)f(in)g(a)g(hand-coded)h
(stub)e(you)225 191 y(could)g(replace)h(the)f(pair)350
267 y Fh(StubLib.OutByte\(c,)23 b(byte\))350 316 y(b)h(:=)h
(StubLib.InByte\(c\))225 392 y Fn(with)11 b(the)g(pair)350
468 y Fh(Wr.PutChar\(c.wr,)23 b(VAL\(byte,)h(CHAR\)\))350
518 y(b)g(:=)h(ORD\(Rd.GetChar\(c.rd\)\).)267 594 y Fn(The)9
b(gain)h(in)f(speed)h(from)g(this)f(change)h(will)f(be)h(very)g
(modest.)k(T)m(o)c(make)f(optimization)f(worthwhile,)225
644 y(you)j(will)f(want)h(to)g(make)h(direct)f(access)h(to)f(the)g(buf)
o(fers)h(in)f(the)g(reader)i(and)e(writer)m(.)16 b(T)m(o)11
b(do)g(this,)g(import)225 693 y(the)g Fh(RdClass)f Fn(and)h
Fh(WrClass)f Fn(interfaces[18].)16 b(Importing)9 b(these)i(interfaces)g
(will)f(allow)g(you)g(to)h(write)225 743 y(stubs)f(that)h(operate)h
(directly)f(on)g(the)g(reader)i(and)e(writer)g(buf)o(fers.)267
794 y(If)h(you)g(use)g(this)f(optimization,)f(you)i(will)f(have)h(to)g
(be)g(careful)h(about)e(locks.)17 b(All)12 b(readers)h(and)f(writ-)225
843 y(ers)h(contain)g(an)g(internal)g(lock)g(used)f(to)h(serialize)g
(operations.)20 b(It)13 b(is)g(a)g(requirement)g(of)g(the)g
Fh(StubLib)225 893 y Fn(interface)h(that)e(all)g(parameters)h(of)g
(type)g Fh(Conn)f Fn(be)h(passed)g(with)f(both)g(streams)g(unlocked.)19
b(It)13 b(is)f(a)h(fur)o(-)225 943 y(ther)c(requirement)g(that)g(no)g
(client)g(thread)g(operate)h(on)f(the)g(streams)g(while)g(an)g
(activation)f(of)i(a)f Fh(StubLib)225 993 y Fn(procedure)j(is)f(in)g
(progress.)225 1120 y Fk(4.4)50 b(Message)13 b(r)o(eaders)g(and)f
(writers)225 1201 y Fn(The)i(byte)g(streams)f(of)i(the)f(readers)h(and)
f(writers)g(in)f(a)i Fh(StubLib.Conn)e Fn(are)h(divided)g(into)f
(segments)225 1251 y(called)g Fi(messages)p Fn(.)19 b(Messages)13
b(are)h(convenient)e(for)h(delineating)f(call)h(and)f(return)h
(packets,)h(and)f(seem)225 1301 y(essential)e(for)g(sending)g(both)f
(data)i(and)f(control)g(information)f(for)i(surrogate)f(streams.)267
1351 y(W)l(e)h(de\256ne)h(the)f(types)g Fh(MsgRd.T)g
Fn(and)g Fh(MsgWr.T)f Fn(to)h(present)g(the)g(abstraction)g(of)g(a)h
(stream)f(of)g(mes-)225 1401 y(sages.)j(A)c(message)f(is)f(a)i
(sequence)g(of)f(bytes)g(terminated)g(by)g(an)g(end-of-message)h
(marker)m(.)16 b(The)10 b(initial)225 1451 y(position)g(is)g(at)i(the)f
(start)g(of)h(the)f(\256rst)g(message.)16 b(Messages)10
b(can)i(be)g(of)f(zero)h(length.)267 1501 y(If)j(the)g(end-of-message)g
(marker)g(is)g(encountered)g(while)g(reading)g(from)g(a)g
Fh(MsgRd.T)p Fn(,)g(it)f(is)h(repre-)225 1551 y(sented)g(by)f
Fh(EndOfFile)g Fn(on)h(the)f(reader)m(.)28 b(The)15 b
Fh(nextMsg)f Fn(method)g(can)h(be)g(used)g(to)f(advance)h(to)g(the)225
1601 y(next)d(message)g(in)f(the)h(stream.)18 b(This)11
b(method)g(waits)h(for)g(the)g(next)g(message)g(and)g(returns)g
Fh(TRUE)g Fn(when)225 1651 y(it)e(becomes)g(available.)15
b(A)10 b(return)h(value)f(of)g Fh(FALSE)g Fn(indicates)g(that)g(there)h
(are)g(\(and)f(will)g(be\))g(no)g(further)225 1700 y(messages.)15
b(The)10 b(reader)r(')m(s)h(current)f(position)f(is)g(set)h(to)f(zero)i
(on)f(return)g(from)g Fh(nextMsg)p Fn(,)g(and)g(the)g(reader)225
1750 y(no)h(longer)g(reports)g Fh(EndOfFile)g Fn(\(unless)g(of)g
(course)h(the)f(next)g(message)g(is)g(zero)h(length\).)267
1800 y(If)i Fh(nextMsg)g Fn(is)g(invoked)f(when)h(the)g(reader)i(is)d
(not)h(at)g Fh(EndOfFile)p Fn(,)h(the)f(remaining)f(bytes)h(in)g(the)
225 1850 y(current)e(message)f(are)h(skipped.)267 1901
y(As)f(for)g(all)g(readers,)i(calling)e Fh(Rd.Close)f
Fn(on)h(a)h Fh(MsgRd.T)f Fn(releases)h(all)f(associated)g(resources.)
267 1951 y(Here)h(is)f(a)g(listing)f(of)h(the)g(interface:)325
2046 y Fh(INTERFACE)24 b(MsgRd;)325 2115 y(IMPORT)g(Thread,)g(Rd;)325
2185 y(TYPE)374 2228 y(T)h(=)g(Rd.T)g(OBJECT)f(METHODS)424
2272 y(nextMsg\(\):)g(BOOLEAN)g(RAISES)h({Rd.Failure,)f
(Thread.Alerted};)374 2315 y(END;)325 2391 y(END)g(MsgRd.)1049
2516 y Fn(34)p eop
%%Page: 35 43
35 42 bop 117 141 a Fn(As)14 b(with)g(a)h Fh(MsgRd.T)p
Fn(,)g(the)g Fh(nextMsg)f Fn(method)g(of)g(a)i Fh(MsgWr.T)e
Fn(can)h(be)g(used)g(to)f(end)h(the)f(current)75 191
y(message)d(and)f(position)f(the)i(writer)g(at)f(the)h(start)g(of)f
(the)h(next)f(message.)16 b(The)10 b(writer)r(')m(s)h(current)g
(position)75 241 y(is)g(reset)g(to)g(zero)h(on)g(return)f(from)g
Fh(nextMsg)p Fn(.)117 291 y(Invoking)g Fh(Wr.Flush)i
Fn(on)f(a)h Fh(MsgWr.T)g Fn(\257ushes)f(the)h(current)g(buf)o(fer)h(to)
e(the)h(abstract)g(writer)g(tar)o(get,)75 341 y(but)e(does)g(not)g(end)
g(the)g(current)h(message.)117 391 y(As)c(for)g(all)g(writers,)h
(calling)f Fh(Wr.Close)f Fn(on)h(a)h Fh(MsgWr.T)e Fn(releases)i(all)f
(associated)g(resources.)15 b Fh(Close)75 441 y Fn(also)9
b(\257ushes)g(and)g(terminates)f(the)h(current)g(message.)15
b(This)8 b(means)h(that)f(a)i(zero-length)f(message)g(is)f(sent)75
490 y(at)k(close)g(time)f(if)h(no)f(data)h(has)g(been)g(written)f(into)
g(the)h(current)g(message)g(\(for)g(example,)h(directly)e(after)75
540 y Fh(nextMsg)g Fn(or)g(writer)h(initialization\).)117
590 y(Here)g(is)f(a)g(listing)f(of)h(the)g(interface:)175
685 y Fh(INTERFACE)24 b(MsgWr;)175 754 y(IMPORT)g(Thread,)g(Wr;)175
823 y(TYPE)224 866 y(T)h(=)g(Wr.T)g(OBJECT)f(METHODS)274
910 y(nextMsg\(\))g(RAISES)h({Wr.Failure,)e(Thread.Alerted};)224
954 y(END;)175 1029 y(END)h(MsgWr.)117 1104 y Fn(There)16
b(are)g(two)f(\256nal)h(clauses)f(in)g(the)h(speci\256cation)f(of)h
(message)f(readers)i(and)e(message)g(writers.)75 1154
y(First,)h(their)g(buf)o(fers)f(must)g(be)g(word-aligned)g(in)g(memory)
m(.)26 b(More)15 b(precisely)m(,)i(if)e(byte)g Fh(i)h
Fn(in)e(the)i(data)75 1204 y(stream)e(is)f(stored)g(in)g(the)h(buf)o
(fer)h(at)e(memory)g(address)h Fh(j)p Fn(,)h(then)e Fh(i)h
Fn(and)g Fh(j)f Fn(must)g(be)h(equal)g(modulo)e(the)75
1254 y(machine)i(word)g(size.)23 b(This)13 b(requirement)h(allows)f
(optimized)g(stubs)f(to)i(read)h(and)f(write)f(scalar)i(word)75
1304 y(values)9 b(from)g(the)g(buf)o(fer)h(ef)o(\256ciently)m(.)15
b(Second,)10 b(their)f(buf)o(fers)h(must)e(not)h(be)g(too)f(small.)14
b(More)9 b(precisely)m(,)75 1353 y(when)i(the)f Fh(nextMsg)g
Fn(method)g(of)h(a)g(writer)g(returns,)g(there)g(must)f(be)h(at)f
(least)h(24)f(bytes)g(of)h(free)h(space)f(in)75 1403
y(the)f(writer)h(buf)o(fer)n(,)h(and)f(when)f(the)h Fh(nextMsg)e
Fn(method)h(of)h(a)g(reader)g(returns,)g(there)g(must)e(be)i(at)g
(least)f(24)75 1453 y(bytes)h(of)g(message)h(data)f(in)g(the)g(reader)i
(buf)o(fer)m(.)k(This)11 b(requirement)g(allows)f(the)i(runtime)e(to)h
(ef)o(\256ciently)75 1503 y(read)h(and)f(write)h(the)f(headers)h
(required)f(by)g(the)h(network)f(object)g(protocol.)75
1629 y Fk(4.5)50 b(T)l(ransport)12 b(interface)75 1710
y Fn(The)f Fh(Transport)f Fn(interface)h(separates)g(the)g(main)f(part)
h(of)g(the)g(network)f(object)g(runtime)g(system)g(from)75
1760 y(the)g(parts)f(that)h(deal)f(with)h(low-level)f(communication.)k
(It)d(is)f(the)h(interface)g(that)g(must)e(be)i(implemented)75
1810 y(to)e(extend)g(the)g(system)f(to)h(use)h(new)f(communication)f
(protocols.)13 b(The)c(interface)g(is)e(reasonably)i(narrow:)175
1904 y Fh(INTERFACE)24 b(Transport;)175 1973 y(IMPORT)g(NetObj,)g
(NetObjNotifier,)g(StubLib,)g(StubConn,)g(Thread;)175
2042 y(TYPE)224 2086 y(T)h(<:)g(Public;)224 2130 y(Endpoint)g(=)f
(TEXT;)224 2173 y(Public)h(=)g(OBJECT)f(METHODS)274 2217
y(fromEndpoint\(e:)g(Endpoint\):)g(Location;)274 2260
y(toEndpoint\(\):)g(Endpoint;)274 2304 y(serviceCall\(t:)g
(StubLib.Conn\):)f(\(*reUse*\))i(BOOLEAN)324 2347 y(RAISES)f
({Thread.Alerted};)224 2391 y(END;)899 2516 y Fn(35)p
eop
%%Page: 36 44
36 43 bop 374 141 a Fh(Location)25 b(<:)f(LocationP;)374
185 y(LocationP)h(=)f(OBJECT)h(METHODS)424 228 y(new\(\):)g
(StubLib.Conn)e(RAISES)i({NetObj.Error,)e(Thread.Alerted};)424
272 y(free\(c:)i(StubLib.Conn;)e(reUse:)i(BOOLEAN\);)424
315 y(dead\(st:)f(NetObjNotifier.OwnerState\);)374 359
y(END;)374 429 y(Conn)h(=)g(StubConn.Public)e(BRANDED)i(OBJECT)424
472 y(loc:)g(Location)374 516 y(END;)325 585 y(REVEAL)374
629 y(NetObj.Address)f(=)h(BRANDED)f(REF)h(ARRAY)f(OF)h(Endpoint;)374
672 y(StubLib.Conn)f(<:)h(Conn;)325 748 y(END)f(Transport.)225
824 y Fn(The)11 b(main)g(ideas)g(in)g(the)h(interface)g(were)g
(described)f(earlier)m(.)17 b(T)m(o)11 b(summarize)g(these)g
(brie\257y:)285 918 y Fl(\017)21 b Fn(A)13 b Fh(Transport.T)f
Fn(is)h(an)h(object)f(that)g(manages)g(connections)f(of)i(some)f
(particular)g(class)g(\()p Fi(e.g.)p Fn(,)329 968 y(TCP\).)285
1053 y Fl(\017)21 b Fn(A)10 b Fh(Transport.Location)e
Fn(is)i(an)g(object)g(that)g(creates)h(connections)e(of)h(some)g
(particular)g(class)329 1102 y(to)h(some)g(particular)g(address)g
(space.)285 1187 y Fl(\017)21 b Fn(A)11 b Fh(Transport.Endpoint)e
Fn(is)h(a)h(transport-speci\256c)g(name)g(for)g(an)g(address)g(space)g
(\()p Fi(e.g.)p Fn(,)i(an)e(IP)329 1237 y(address)g(plus)g(a)g(port)g
(number)g(plus)g(a)g(non-reusable)h(process)f(ID\).)285
1322 y Fl(\017)21 b Fn(The)11 b Fh(fromEndpoint)f Fn(method)g(of)i(a)f
(transport)g(converts)f(an)i(endpoint)e(into)g(a)i(location,)e(or)i
(into)329 1372 y Fh(NIL)f Fn(if)g(the)g(endpoint)g(and)g(transport)g
(are)h(of)f(dif)o(ferent)h(classes.)225 1465 y(Here)g(are)g
(speci\256cations)f(for)h(the)f(methods)f(of)i(a)f Fh(Transport.T)p
Fn(:)285 1559 y Fl(\017)21 b Fn(The)10 b Fh(toEndpoint)e
Fn(method)h(returns)h(an)g(endpoint)e(for)i(the)g(address)f(space)i
(itself.)j(The)c(resulting)329 1609 y(endpoint)f(should)g(be)h
(recognized)g(by)g(the)g Fh(fromEndpoint)f Fn(method)g(of)h(transports)
g(of)g(the)g(same)329 1658 y(class)f(anywhere)h(in)f(the)g(network.)15
b(That)9 b(is,)h(if)g(program)f(instance)g Fh(P)g Fn(calls)h
Fh(tr.toEndpoint\(\))p Fn(,)329 1708 y(producing)e(an)i(endpoint)e
Fh(ep)p Fn(,)i(then)e(the)h(call)h Fh(tr1.fromEndpoint\(ep\))d
Fn(executed)j(in)e(any)i(pro-)329 1758 y(gram)h(instance)g(either)g
(returns)g Fh(NIL)g Fn(\(if)g Fh(tr)g Fn(and)g Fh(tr1)g
Fn(are)h(of)f(dif)o(ferent)h(classes\))f(or)g(returns)g(a)h(lo-)329
1808 y(cation)f(that)g(generates)h(connections)e(to)h
Fh(P)p Fn(.)285 1893 y Fl(\017)21 b Fn(T)n(ransports)12
b(are)i(required)f(to)g(provide)f(the)h(threads)g(that)f(listen)g(to)h
(the)f(server)i(sides)e(of)h(connec-)329 1943 y(tions.)18
b(When)13 b(a)g(message)g(arrives)g(on)f(the)h(connection)f(indicating)
g(the)g(beginning)g(of)h(a)g(remote)329 1993 y(call,)c(the)f(threads)h
(are)g(required)f(to)g(call)h(the)f Fh(serviceCall)f
Fn(method)g(of)i(their)f(transport.)14 b(The)8 b(de-)329
2042 y(fault)i(value)g(of)g(this)f(method)h(locates)g(and)g(calls)g
(the)g(dispatcher)g(procedure.)16 b(Ordinarily)9 b(a)i(trans-)329
2092 y(port)e(implementation)f(will)g(not)h(need)h(to)g(override)g(the)
f Fh(serviceCall)g Fn(method.)14 b(If)c Fh(conn)g Fn(is)f(the)329
2142 y(ar)o(gument)k(to)f Fh(serviceCall)p Fn(,)h(then)g(at)g(entry)g
Fh(conn.rd)g Fn(is)f(positioned)g(at)h(the)g(start)g(of)g(the)g(in-)329
2192 y(coming)7 b(message.)15 b(The)8 b Fh(serviceCall)f
Fn(method)h(processes)g(the)h(incoming)e(remote)h(invocation)329
2242 y(and)h(sends)f(the)h(result)f(on)h Fh(conn.wr)p
Fn(.)14 b(If)9 b(it)f(returns)h Fh(TRUE)p Fn(,)g(then)g(the)f(remote)h
(invocation)f(was)h(pro-)329 2291 y(cessed)k(without)e(error)i(and)g
(the)g(transport)f(can)h(cache)g(the)g(connection.)19
b(If)13 b(it)f(returns)h Fh(FALSE)p Fn(,)f(a)329 2341
y(protocol)d(error)i(occurred)f(during)g(the)f(call,)i(and)f(the)g
(transport)f(implementation)e(should)i(destroy)329 2391
y(the)i(connection.)1049 2516 y(36)p eop
%%Page: 37 45
37 44 bop 75 141 a Fn(And)11 b(here)h(are)g(the)f(speci\256cations)g
(for)h(the)f(methods)f(of)i(a)g Fh(Transport.Location)p
Fn(:)135 268 y Fl(\017)21 b Fn(The)13 b Fh(new)f Fn(method)g(of)h(a)g
(location)e(returns)i(a)g(connection)f(to)g(the)h(address)g(space)g
(for)g(which)f(it)g(is)179 317 y(a)g(location.)18 b(The)12
b(call)g Fh(loc.new\(\))f Fn(returns)i(a)f(connection)g(whose)g(server)
g(side)g(is)g(that)g(address)179 367 y(space)i(and)h(whose)f(client)f
(side)h(is)g(the)g(program)g(instance)g(making)f(the)h(call.)24
b(The)14 b(caller)h(must)179 417 y(pass)c(the)g(resulting)f(connection)
h(to)g Fh(loc.free)g Fn(when)g(it)g(is)g(\256nished)g(with)f(it.)135
535 y Fl(\017)21 b Fn(The)12 b(call)g Fh(loc.free\(c,)24
b(reUse\))12 b Fn(frees)h(the)f(connection)f Fh(c)p Fn(,)i(which)f
(must)f(have)h(been)h(gener)o(-)179 585 y(ated)d(by)g
Fh(loc.new\(\))p Fn(.)k(If)c Fh(reUse)g Fn(is)f Fh(TRUE)p
Fn(,)h(the)g(client)g(asserts)f(that)h(the)g(connection)f(is)h(in)f(a)h
(suit-)179 635 y(able)j(state)f(for)i(executing)e(another)h(remote)g
(method)f(call.)20 b(In)13 b(particular)n(,)h Fh(c.wr)e
Fn(must)g(be)h(posi-)179 684 y(tioned)d(at)i(the)f(beginning)f(of)h(a)h
(message.)135 803 y Fl(\017)21 b Fn(A)11 b(transport)g(is)f
(responsible)h(for)g(monitoring)e(the)i(liveness)g(of)g(program)g
(instances)g(for)g(which)g(it)179 852 y(has)h(locations)f(or)i
(connections.)k(The)12 b(method)g(of)g(monitoring)e(depends)i(on)g(the)
h(transport.)k(For)179 902 y(example,)11 b(the)g(transport)g(might)f
(periodically)h(ping)f(the)h(other)h(program)f(instances.)k(A)c
(program)179 952 y(is)c(considered)h(dead)g(if)g(it)f(exits,)h
(crashes,)h(or)f(if)g(the)g(underlying)e(communication)g(network)i
(cannot)179 1002 y(reach)j(it)e(for)h(an)g(appreciable)h(amount)e(of)h
(time.)k(Suppose)c(that)f Fh(loc)h Fn(is)f(a)i(location)e(that)g
(generates)179 1052 y(connections)k(to)i(some)f(program)g(instance)g
Fh(P)p Fn(.)h(If)g Fh(P)f Fn(dies,)i(the)e(transport)g(that)g(provided)
g Fh(loc)g Fn(is)179 1101 y(responsible)f(for)h(calling)f(the)h(method)
f Fh(loc.dead\(st\))p Fn(.)22 b(\(The)14 b(network)g(object)f(runtime)g
(im-)179 1151 y(plements)e(this)g(method;)g(the)h(transport)g(should)f
(not)g(override)i(it.\))k(The)12 b(ar)o(gument)g Fh(st)g
Fn(indicates)179 1201 y(whether)c(the)f(transport)g(has)h(detected)g(a)
g(permanent)f(failure,)i(or)f(one)g(that)f(is)g(potentially)f
(transient.)179 1251 y(In)i(addition)f(to)h(calling)g
Fh(loc.dead)p Fn(,)h(the)f(transport)g(is)g(responsible)f(for)i
(alerting)f(all)g(threads)g(it)g(has)179 1301 y(spawned)j(to)g(handle)g
(method)f(invocations)g(on)h(behalf)h(of)f Fh(P)p Fn(.)75
1427 y(A)j(transport)f(is)h(expected)g(to)g(manage)g(the)g(connections)
f(it)h(creates.)24 b(If)14 b(creating)h(connections)e(is)g(ex-)75
1477 y(pensive,)k(then)e(the)h(transport')m(s)f(locations)g(should)f
(cache)j(them.)28 b(If)16 b(maintaining)e(idle)i(connections)75
1527 y(is)g(expensive,)h(then)f(the)f(transport')m(s)h(locations)f
(should)g(free)i(them.)29 b(Often)16 b(connections)f(are)i(time-)75
1576 y(consuming)11 b(to)h(create,)i(but)e(then)g(tie)h(up)f(scarce)h
(kernel)g(resources)g(when)f(idle.)19 b(Therefore)14
b(transports)75 1626 y(typically)c(cache)j(idle)d(connections)h(for)h
(a)f(limited)f(amount)h(of)g(time.)117 1685 y(The)i Fh(Transport)g
Fn(interface)i(reveals)f(the)f(representation)h(of)f
Fh(NetObj.Address)p Fn(:)19 b(an)14 b(address)f(is)75
1735 y(simply)f(an)j(array)f(of)h(endpoints)d(for)j(the)e(program)h
(instance)g(designated)f(by)h(the)g(address.)23 b(The)15
b(end-)75 1785 y(points)9 b(are)j(generally)f(of)f(dif)o(ferent)i
(transport)e(classes;)g(they)h(provide)f(alternative)g(ways)h(of)g
(communi-)75 1834 y(cating)e(with)g(the)h(program)g(instance.)k(The)c
(modules)f(of)h(the)f(network)h(object)f(runtime)g(that)h(require)g
(this)75 1884 y(revelation)i(are)h(exactly)g(the)f(modules)f(that)h
(import)g(the)g(transport)g(interface,)i(so)e(this)f(is)h(a)h
(convenient)75 1934 y(place)f(to)f(put)f(it.)117 1993
y(The)f Fh(Transport)f Fn(interface)j(also)d(reveals)i(more)f
(information)f(about)h(the)g(type)g Fh(StubLib.Conn)p
Fn(.)14 b(If)75 2042 y Fh(t)d Fn(is)f(a)h Fh(StubLib.Conn)p
Fn(,)f(then)g Fh(t.loc)g Fn(is)g(a)h Fh(Location)f Fn(that)g(generates)
h(connections)f(to)g(the)h(program)75 2092 y(instance)g(at)g(the)g
(other)g(end)g(of)h Fh(t)p Fn(.)j(The)c(connections)g(generated)g(by)g
Fh(t.loc)g Fn(connect)g(the)g(same)g(pair)h(of)75 2142
y(program)c(instances)g(that)g Fh(t)g Fn(connects,)h(but)f(if)g
Fh(t)h Fn(is)f(a)g(handle)g(on)g(the)h(server)g(side)f(of)g(the)g
(connection,)h(then)75 2192 y(the)k(connections)f(generated)i(by)f
Fh(t.loc)f Fn(will)g(reverse)i(the)f(direction)g(of)g
Fh(t)p Fn(:)18 b(their)13 b(client)g(side)f(will)h(be)75
2242 y Fh(t)p Fn(')m(s)c(server)h(side,)g(and)f(vice)g(versa)h
(\(so-called)f(back)g(connections\).)14 b(On)9 b(the)g(other)g(hand,)h
(if)f Fh(t)g Fn(is)g(a)g(handle)75 2291 y(on)k(the)f(client)g(side)h
(of)g(the)f(connection,)h(then)g(the)f(connections)g(generated)i(by)e
Fh(t.loc)h Fn(will)f(be)g(in)h(the)75 2341 y(same)g(direction)f(as)h
Fh(t)p Fn(.)21 b(A)13 b(transport)f(must)g(ensure)h(that)g(the)f
Fh(loc)h Fn(\256eld)g(is)g(de\256ned)g(in)g(all)g(connections)75
2391 y(returned)f(by)f(any)g(of)g(its)g(locations.)899
2516 y(37)p eop
%%Page: 38 46
38 45 bop 225 141 a Fj(5)58 b(Performance)225 245 y Fn(Our)11
b(system)f(was)h(designed)f(and)h(implemented)e(in)i(a)g(year)g(by)g
(the)g(four)g(authors.)k(The)10 b(network)h(object)225
295 y(runtime)g(is)h(4000)f(lines,)h(the)f(stub)h(generator)g(3000)f
(lines,)h(the)g(TCP)h(transport)e(1500)g(lines,)h(the)g(pickle)225
345 y(package)g(750)f(lines,)g(and)g(the)h(network)f(object)g(agent)g
(100)g(lines.)k(All)10 b(the)i(code)f(is)g(in)g(Modula-3.)267
398 y(W)l(e)f(haven')o(t)f(attempted)f(extensive)h(performance)h
(optimization,)e(but)h(we)h(have)f(measured)h(the)f(times)225
448 y(for)k(some)f(basic)h(operations.)19 b(The)13 b(numbers)f(given)g
(in)h(T)m(able)f(1)h(were)h(taken)e(using)g(Digital)g(worksta-)225
498 y(tions)e(equipped)h(with)g(DECchip)h(21064)e(processors)i(\(at)f
(175)g(MHz\))h(running)f(OSF/1)g(and)h(communi-)225 548
y(cating)f(over)h(a)g(100)g(megabit/sec)f(AN1)g(network[22].)17
b(The)11 b(numbers)h(include)f(the)g(cost)h(of)g(Modula-3)225
597 y(runtime)e(checks.)676 769 y(T)m(able)i(1:)i(Sample)e(remote)f
(invocation)f(timings)p 587 786 970 4 v 587 821 a Fi(Call)h(parameters)
352 b(Elapsed)11 b(time/call)p 587 838 970 2 v 587 873
a Fn(Null)g(call)649 b(960)11 b(usec)587 923 y(T)m(en)g(integer)h(ar)o
(guments)378 b(1010)10 b(usec)587 972 y Fh(REF)h(CHAR)g
Fn(ar)o(gument)417 b(1280)10 b(usec)587 1022 y(Linked)h(list)f(ar)o
(gument)406 b(5200)10 b(usec)587 1072 y(Network)h(object)g(ar)o(gument)
g Fe(\()p Fd(s)p Fe(\))252 b Fn(1030)10 b(usec)587 1122
y(Network)h(object)g(ar)o(gument)g Fe(\()p Fd(c)p Fe(\))253
b Fn(1050)10 b(usec)587 1172 y(Network)h(object)g(ar)o(gument)g
Fe(\()p Fd(c;)d(d)p Fe(\))208 b Fn(2560)10 b(usec)587
1221 y(Network)h(object)g(result)g Fe(\()p Fd(s)p Fe(\))323
b Fn(1)n(180)11 b(usec)587 1271 y(Network)g(object)g(result)g
Fe(\()p Fd(c)p Fe(\))324 b Fn(1)n(190)11 b(usec)587 1321
y(Network)g(object)g(result)g Fe(\()p Fd(c;)d(d)p Fe(\))278
b Fn(2680)10 b(usec)p 587 1339 970 4 v 587 1374 a Fc(\()p
Fb(c)p Fc(\))e Fa(concrete)f(object)g(marshaled)587 1424
y Fc(\()p Fb(s)p Fc(\))h Fa(surrogate)f(object)h(marshaled)587
1474 y Fc(\()p Fb(d)p Fc(\))g Fa(dirty)g(call)g(required)267
1637 y Fn(On)i(our)h(test)f(con\256guration,)h(it)g(takes)f(660)h
(microseconds)f(for)h(a)g(C)g(program)g(to)g(echo)g(a)g(TCP)g(packet)
225 1686 y(from)i(user)g(space)g(to)g(user)g(space.)20
b(A)13 b(null)f(network)h(object)f(method)g(invocation)g(takes)h(an)g
(additional)225 1736 y(300)h(microseconds.)24 b(The)14
b(dif)o(ference)i(is)e(primarily)f(due)i(to)f(the)g(cost)g(of)g(two)g
(Modula-3)g(user)g(space)225 1786 y(context)7 b(switches)g(\(64)h
(microseconds\),)g(the)g(cost)f(of)h(marshaling)f(and)h(unmarshaling)e
(the)i(object)f(whose)225 1836 y(null)k(method)g(is)g(being)g(invoked,)
g(and)h(the)g(cost)f(of)h(the)f(wire)h(protocol)f(used)h(to)f(frame)h
(invocation)f(and)225 1886 y(result)g(packets.)267 1939
y(The)d(ten)g(integer)g(ar)o(gument)g(test)g(shows)f(that)h(the)g
(incremental)g(cost)g(of)g(an)g(integer)h(ar)o(gument)e(is)h(about)225
1989 y(5)i(microseconds.)k(The)d Fh(REF)f(CHAR)g Fn(test)f(measures)h
(the)h(cost)e(of)i(marshaling)e(a)h(small)g(data)g(structure)g(by)225
2039 y(pickling.)19 b(This)12 b(minimal)f(use)i(of)g(the)g(pickle)g
(machinery)f(adds)h(an)g(additional)f(220)g(microseconds)g(to)225
2089 y(the)f(null)f(call.)16 b(The)11 b(linked)g(list)f(test)h
(measures)g(the)g(cost)g(of)g(marshaling)f(a)i(complex)e(data)i
(structure,)f(in)225 2138 y(this)f(case)h(a)h(doubly-linked)d(list)g
(with)i(25)f(elements.)15 b(The)c(additional)e(cost)i(per)g(element)g
(is)f(roughly)g(80)225 2188 y(microseconds.)267 2242
y(The)h(next)h(six)f(tests)g(show)g(the)h(total)f(cost)g(of)h(various)f
(calls)h(involving)e(a)i(single)f(network)g(object)h(ar)o(-)225
2291 y(gument)c(or)i(result)f(\(in)g(addition)f(to)h(the)h(object)f
(whose)g(method)g(is)g(being)f(invoked\).)15 b(An)9 b(\252\(s\)\272)h
(indicates)225 2341 y(that)h(the)h(ar)o(gument)f(or)h(result)f(is)h
(marshaled)f(as)h(a)g(surrogate)g(and)f(unmarshaled)g(as)h(a)g
(concrete)h(object.)225 2391 y(A)c(\252\(c\)\272)g(indicates)f(that)h
(the)f(ar)o(gument)g(or)h(result)f(is)g(marshaled)h(as)f(a)h(concrete)g
(object)g(and)f(unmarshaled)1049 2516 y(38)p eop
%%Page: 39 47
39 46 bop 75 141 a Fn(as)11 b(a)h(surrogate.)k(A)11 b(\252\(d\)\272)h
(indicates)f(that)g(a)h(dirty)e(call)i(is)e(required.)117
191 y(The)j(incremental)g(cost)g(of)h(a)f(surrogate)h(network)f(object)
g(ar)o(gument)g(that)g(does)g(not)g(lead)h(to)f(a)g(dirty)75
241 y(call)f(is)f(roughly)g(70)h(microseconds.)k(A)11
b(concrete)i(network)e(object)h(ar)o(gument)f(is)h(somewhat)f(more)g
(ex-)75 291 y(pensive.)k(If)d(a)g(dirty)e(call)i(is)f(required,)g
(there)h(is)f(an)h(additional)e(cost)h(of)g(about)g(1500)g
(microseconds.)117 341 y(Network)i(object)h(results)f(are)i(more)f
(expensive)g(than)f(ar)o(guments,)i(because)g(of)f(the)g(acknowledge-)
75 391 y(ment)c(that)g(must)f(be)i(sent)f(when)g(the)h(result)f
(message)g(contains)g(a)g(network)g(object.)15 b(In)c(the)f(tests)g
(that)g(do)75 441 y(not)f(involve)h(dirty)f(calls,)i(this)e(cost)g
(shows)h(up)f(as)i(a)f(dif)o(ference)h(of)g(approximately)e(150)g
(microseconds,)75 491 y(but)i(in)g(the)g(tests)g(that)f(do)i(involve)e
(dirty)h(calls)g(the)g(cost)g(seems)g(to)g(be)g(lost)g(in)g(the)g
(noise.)117 541 y(W)l(e)h(also)g(measured)f(the)h(performance)h(of)f
(marshaled)f(readers)i(and)f(writers.)k(Since)d(there)f(is)f(only)g(a)
75 591 y(minimal)e(layer)i(of)g(protocol)g(between)g(marshaled)f(data)h
(streams)g(and)g(the)f(underlying)g(network)h(trans-)75
640 y(port,)g(there)g(is)g(little)f(dif)o(ference)i(in)f(bandwidth.)j
(In)d(the)g(test)f(con\256guration)h(described)g(above,)g(our)g(im-)75
690 y(plementation)e(delivers)i(over)g(95)g(percent)g(of)g(the)g(full)f
(network)h(bandwidth)e(\(100)i(MBits/sec\).)k(W)l(e)c(at-)75
740 y(tribute)c(our)h(failure)g(to)f(achieve)i(full)e(network)h
(bandwidth)e(to)i(the)f(cost)h(of)g(user)o(-space)h(thread)f
(emulation,)75 790 y(Unix)j(non-blocking)f(I/O,)h(and)h(TCP)g(protocol)
e(overhead.)117 840 y(The)e(purpose)g(of)g(our)h(project)f(was)g(to)g
(\256nd)h(an)f(attractive)h(design,)g(not)e(to)h(optimize)g
(performance,)i(and)75 890 y(our)j(numbers)f(re\257ect)i(this.)20
b(Nevertheless,)14 b(the)e(performance)i(of)f(our)g(system)f(is)h
(adequate)g(for)g(many)75 940 y(purposes.)h(It)9 b(is)g(competitive)f
(with)g(the)h(performance)h(of)f(commercially)f(available)h(RPC)i
(systems[20)n(],)75 989 y(and)j(we)h(believe)f(that)g(our)h(design)e
(does)i(not)e(preclude)i(the)f(sort)g(of)h(performance)g(optimizations)
d(re-)75 1039 y(ported)f(in)g(the)h(literature[23)o(,)g(27].)k
(Furthermore,)d(our)e(use)h(of)f(buf)o(fered)i(streams)e(for)h
(marshaling)e(per)o(-)75 1089 y(mits)e(careful)i(hand-tuning)d(of)i
(stubs)f(while)h(still)f(of)o(fering)h(the)g(\257exibility)e(of)i(a)h
(general)f(purpose)g(stream)75 1139 y(abstraction.)75
1287 y Fj(6)58 b(Experience)75 1385 y Fn(Our)8 b(network)f(objects)g
(system)g(has)g(been)h(working)f(for)h(almost)f(two)g(years.)15
b(Several)9 b(projects)e(have)h(built)75 1435 y(on)j(the)g(system,)g
(including)f(the)h(Siphon)g(distributed)f(software)h(repository[21)o
(],)h(the)f(Ar)o(go)h(teleconfer)o(-)75 1485 y(encing)h(system[9)o(],)i
(and)e(the)h(Obliq)e(distributed)g(scripting)h(language[6].)22
b(W)l(e)14 b(report)g(on)f(experience)75 1534 y(gained)e(from)g(these)h
(projects)f(here.)75 1661 y Fk(6.1)50 b(Siphon)75 1742
y Fn(The)8 b(Siphon)g(system)f(consists)g(of)h(two)g(major)f
(components.)14 b(The)8 b Fi(packagetool)f Fn(allows)h(software)g
(pack-)75 1792 y(ages)14 b(to)f(be)h(checked)g(in)f(and)g(out)g(from)h
(a)g(repository)e(implemented)g(as)i(a)g(directory)f(in)g(a)h
(distributed)75 1842 y(\256le)e(system.)k(The)11 b(repository)g(is)g
(replicated)h(for)g(availability)m(.)j(When)d(a)g(new)g(version)f(of)h
(a)g(package)g(is)75 1892 y(checked)g(in,)f(it)g(is)f(immediately)g
(visible)g(to)g(all)h(programmers)g(using)f(the)h(local)g(area)h
(network.)j(All)c(the)75 1942 y(\256les)h(in)e(the)i(new)f(version)g
(become)g(visible)g(simultaneously)m(.)117 1992 y(The)g
Fi(siphon)g Fn(component)f(is)h(used)h(to)f(link)g(repositories)g(that)
g(are)h(too)f(far)i(apart)f(to)f(be)h(served)f(by)h(the)75
2042 y(same)c(distributed)f(\256le)h(system.)14 b(\(In)8
b(our)g(case,)i(the)e(two)g(repositories)f(of)h(interest)g(are)h(6000)f
(miles)f(apart.\))75 2091 y(When)13 b(a)f(new)h(version)f(of)h(a)g
(package)g(is)f(checked)h(in)f(at)h(one)f(repository)m(,)h(the)f
(siphon)g(copies)g(it)g(to)g(the)75 2141 y(other)h(repository)e(within)
h(a)h(few)g(hours.)19 b(Again,)13 b(all)f(new)h(\256les)g(in)f(a)h
(single)f(package)h(become)g(visible)75 2191 y(simultaneously)m(.)117
2241 y(An)h(earlier)g(version)g(of)g(this)f(system)h(was)g(coded)g
(with)f(conventional)h(RPC.)h(The)g(current)f(version)75
2291 y(coded)d(with)g(network)g(objects)g(is)g(distinctly)e(simpler)n
(,)i(for)h(several)g(reasons.)117 2341 y(First,)c(pickles)f(and)h
(network)f(streams)g(simpli\256ed)g(the)g(interfaces.)15
b(For)8 b(example,)h(to)e(fetch)h(a)g(package,)75 2391
y(the)g(old)h(siphon)e(enumerated)i(the)f(elements)g(of)h(the)f
(directory)h(by)f(repeated)i(RPC)g(calls;)f(the)f(new)h(siphon)899
2516 y(39)p eop
%%Page: 40 48
40 47 bop 225 141 a Fn(obtains)9 b(a)h(linked)f(structure)h(of)g
(directory)g(elements)f(in)g(one)h(call.)15 b(Also,)10
b(the)g(old)f(siphon)g(used)g(multiple)225 191 y(threads)g(copying)f
(lar)o(ge)i(buf)o(fers)g(of)f(data)g(to)g(send)g(lar)o(ge)g(\256les;)h
(the)f(new)g(siphon)f(uses)h(a)h(network)f(stream.)267
245 y(Second,)15 b(third-party)f(transfers)h(eliminated)e(an)h
(interface.)26 b(The)14 b(previous)g(version)f(of)i(the)f(siphon)225
295 y(would)d(pull)g(a)h(new)f(version)h(of)f(a)h(package)h(from)e(one)
h(of)g(the)f(source)h(replicas,)g(push)f(it)g(over)h(the)g(wide)225
344 y(area)d(network)f(to)f(a)h(partner)h(siphon)e(at)h(the)f(other)h
(site,)h(which)e(would)h(cache)g(it)g(on)g(its)f(disk)g(and)h(then)f
(push)225 394 y(it)j(to)f(each)i(of)f(the)g(destination)f(replicas.)15
b(Thus)10 b(both)f(a)h(pull)g(and)g(a)g(push)g(interface)g(were)h
(required.)16 b(The)225 444 y(new)d(siphon)g(transfers)g(the)h(object)f
(implementing)e(the)i(pull)f(interface)i(to)f(its)g(remote)g(partner)n
(,)i(which)225 494 y(then)c(pulls)f(the)h(\256les)h(from)f(the)g
(source)h(replica)g(directly)m(.)j(Thus)c(the)g(push)f(interface)j(was)
e(eliminated.)267 548 y(Third,)d(we)g(can)g(take)g(advantage)g(of)g
(the)g(ability)e(to)i(plug)f(new)h(transports)f(into)g(the)g(system.)14
b(Data)8 b(com-)225 598 y(pression)i(is)g(known)g(to)g(signi\256cantly)
g(increase)h(bandwidth)e(over)i(wide)g(area)g(networks.)k(Although)9
b(we)225 647 y(have)h(not)f(had)h(need)g(to)f(do)h(so,)g(we)g(could)g
(easily)f(provide)g(a)h(subtype)f(of)h Fh(Transport.T)f
Fn(that)g(automat-)225 697 y(ically)i(compresses)g(and)g(decompresses)g
(data.)16 b(This)11 b(would)f(move)h(the)h(compression)e(code)i(out)e
(of)i(the)225 747 y(application)e(and)i(into)e(a)i(library)f(where)h
(it)f(could)g(easily)g(be)g(reused.)267 801 y(In)e(writing)g(the)h
(Siphon)f(system)g(we)h(deliberately)f(stressed)h(distributed)e
(garbage)j(collection)e(by)g(per)o(-)225 851 y(forming)f(no)h(explicit)
f(deallocations.)13 b(The)c(results)g(of)g(this)f(strategy)g(were)i
(mixed.)k(There)9 b(were)h(no)f(seri-)225 900 y(ous)f(memory)g(leaks)h
(and)g(garbage)g(collection)f(overhead)h(was)g(not)f(a)h(problem,)g
(but)f(automatic)g(reclama-)225 950 y(tion)i(was)g(not)g(as)h(timely)e
(as)i(we)f(would)g(have)h(liked.)k(The)10 b(fundamental)g(problem)g(is)
g(that)g(performance)225 1000 y(tradeof)o(fs)j(made)f(in)g(the)g(local)
g(collector)g(may)g(not)f(be)i(appropriate)f(for)g(the)g(distributed)f
(case.)19 b(For)12 b(ex-)225 1050 y(ample,)f(it)f(may)h(be)g(perfectly)
g(acceptable)g(for)g(the)g(collector)f(to)h(delay)g(reclaiming)f(some)g
(small)g(object,)225 1100 y(but)j(if)g(the)g(object)g(is)f(a)i
(surrogate)f(this)f(can)i(prevent)f(the)g(reclamation)g(of)g(an)g
(object)g(that)g(holds)f(some)225 1150 y(important)d(resource.)16
b(W)l(e)c(also)e(found)g(that)h(the)f(Modula-3)g(local)h(collector)f
(occasionally)g(fails)g(to)h(free)225 1199 y(unreachable)k(objects)e
(because)i(of)f(its)f(conservative)h(strategy)m(,)h(and)f(that)g(this)f
(is)h(more)g(of)g(a)g(problem)225 1249 y(for)e(distributed)e
(computations)f(than)j(for)g(local)f(ones.)16 b(W)l(e)c(conclude)g
(that)f(for)h(an)f(application)g(like)g(the)225 1299
y(Siphon)h(system)g(that)g(holds)f(important)h(resources)h(like)f(Unix)
g(\256le)h(handles,)g(it)f(is)g(necessary)h(either)g(to)225
1349 y(rewrite)f(the)f(local)g(collector)g(or)h(to)f(code)g(the)h
(application)e(to)h(free)h(resources)g(explicitly)m(.)225
1497 y Fk(6.2)50 b(Argo)225 1586 y Fn(Ar)o(go)8 b(is)g(a)g(desktop)f
(telecollaboration)g(system)g(using)h(audio,)g(video,)h(a)f(shared)h
(whiteboard,)f(and)g(shared)225 1636 y(application)15
b(windows)f(to)h(facilitate)h(cooperation)f(among)g(multiple)f(users)h
(who)g(may)h(be)f(separated)225 1686 y(across)g(long)e(distances.)25
b(A)14 b(central)h(function)f(of)g(Ar)o(go)h(is)f(conference)i
(control,)f(which)f(coordinates)225 1735 y(the)9 b(sharing)h(of)f(the)h
(various)f(media)g(and)h(tools)e(to)h(provide)h(a)g(coherent)g(model)e
(of)i(group)f(collaboration.)225 1785 y(This)j(shared)h(state)f(is)g
(held)g(in)g(a)h(small)f(special-purpose)g(database)h(that)f(is)g
(implemented)f(in)i(terms)f(of)225 1835 y(network)f(objects.)267
1889 y(The)f(conference)h(control)f(server)r(')m(s)h(database)g
(de\256nes)f(three)h(types)e(of)i(objects:)j Fi(users)p
Fn(,)c Fi(confer)n(ences)p Fn(,)225 1939 y(and)g Fi(members)p
Fn(.)k(A)c(user)g(object)f(represents)h(a)g(human)f(user)h(of)f(the)h
(system;)f(a)g(conference)i(object)f(repre-)225 1988
y(sents)e(an)h(collaboration,)f(such)h(as)f(a)h(virtual)f(conference)i
(room.)k(The)8 b(basic)h(event)f(is)g(that)h(users)f(join)g(and)225
2038 y(leave)h(conferences.)16 b(A)9 b(member)f(represents)h(a)h
Fl(f)p Fn(user)n(,)f(conf)p Fl(g)g Fn(pair)f(and)h(is)g(created)g
(automatically)f(when)225 2088 y(a)k(user)g(joins)f(a)h(conference.)18
b(Each)12 b(object)f(in)h(the)f(database)h(has)g(a)g(list)f(of)h
(properties)f(whose)g(meaning)225 2138 y(is)h(de\256ned)h(by)f(client)f
(programs.)18 b(General)13 b(property)f(lists)f(were)i(chosen)f
(instead)g(of)g(a)h(prede\256ned)g(hi-)225 2188 y(erarchy)f(of)g
(subtypes)e(to)h(increase)h(independence)f(among)g(client)g(programs.)
267 2242 y(The)i(primary)g(function)f(of)i(the)f(server)g(is)g(to)g
(notify)f(clients)h(of)g(events)g(that)g(occur)h(in)f(its)f(database.)
225 2291 y(This)i(is)h(done)f(via)h(callbacks.)26 b(A)15
b(client)g(program)f(registers)h(a)g Fi(handler)f Fn(object)h(and)g(an)
g Fi(event)g(\256lter)p Fn(.)225 2341 y(When)c(an)h(event)f(passes)g
(the)h(\256lter)n(,)g(an)f(appropriate)h(callback)f(method)g(of)g(the)g
(client')m(s)h(handler)f(object)225 2391 y(is)g(invoked,)h(and)g(is)f
(passed)h(the)g(relevant)g(database)g(object\(s\))g(that)f(were)i
(involved)e(in)g(the)h(event.)17 b(For)1049 2516 y(40)p
eop
%%Page: 41 49
41 48 bop 75 141 a Fn(example,)13 b(when)f(a)h(user)f(joins)g(a)g
(conference,)j(the)d(client)g(programs)g(involved)f(in)h(the)g
(conference)i(are)75 191 y(noti\256ed)d(and)g(can)h(obtain)f(the)g
(properties)g(of)g(the)h(new)f(user)r(')m(s)h(object.)117
241 y(Callbacks)i(like)f(those)g(employed)h(in)f(Ar)o(go)h(are)h
(commonplace)e(in)h(non-distributed)e(applications,)75
291 y(and)i(network)f(objects)g(extend)h(this)e(style)h(to)h
(distributed)e(programming.)21 b(Nonetheless,)14 b(transparent)75
340 y(distributed)6 b(invocation)h(is)h(not)f(a)i(panacea;)h
(distributed)c(programs)i(are)g(inherently)g(more)g(complex)f(than)75
390 y(centralized)15 b(ones.)26 b(For)15 b(example,)h(callbacks)f(from)
g(the)g(Ar)o(go)g(server)g(to)g(clients)f(cannot)g(be)h(treated)75
440 y(like)f(local)g(callbacks:)20 b(the)14 b(server)h(must)e(protect)h
(itself)f(against)h(clients)f(that)h(crash)g(or)g(are)h(too)f(slow)m(,)
75 490 y(especially)8 b(when)g(locks)g(are)h(involved.)k(Although)7
b(good)h(tools)f(can)i(hide)f(many)f(of)i(the)f(tiresome)f(details)75
540 y(of)15 b(distributed)f(programming,)h(they)g(do)g(not)f(yet)h
(eliminate)f(the)h(fundamental)g(issues)f(that)h(must)f(be)75
589 y(faced)e(in)f(designing)f(a)i(robust)e(distributed)g(system.)117
639 y(The)15 b(ease)g(of)h(de\256ning,)g(debugging)e(and)h(modifying)e
(the)i(Ar)o(go)h(conference)g(control)f(system)f(and)75
689 y(its)d(protocol)f(via)i(network)f(objects)g(has)g(been)h(quite)f
(striking.)j(Because)f(of)f(the)f(leverage)h(provided)f(by)75
739 y(Modula-3)g(and)g(network)h(objects,)f(the)h(entire)g(conference)h
(control)e(server)h(implementation)d(contains)75 789
y(only)i(1400)f(lines)h(of)g(source)h(code.)75 912 y
Fk(6.3)50 b(Obliq)75 992 y Fn(Obliq)15 b(is)g(a)i(lexically-scoped,)f
(untyped,)h(interpreted)f(language)f(that)h(supports)f(distributed)f
(object-)75 1042 y(oriented)f(computation.)19 b(Obliq)12
b(objects)h(have)g(state)g(and)g(are)h(local)f(to)g(a)g(site,)h(but)e
(computations)f(can)75 1092 y(roam)g(over)h(the)f(network.)117
1142 y(The)i(characteristics)h(of)g(Modula-3)e(network)h(objects)g(had)
h(a)g(major)f(in\257uence)h(on)f(Obliq,)h(not)f(just)75
1191 y(in)e(the)g(implementation,)e(but)i(also)g(in)f(the)h(language)h
(design.)i(All)d(Obliq)f(objects)h(are)h(implemented)e(as)75
1241 y(network)g(objects,)h(so)f(there)h(is)f(no)h(arti\256cial)g
(separation)f(between)h(local)g(Obliq)e(objects)h(and)h(those)f(that)75
1291 y(may)i(be)g(remotely)g(accessed.)19 b(Also,)12
b(all)g(Obliq)f(program)h(variables)g(are)h(network)f(objects,)g
(including)75 1341 y(global)h(variables.)23 b(Therefore,)16
b(a)e(remote)g(computation)e(can)j(still)d(access)j(global)e(state)h
(at)g(the)f(site)h(at)75 1391 y(which)e(it)g(originated.)19
b(T)m(wo)12 b(elements)g(of)h(the)f(network)h(objects)f(system)f(were)j
(particularly)e(useful)g(in)75 1440 y(simplifying)6 b(the)j(Obliq)f
(implementation.)k(Distributed)7 b(garbage)j(collection)d(relieved)i
(concerns)g(about)75 1490 y(space)g(reclamation,)g(and)f(marshaling)f
(via)i(pickles)e(made)i(it)e(easy)i(to)f(transmit)f(complex)h(data)g
(structures)75 1540 y(such)j(as)h(the)f(runtime)f(representation)h(of)h
(Obliq)e(values.)75 1663 y Fk(6.4)50 b(Other)12 b(work)75
1743 y Fn(Network)e(objects)g(are)i(also)e(in)g(use)g(in)h(a)f(system)g
(for)h(continuous)e(performance)i(monitoring.)i(The)e(sys-)75
1793 y(tem)e(provides)g(a)h Fi(telemonitoring)e Fn(server)i(which)g
(can)g(be)g(directed)g(by)f(the)h(user)f(to)h(retrieve)g(and)g(process)
75 1843 y(event)i(logs)f(from)h(remote)g(programs.)17
b(The)c(logs)e(are)i(communicated)e(to)g(the)h(telemonitor)f(via)h
(remote)75 1893 y(readers.)22 b(Because)14 b(a)g(monitored)e(program)h
(may)g(disconnect)f(from)h(one)g(telemonitor)f(and)h(reconnect)75
1943 y(to)f(another)n(,)i(this)d(application)h(requires)h(the)f
(ability)f(to)i(disconnect)f(a)h(network)f(reader)i(and)e(reconnect)75
1993 y(the)h(underlying)e(data)i(stream)f(to)h(a)g(dif)o(ferent)g
(process.)19 b(This)12 b(works,)i(but)e(requires)g(extra)h(logic)g(in)f
(the)75 2042 y(application.)i(In)d(order)h(to)e(guarantee)i(that)e(no)h
(data)g(is)g(lost,)f(the)h(telemonitor)e(must)h(call)h(the)g(monitored)
75 2092 y(program)g(to)g(indicate)g(that)g(it)g(is)g(disconnecting.)117
2142 y(Our)f(experience)i(with)e(the)g(continuous)g(monitoring)e
(project)j(showed)f(us)h(that)f(the)h(design)f(of)h(reader)75
2192 y(and)k(writer)g(marshaling)f(is)h(trickier)g(than)g(it)g(would)f
(at)h(\256rst)g(appear)m(.)28 b(The)15 b(semantics)g(of)g(marshaled)75
2242 y(streams)10 b(are)i(surprisingly)c(dif)o(\256cult)j(to)f(specify)
h(and)f(there)h(are)h(many)e(design)g(tradeof)o(fs)h(involved.)j(W)l(e)
75 2291 y(chose)f(to)g(give)g(rather)h(weak)g(semantics,)f(barring)g
(third-party)g(marshaling)f(of)h(streams)g(and)h(specify-)75
2341 y(ing)d(little)f(about)h(the)g(state)g(of)h(a)g(concrete)g(stream)
f(after)h(marshaling.)j(Providing)10 b(stronger)h(guarantees)75
2391 y(would)g(have)g(had)h(a)f(high)g(cost)g(in)g(either)g(throughput)
f(or)h(complexity)m(.)899 2516 y(41)p eop
%%Page: 42 50
42 49 bop 267 141 a Fn(W)l(e)14 b(have)g(also)g(implemented)e(secure)j
(network)e(objects.)23 b(A)14 b(secure)g(network)g(object)f(method)g
(can)225 191 y(authenticate)f(its)f(caller)n(,)i(which)f(allows)g
(security)f(based)h(on)g(access)h(control)f(lists.)k(A)c(secure)h
(network)225 241 y(object)g(can)g(also)g(be)g(passed)g(to)f(third)h
(parties)g(and)g(cannot)g(be)g(for)o(ged,)h(which)f(allows)f(security)h
(based)225 291 y(on)e(capabilities.)j(A)e(client)e(can)i(use)f(secure)h
(and)f(ordinary)g(insecure)g(network)g(objects)f(together)h(in)g(the)
225 340 y(same)i(application,)f(incurring)g(a)h(performance)g(penalty)g
(only)f(for)g(secure)i(invocations)d(or)i(third)f(party)225
390 y(transfers)e(of)g(secure)h(objects.)j(Leendert)c(van)g(Doorn)g
(has)f(implemented)g(secure)h(network)g(objects[28)o(],)225
440 y(but)h(the)g(implementation)e(has)i(not)g(yet)g(been)h(released)g
(or)f(extensively)g(used.)267 491 y(W)l(e)e(learned)g(three)h(things)d
(from)i(our)f(secure)i(network)e(object)h(implementation.)j(First,)e
(the)f(design)f(of)225 541 y(the)j(secure)g(system)e(followed)h
(naturally)h(from)f(that)g(of)h(the)f(insecure)h(system.)k(A)10
b(lar)o(ge-scale)i(redesign)225 591 y(was)i(not)f(necessary)m(.)24
b(Second,)15 b(because)f(we)g(use)g(readers)h(and)f(writers)f(for)i
(marshaling,)e(it)h(was)g(easy)225 640 y(to)h(insert)f(reader)j(and)e
(writer)g(subtypes)f(that)h(perform)g(the)g(cryptographic)g(functions)f
(necessary)h(for)225 690 y(network)d(security)m(.)20
b(Finally)m(,)13 b(because)g(of)g(our)g(desire)g(to)f(make)h(remote)g
(invocations)e(transparent,)i(we)225 740 y(did)c(not)g(identify)g(the)h
(caller)g(via)g(an)g(implicit)e(ar)o(gument)h(to)h(the)g(owner)r(')m(s)
g(method.)k(Instead,)c(we)g(require)225 790 y(callers)i(to)g(pass)g(an)
h(explicit)e(extra)h(ar)o(gument)g(if)g(they)g(want)g(to)g(identify)f
(themselves.)18 b(This)11 b(ar)o(gument)225 840 y(is)g(of)g(a)h
(distinguished)d(type)i(that)g(is)g(marshaled)g(specially)m(.)267
891 y(Several)h(users)f(of)h(network)f(objects)g(have)h(noted)f(our)g
(lack)h(of)g(support)e(for)i(object)f(persistence.)16
b(W)l(e)225 940 y(note)9 b(that)g(Carsten)i(W)l(eich)f(has)f(recently)h
(added)g(support)e(for)i(stable)f(objects)g(to)g(the)h(Modula-3)f
(runtime)225 990 y(system.)19 b(He)13 b(captures)g(a)g(stable)f
(snapshots)g(of)h(an)g(object')m(s)f(state)h(and)g(then)f(writes)h(the)
f(ar)o(guments)h(of)225 1040 y(update)e(methods)f(into)h(a)g(redo)h
(log)f(using)f(techniques)h(quite)g(similar)f(to)h(marshaling.)267
1091 y(Providing)6 b(support)h(for)h(stable)f(concrete)i(objects)e(is)g
(not)g(the)h(whole)f(story)m(,)h(however)m(.)15 b(In)8
b(a)g(distributed)225 1141 y(system,)14 b(it)f(can)h(be)g(valuable)g
(for)g(a)g(surrogate)g(object)f(to)h(remain)f(valid)g(after)i(restart)f
(of)g(the)f(owner)r(')m(s)225 1191 y(address)h(space.)23
b(W)l(e)14 b(have)g(not)f(implemented)f(this)h(facility)m(,)h(although)
f(we)h(believe)f(that)h(it)f(would)g(be)225 1240 y(straightforward)e
(to)g(do)g(so)g(with)g(a)g(library)g(built)g(on)g(top)f(of)i(the)f
(existing)f(network)h(object)g(system.)225 1393 y Fj(7)58
b(Conclusion)225 1492 y Fn(The)14 b(narrowest)g(surrogate)g(rule)g(is)g
(\257exible,)h(but)e(the)h(associated)g(type)f(checking)h(is)g(dynamic)
f(rather)225 1542 y(than)f(static,)f(which)h(has)g(all)f(the)h(usual)f
(disadvantages.)17 b(Because)c(programs)e(can)h(be)h(relinked)e(and)h
(re-)225 1592 y(run)e(at)g(any)h(time,)f(it)g(seems)g(impossible)e(to)i
(provide)f(purely)h(static)g(type)g(checking)g(in)g(a)h(distributed)d
(en-)225 1642 y(vironment.)16 b(Dynamic)c(checking)g(imposes)f(a)h
(burden)g(of)g(discipline)f(upon)g(programmers.)18 b(The)12
b(most)225 1691 y(common)c(failure)h(during)f(the)g(early)h(stages)g
(of)g(debugging)e(a)j(network)e(objects)g(application)g(is)g(a)h
(narrow)225 1741 y(fault)j(\(failure)g(of)g(a)g(runtime)f
(type-check\).)17 b(For)c(example,)f(if)f(a)i(programmer)e(for)o(gets)h
(to)f(link)g(in)h(stubs)225 1791 y(for)d(a)h(subtype)e
Fh(A)h Fn(of)g Fh(NetObj.T)p Fn(,)f(an)h(import)f(of)h(an)g
Fh(A)g Fn(object)g(will)f(succeed,)i(but)f(the)f(resultant)h(surrogate)
225 1841 y(will)h(have)i(type)f Fh(NetObj.T)g Fn(and)g(any)h(attempt)e
(to)h Fh(NARROW)g Fn(it)g(to)f(an)i Fh(A)f Fn(object)g(will)g(fail.)267
1892 y(Even)f(an)h(application)f(that)g(has)h(been)g(in)f(service)h
(for)g(a)g(long)f(time)g(can)h(crash)g(with)f(a)h(narrow)g(fault)g(if)
225 1942 y(some)e(programmer)g(carelessly)h(changes)g(a)g(low-level)f
(interface)h(and)g(rebuilds)f(another)g(program)g(with)225
1991 y(which)i(the)h(application)e(communicates.)15 b(Because)e(of)f
(this)e(danger)n(,)j(programmers)e(should)f(minimize)225
2041 y(external)k(dependencies)f(when)g(de\256ning)h(a)f(network)g
(object)h(subtype.)20 b(It)14 b(is)f(also)g(important)f(that)h(the)225
2091 y(implementation)c(of)j(type)f(\256ngerprinting)f(not)h(introduce)
g(spurious)f(dependencies.)267 2142 y(Programmers)e(appreciate)i(the)e
(narrowest)h(surrogate)g(rule,)g(and)g(more)g(than)f(one)h(has)f(asked)
h(for)g(com-)225 2192 y(parable)f(\257exibility)f(in)g(the)h(case)g(of)
g(ordinary)g(objects.)14 b(\(If)8 b(an)g(attempt)f(is)h(made)f(to)h
(unpickle)f(an)h(ordinary)225 2242 y(object)i(into)g(a)h(program)g
(that)f(does)g(not)g(contain)h(the)f(type)g(of)h(the)g(object,)g(an)g
(exception)f(is)g(raised.\))16 b(But)225 2291 y(in)9
b(this)g(case)h(liberality)e(seems)h(unsound.)14 b(Suppose)9
b(type)h Fh(AB)f Fn(is)g(derived)g(from)h Fh(A)p Fn(,)g(and)f(that)g
(we)h(contrive)225 2341 y(to)h(send)f(a)i(copy)f(\(rather)g(than)g(a)h
(reference\))h(of)e(an)g(object)g(of)g(type)g Fh(AB)g
Fn(into)f(a)h(program)g(that)g(knows)f(the)225 2391 y(type)g
Fh(A)g Fn(but)g(not)f(the)h(type)g Fh(AB)p Fn(.)h(One)f(can)h(imagine)e
(doing)g(this)h(either)g(by)g(ignoring)f(the)h Fh(B)g
Fn(data)g(\256elds)h(and)1049 2516 y(42)p eop
%%Page: 43 51
43 50 bop 75 141 a Fn(methods,)9 b(or)g(by)g(somehow)f(holding)f(them)i
(in)f(reserve.)16 b(In)9 b(either)g(case,)i(the)e(new)g(program)g(can)g
(operate)75 191 y(on)i(the)h Fh(A)f Fn(part)h(of)f(the)h(state,)g(for)g
(example)f(by)g(reading)h(or)f(writing)g(data)h(\256elds)f(or)h(by)f
(calling)g(methods)75 241 y(of)f Fh(A)p Fn(.)g(However)n(,)h(there)f
(is)f(no)h(guarantee)g(that)g(these)f(operations)g(will)g(be)h(valid,)g
(since)g(the)f(original)g(type)75 291 y Fh(AB)k Fn(may)g(have)g
(overridden)g(some)g(of)g(the)g(methods)f(of)h Fh(A)p
Fn(;)g(for)h(example)f(in)f(order)i(to)f(accommodate)f(a)75
340 y(change)d(in)e(the)i(meaning)e(of)i(the)f(representation)g(of)g
(the)g Fh(A)g Fn(\256elds.)15 b(The)8 b(narrowest)h(surrogate)f(rule)g
(seems)75 390 y(sound)j(only)f(when)h(objects)g(are)h(transmitted)e(by)
h(reference.)117 474 y(The)f(programmers)g(that)f(have)i(used)f
(network)g(objects)f(have)i(found)f(the)g(abstractions)f(it)h(of)o
(fers)h(to)f(be)75 524 y(simple)h(yet)g(powerful.)17
b(By)12 b(providing)f(transparent)h(remote)f(invocation)g(through)g
(Modula-3)g(objects,)75 574 y(we)f(eliminate)e(many)i(of)f(the)h(fussy)
f(details)g(that)g(make)g(RPC)i(programming)d(tedious.)14
b(Through)9 b(the)h(use)75 623 y(of)j(pickles,)g(and)g(by)f
(implementing)f(third)h(party)h(network)g(object)f(transfers)h(and)g
(marshaled)g(abstract)75 673 y(streams,)i(we)g(remove)g(many)f
(restrictions)g(about)g(what)g(can)h(be)g(marshaled,)h(and)f(we)f(do)h
(so)f(without)75 723 y(increasing)9 b(the)h(complexity)e(of)i
(generated)g(stubs.)k(The)9 b(strength)g(of)h(our)f(system)g(comes)g
(not)g(from)h(pro-)75 773 y(liferating)g(features,)i(but)e(from)g
(carefully)h(analyzing)g(the)f(requirements)g(of)h(distributed)e
(programming)75 823 y(and)i(designing)f(a)i(small)e(set)i(of)f(general)
h(features)g(to)f(meet)g(them.)75 965 y Fk(Acknowledgements)75
1051 y Fn(W)l(e)e(are)f(grateful)g(for)g(help)g(and)f(suggestions)f
(from)i(Bob)g(A)l(yers,)h(Andrew)f(Black,)h(John)f(Ellis,)f(David)h
(Ev-)75 1101 y(ers,)j(Rivka)f(Ladin,)g(Butler)h(Lampson,)e(Mark)h
(Manasse,)h(and)f(Garret)g(Swart.)16 b(W)l(e)11 b(thank)e(Luca)i
(Cardelli)75 1151 y(and)k(Dave)g(Redell)f(for)h(providing)f(words)g
(describing)g(the)g(Obliq)g(and)g(Ar)o(go)h(projects.)25
b(Paul)15 b(Leach,)75 1201 y(Sharon)10 b(Perl,)i(Allan)d(Heydon,)h(and)
g(Cynthia)g(Hibbard)g(made)g(helpful)f(comments)g(on)h(the)f
(presentation)75 1251 y(of)i(this)g(report.)75 1415 y
Fj(Refer)o(ences)98 1518 y Fn([1])21 b(Guy)14 b(T)m(.)g(Almes,)h
(Andrew)f(P)-5 b(.)16 b(Black,)g(Edward)e(D.)h(Lazowska,)g(and)g(Jerre)
g(D.)g(Noe.)31 b(The)15 b(Eden)172 1567 y(system:)f(A)d(technical)g
(review)m(.)17 b Fi(IEEE)12 b(T)m(rans.)g(Softwar)n(e)f(Engineering)p
Fn(,)f(1)n(1\(1\):43\26159,)h(1985.)98 1662 y([2])21
b(Henri)7 b(E.)h(Bal,)i(M.)d(Frans)i(Kaashoek,)f(and)g(Andy)f(S.)i(T)m
(anenbaum.)g(Orca:)14 b(A)7 b(language)h(for)g(parallel)172
1712 y(programming)e(of)i(distributed)e(systems.)i Fi(IEEE)g(T)m(rans.)
g(Softwar)n(e)f(Engineering)p Fn(,)h(18\(3\):190\261205,)172
1762 y(1992.)98 1857 y([3])21 b(Andrew)14 b(Birrell,)g(David)g(Evers,)g
(Greg)g(Nelson,)g(Susan)g(Owicki,)g(and)f(Edward)h(W)l(obber)m(.)29
b(Dis-)172 1907 y(tributed)8 b(garbage)h(collection)f(for)h(Network)g
(Objects.)i(Research)g(report)e(1)n(16,)g(Systems)f(Research)172
1957 y(Center)n(,)13 b(Digital)d(Equipment)g(Corp.,)i(1993.)98
2052 y([4])21 b(Andrew)13 b(D.)h(Birrell)f(and)g(Bruce)i(Jay)e(Nelson.)
25 b(Implementing)12 b(remote)h(procedure)g(call.)26
b Fi(ACM)172 2101 y(T)m(rans.)12 b(Computer)f(Systems)p
Fn(,)g(2\(1\):39\26159,)g(1984.)98 2196 y([5])21 b(Andrew)11
b(P)-5 b(.)12 b(Black)g(and)f(Y)-5 b(eshayahu)12 b(Artsy)m(.)k
(Implementing)10 b(location)g(independent)g(invocation.)172
2246 y Fi(IEEE)h(T)m(rans.)h(Parallel)e(and)h(Distributed)e(Systems)p
Fn(,)j(1\(1\):107\2611)n(19,)f(1990.)98 2341 y([6])21
b(Luca)11 b(Cardelli.)16 b(Obliq:)d(A)e(language)g(with)f(distributed)f
(scope.)16 b(Research)c(report)f(122,)f(Systems)172 2391
y(Research)j(Center)n(,)f(Digital)f(Equipment)e(Corp.,)k(1994.)899
2516 y(43)p eop
%%Page: 44 52
44 51 bop 248 141 a Fn([7])21 b(Jef)o(frey)9 b(S.)f(Chase,)i(Franz)f
(G.)f(Amador)n(,)h(Edward)e(D.)i(Lazowska,)g(Henry)f(M.)f(Levy)m(,)i
(and)f(Richard)g(J.)322 191 y(Little\256eld.)17 b(The)11
b(Amber)h(system:)i(Parallel)e(programming)e(on)h(a)h(network)f(of)h
(multiprocessors.)322 241 y(In)f Fi(Pr)n(oc.)h(12th)f(ACM)h(Symposium)e
(on)h(Operating)f(System)h(Principles)p Fn(,)g(pages)g(147\261158,)g
(1989.)248 334 y([8])21 b(Graeme)13 b(N.)g(Dixon,)g(Santosh)f(K.)h
(Shrivastava,)g(and)g(Graham)g(D.)g(Parrington.)22 b(Managing)12
b(per)o(-)322 384 y(sistent)g(objects)i(in)f(Arjuna:)20
b(a)14 b(system)f(for)h(reliable)g(distribed)f(computing.)27
b(T)m(echnical)14 b(report,)322 433 y(Computing)c(Laboratory)m(,)i
(University)e(of)h(Newcastle)h(upon)e(T)m(yne,)i(undated.)248
527 y([9])21 b(Hania)12 b(Gajewska,)h(Jay)g(Kistler)n(,)f(Mark)h(S.)g
(Manasse,)g(and)f(David)g(D.)h(Redell.)22 b(Ar)o(go:)17
b(A)c(system)322 576 y(for)e(distributed)f(collaboration.)16
b(In)c Fi(Pr)n(oc.)f(ACM)h(Multimedia)e('94)p Fn(,)i(pages)f
(433\261440,)g(1994.)225 670 y([10])21 b(David)14 b(K.)g(Gif)o(ford)g
(and)g(Nathan)h(Glasser)m(.)30 b(Remote)15 b(pipes)e(and)h(procedures)h
(for)f(ef)o(\256cient)h(dis-)322 719 y(tributed)10 b(communication.)15
b Fi(ACM)d(T)m(rans.)g(Computer)f(Systems)p Fn(,)g(6\(3\):258\261283,)g
(1988.)227 812 y([1)n(1])21 b(Graham)12 b(Hamilton,)g(Michael)g(L.)g
(Powell,)h(and)g(James)e(G.)i(Mitchell.)20 b(Subcontract:)d(A)c
(\257exible)322 862 y(base)8 b(for)h(distributed)e(programming.)i(T)m
(echnical)g(Report)f(SMLI)h(TR-93-13,)g(Sun)f(Microsystems)322
912 y(Laboratories,)j(1993.)225 1005 y([12])21 b(M.)13
b(Herlihy)f(and)h(B.)g(Liskov)m(.)23 b(A)13 b(value)f(transmission)f
(method)h(for)h(abstract)f(data)h(types.)23 b Fi(ACM)322
1055 y(T)m(rans.)12 b(Pr)n(ogramming)e(Languages)g(and)h(Systems)p
Fn(,)h(4\(4\):527\261551,)e(1982.)225 1148 y([13])21
b(Jim)11 b(Horning,)h(Bill)f(Kalsow)m(,)h(Paul)g(McJones,)g(and)g(Greg)
g(Nelson.)19 b(Some)12 b(useful)g(Modula-3)f(in-)322
1198 y(terfaces.)i(Research)d(report)f(1)n(13,)h(Systems)e(Research)i
(Center)n(,)h(Digital)d(Equipment)f(Corp.,)k(1993.)225
1291 y([14])21 b(Eric)10 b(Jul,)g(Henry)g(Levy)m(,)g(Norman)g
(Hutchinson,)f(and)h(Andrew)g(Black.)k(Fine-grained)c(mobility)e(in)322
1341 y(the)j(Emerald)g(system.)16 b Fi(ACM)c(T)m(rans.)g(Computer)f
(Systems)p Fn(,)g(6\(1\):109\261133,)f(1988.)225 1434
y([15])21 b(K.)13 b(Rustan)g(M.)h(Leino.)25 b(Extensions)12
b(to)g(an)i(object-oriented)e(programming)g(language)h(for)h(pro-)322
1484 y(gramming)e(\256ne-grain)h(multicomputers.)23 b(T)m(echnical)13
b(report)g(CS-TR-92-26,)i(California)e(Insti-)322 1534
y(tute)e(of)g(T)m(echnology)m(,)g(1992.)225 1627 y([16])21
b(Barbara)13 b(Liskov)m(.)i(Distributed)10 b(programming)g(in)h(Ar)o
(gus.)17 b Fi(CACM)p Fn(,)c(31\(3\):300\261312,)d(1988.)225
1720 y([17])21 b(Barbara)12 b(Liskov)m(,)e(Dorothy)g(Curtis,)h(Paul)f
(Johnson,)g(and)h(Robert)g(Schei\257er)m(.)17 b(Implementation)9
b(of)322 1770 y(Ar)o(gus.)16 b(In)10 b Fi(Pr)n(oc.)i(1)m(1th)e(ACM)h
(Symposium)f(on)g(Operating)g(System)h(Principles)p Fn(,)f(pages)h(1)n
(1)n(1\261122,)322 1819 y(1987.)225 1912 y([18])21 b(Greg)13
b(Nelson,)f(editor)m(.)23 b Fi(Systems)12 b(Pr)n(ogramming)f(with)h
(Modula-3)p Fn(.)22 b(Prentice)13 b(Hall,)g(Englewood)322
1962 y(Clif)o(fs,)f(New)f(Jersey)m(,)h(1991.)17 b(ISBN)12
b(0-13-590464-1.)225 2055 y([19])21 b(Object)10 b(Management)h(Group.)k
Fi(Common)c(Object)g(Request)f(Br)n(oker:)16 b(Ar)n(chitectur)n(e)10
b(and)h(Speci\256-)322 2105 y(cation)p Fn(,)g(1991.)16
b(OMG)11 b(Document)g(91.12.1.)225 2198 y([20])21 b(Open)12
b(Software)i(Foundation.)22 b Fi(DCE)13 b(Application)e(Development)i
(Refer)n(ence,)h(volume)f(1,)g(r)n(evi-)322 2248 y(sion)d(1.0)p
Fn(,)i(1991.)225 2341 y([21])21 b(Francis)13 b(Prusker)f(and)g(Edward)h
(W)l(obber)m(.)22 b(The)12 b(Siphon:)k(Managing)11 b(distant)h
(replicated)g(reposi-)322 2391 y(tories.)k(Research)d(report)e(7,)h
(Paris)g(Research)h(Laboratory)m(,)e(Digital)g(Equipment)e(Corp.,)k
(1991.)1049 2516 y(44)p eop
%%Page: 45 53
45 52 bop 75 141 a Fn([22])21 b(Michael)16 b(D.)i(Schroeder)n(,)i
(Andrew)d(D.)g(Birrell,)j(Michael)c(Burrows,)j(Hal)e(Murray)m(,)i
(Roger)f(M.)172 191 y(Needham,)11 b(Thomas)g(L.)g(Rodehef)o(fer)n(,)i
(Edwin)e(H.)g(Satterthwaite,)h(and)f(Charles)g(P)-5 b(.)12
b(Thacker)m(.)18 b(Au-)172 241 y(tonet:)e(a)c(high-speed,)h
(self-con\256guring)e(local)h(area)i(network)e(using)f(point-to-point)f
(links.)20 b(Re-)172 291 y(search)12 b(report)f(59,)h(Systems)e
(Research)j(Center)n(,)g(Digital)d(Equipment)g(Corp.,)j(1990.)75
374 y([23])21 b(Michael)10 b(D.)i(Schroeder)g(and)f(Michael)g(Burrows.)
16 b(Performance)c(of)f(Fire\257y)h(RPC.)18 b Fi(ACM)11
b(T)m(rans.)172 423 y(Computer)g(Systems)p Fn(,)g(8\(1\):1\26117,)g
(1990.)75 506 y([24])21 b(Marc)8 b(Shapiro.)j(Structure)e(and)f
(encapsulation)f(in)h(distributed)f(systems:)12 b(the)c(proxy)f
(principle.)k(In)172 556 y Fi(IEEE)d(International)f(Confer)n(ence)i
(on)f(Distributed)f(Computer)h(Systems)p Fn(,)h(pages)g(198\261204,)f
(1986.)75 639 y([25])21 b(Marc)15 b(Shapiro,)i(Y)-5 b(von)15
b(Gourhant,)h(Sabine)f(Habert,)i(Laurence)e(Mosseri,)h(Michel)e(Ruf)o
(\256n,)k(and)172 689 y(Celine)9 b(V)-5 b(alot.)11 b(SOS:)e(An)g
(object-oriented)f(operating)g(system)g(\320)g(assessment)g(and)h
(perspectives.)172 739 y Fi(Computing)h(Systems)p Fn(,)i
(2\(4\):287\261337,)e(1989.)75 822 y([26])21 b(J.)8 b(E.)g(Stoy)g(and)g
(C.)h(Strachey)m(.)j(OS6\320an)c(experimental)f(operating)h(system)f
(for)h(a)g(small)f(computer)m(.)172 872 y(Part)12 b(2:)j(input/output)8
b(and)k(\256ling)e(system.)16 b Fi(The)c(Computer)f(Journal)p
Fn(,)g(15\(3\):195\261203,)f(1972.)75 955 y([27])21 b(Andrew)14
b(S.)i(T)m(annenbaum,)f(Robbert)f(van)h(Renesse,)h(Hans)e(van)h
(Staveren,)h(Gregory)f(J.)g(Sharp,)172 1005 y(Sape)d(J.)g(Mullender)n
(,)f(Jack)h(Jansen,)g(and)g(Guido)e(van)i(Rossum.)17
b(Experiences)12 b(with)f(the)g(Amoeba)172 1054 y(distributed)f
(operating)g(system.)16 b Fi(CACM)p Fn(,)d(33\(12\):46\26163,)d(1990.)
75 1143 y([28])21 b(Leendert)14 b(van)f(Doorn,)h(Mart)657
1133 y(\302)658 1143 y(in)f(Abadi,)h(Mike)f(Burrows,)h(and)g(Edward)f
(W)l(obber)m(.)28 b(Secure)15 b(Net-)172 1193 y(work)c(Objects.)16
b(Research)d(report)f(IR-385,)g(V)m(rije)f(Universiteit,)g(Amsterdam,)g
(1995.)899 2516 y(45)p eop
%%Page: 46 54
46 53 bop 1049 2516 a Fn(46)p eop
%%Page: 47 55
47 54 bop 75 211 a Fj(Index)75 300 y Fn(agent,)12 b(6,)f(21)75
350 y(alerts,)h(9,)f(21)75 400 y(Amber)n(,)h(3)75 450
y(AN1)f(network,)h(38)75 500 y(Ar)o(go,)g(40)75 549 y(Ar)o(gus,)g(1,)f
(3)75 599 y(Arjuna,)h(3)75 649 y Fh(Atom.T)p Fn(,)f(21)75
699 y Fh(AtomList.T)p Fn(,)g(21)75 791 y(back)h(connections,)f(13,)g
(37)75 841 y(bootstrapping,)f(20)75 891 y(buf)o(fered)i(streams,)g(23)
75 941 y(buf)o(fered)g(streams,)g(9,)f(34)158 991 y(marshaling)f(of,)i
(19)158 1040 y(readers,)h(2)158 1090 y(writers,)f(2)75
1182 y Fh(ChooseTC)p Fn(,)f(18)75 1232 y(client,)g(3)75
1282 y(context)g(handle,)g(7)75 1332 y(CORBA,)i(3)75
1424 y(DCE)f(RPC,)h(19)75 1474 y(deadlock,)f(19)75 1524
y Fh(Dirty)p Fn(,)f(18)75 1574 y(dirty)g(set,)g(1)n(1)75
1624 y Fh(Dispatcher)p Fn(,)g(13,)g(14)75 1673 y(dispatching,)f(13,)i
(29)75 1723 y(dynamic)f(typing,)f(9)75 1815 y(Eden,)i(1)75
1865 y(Emerald,)g(3)75 1915 y(endpoint,)f(12)75 2007
y(failure)h(semantics,)f(8)75 2057 y Fh(FindSpace)p Fn(,)g(17)75
2107 y(\256ngerprints,)g(9)75 2199 y(garbage)h(collection,)f(9,)h(21)75
2249 y(Gif)o(ford,)g(Dave,)g(19)75 2299 y(Glasser)n(,)g(Nathan,)g(19)75
2391 y(Hermes,)g(2)994 300 y Fh(InNetObj)p Fn(,)g(16)994
397 y(Lamport,)g(Leslie,)f(8)994 447 y(Leino,)h(Rustan,)g(3)994
497 y(liveness,)f(13,)h(37)994 594 y(marshaling,)f(2)1077
644 y(of)h(generic)g(data,)g(30)1077 694 y(of)g(network)f(objects,)g
(15)1077 744 y(of)h(pickles,)f(1)n(1)1077 794 y(of)h(reference)h
(types,)e(30)1077 844 y(of)h(streams,)f(19)994 894 y(message)h
(streams,)f(34)994 945 y(Modula-3,)g(1,)h(9)1077 995
y(runtime)f(library)m(,)h(21)1077 1045 y(type)g(inheritance)f(in,)g(4)
994 1095 y(Mosaic,)h(3)994 1145 y Fh(MsgRd)25 b Fn(interface,)12
b(34)994 1195 y Fh(MsgWr)25 b Fn(interface,)12 b(35)994
1292 y(narrowest)g(surrogate)f(rule,)h(4,)g(18,)f(42)994
1342 y Fh(NetObj)25 b Fn(interface,)12 b(21)994 1392
y Fh(NetObj.Address)p Fn(,)f(22,)g(37)994 1442 y Fh(NetObj.Error)p
Fn(,)g(8,)h(12)994 1492 y Fh(NetObj.Export)p Fn(,)f(6,)h(22)994
1543 y Fh(NetObj.Import)p Fn(,)f(6,)h(22)994 1593 y Fh(NetObj.Locate)p
Fn(,)f(6,)h(22)994 1643 y Fh(NetObj.T)p Fn(,)g(5,)f(22,)h(26)994
1693 y Fh(NetObjNotifier.AddNotifier)p Fn(,)e(24)994
1743 y Fh(NetStream.ReleaseRd)p Fn(,)h(24)994 1793 y
Fh(NetStream.ReleaseWr)p Fn(,)g(24)994 1843 y(network)h(object,)f(3)
1077 1893 y(client,)h(3)1077 1943 y(for)o(ging,)g(20)1077
1994 y(marshaling,)f(15)1077 2044 y(owner)n(,)i(3)1077
2094 y(surrogate,)f(4)1077 2144 y(third)f(party)g(transfer)n(,)i(4)1077
2194 y(wire)f(representation,)g(13)994 2244 y Fh(NewSrgt)p
Fn(,)g(16)994 2341 y(object)f(\(Modula-3\),)h(3)994 2391
y(object)f(adaptor)h(\(CORBA\),)h(3)899 2516 y(47)p eop
%%Page: 48 56
48 55 bop 225 141 a Fn(object)11 b(table,)h(13)225 191
y Fh(ObjID)p Fn(,)f(13)225 241 y(Obliq,)g(41)225 292
y(Orca,)i(3)225 342 y(orphan)e(computation,)f(8,)i(22)225
392 y(OS6,)g(2)225 442 y Fh(OutNetObj)p Fn(,)f(15)225
492 y(owner)n(,)h(3)225 590 y(packagetool,)f(39)225 640
y(performance,)i(38)225 690 y(pickles,)e(2,)h(1)n(1)225
741 y(program)f(instance,)h(21)225 791 y(pure)g(\(object)f(type\),)g(4)
225 888 y Fh(Rd.T)p Fn(,)g(21,)h(23)225 939 y(readers,)h(2,)e(21,)h(34)
225 989 y(remote)f(invocation,)g(14)225 1039 y(RPC,)i(1)225
1137 y(Secure)g(Network)e(Objects,)g(42)225 1187 y(Shapiro,)h(Marc,)g
(1)225 1237 y(shared)g(memory)m(,)f(12)225 1287 y(Siphon,)g(39)225
1337 y(SOS,)i(3)225 1388 y Fh(SpaceID)p Fn(,)e(13)225
1438 y(special)g(object,)h(20)225 1488 y(Spring,)g(3)225
1538 y(stub)f(generator)n(,)h(2,)g(25)308 1588 y(restrictions,)f(25)308
1638 y(version)g(numbers,)g(26)225 1689 y Fh(StubConn)24
b Fn(interface,)13 b(33)225 1739 y Fh(StubLib)24 b Fn(interface,)13
b(14,)e(26)225 1789 y Fh(StubLib.AwaitResult)p Fn(,)f(28)225
1839 y Fh(StubLib.Conn)p Fn(,)h(13,)g(26,)h(33,)f(37)225
1889 y Fh(StubLib.DataRep)p Fn(,)f(27)225 1939 y Fh(StubLib.Dispatcher)
p Fn(,)g(29)225 1990 y Fh(StubLib.EndCall)p Fn(,)g(29)225
2040 y Fh(StubLib.InInteger)p Fn(,)g(30)225 2090 y Fh(StubLib.InRef)p
Fn(,)h(30)225 2140 y Fh(StubLib.NativeRep)p Fn(,)f(27)225
2190 y Fh(StubLib.NullStubProtocol)p Fn(,)g(27)225 2241
y Fh(StubLib.OutInteger)p Fn(,)g(30)225 2291 y Fh(StubLib.OutRef)p
Fn(,)h(30)225 2341 y Fh(StubLib.RaiseUnmarshalFailure)p
Fn(,)6 b(31)225 2391 y Fh(StubLib.Register)p Fn(,)k(27)1144
141 y Fh(StubLib.StartCall)p Fn(,)h(28)1144 191 y Fh
(StubLib.StartResult)p Fn(,)g(29)1144 241 y Fh(StubLib.StubProtocol)p
Fn(,)f(27)1144 291 y Fh(StubLib.SystemStubProtocol)p
Fn(,)g(27)1144 340 y(stubs,)h(2,)h(26)1227 390 y(client,)g(4,)f(14,)h
(26,)f(28)1227 440 y(example)h(interface,)g(31)1227 490
y(example)g(module,)e(31)1227 540 y(server)n(,)j(15,)f(26,)f(29)1144
589 y(subcontract,)h(3)1144 639 y(subtyping,)e(5,)i(7)1144
689 y(surrogate,)g(4,)g(16)1144 780 y(TCP)-5 b(,)13 b(12,)e(20,)h(38)
1144 830 y Fh(TCPTransport.T)p Fn(,)f(12)1144 880 y(third)g(party)g
(transfer)n(,)i(4)1144 930 y Fh(Thread.Alerted)p Fn(,)e(21)1144
980 y(threads,)h(9)1144 1029 y Fh(Transport)25 b Fn(interface,)12
b(35)1144 1079 y Fh(Transport.Location)p Fn(,)f(12)1227
1129 y Fh(dead)25 b Fn(method,)11 b(37)1227 1179 y Fh(free)25
b Fn(method,)11 b(37)1227 1229 y Fh(new)25 b Fn(method,)11
b(12,)g(37)1144 1279 y Fh(Transport.T)p Fn(,)g(12)1227
1328 y Fh(fromEndpoint)24 b Fn(method,)11 b(12,)h(36)1227
1378 y Fh(serviceCall)24 b Fn(method,)11 b(36)1227 1428
y Fh(toEndpoint)24 b Fn(method,)11 b(36)1144 1478 y(transports,)g(4,)h
(12)1144 1528 y(type)g(clash,)f(7)1144 1577 y(type)h(inheritance,)f(3,)
h(4)1144 1627 y(typecodes,)g(9,)g(15,)f(27)1144 1719
y(Unix,)h(9)1144 1810 y(valid)f(\(object)g(type\),)h(25)1144
1860 y(vanDoorn,)g(Leendert,)g(42)1144 1910 y Fh(Voucher)p
Fn(,)g(19)1144 2001 y Fh(WeakRef)25 b Fn(interface,)12
b(21)1144 2051 y(W)n(ireRep,)h(13)1144 2100 y Fh(Wr.T)p
Fn(,)f(21,)f(23)1144 2150 y(writers,)h(2,)g(21,)f(34)1049
2516 y(48)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
