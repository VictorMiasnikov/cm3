<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: cmvbt/src/TableVBT.i3</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>cmvbt/src/TableVBT.i3</H2></A><HR>
<inInterface>
<PRE>
</PRE> Copyright 1996-2000 Critical Mass, Inc. All Rights Reserved. 
 See file COPYRIGHT-CMASS for details. 

<P><PRE>INTERFACE <interface><A HREF="TableVBT.m3.html">TableVBT</A></interface>;
</PRE> <CODE>TableVBT</CODE> manages a table of VBTs, with proper
   headings, and highlighting, similar to a spread sheet.
   Each table uses two grid splits, one for its headings,
   and another for the contents. 

<P><PRE>IMPORT <A HREF="../../ui/src/vbt/Font.i3.html">Font</A>, <A HREF="../../ui/src/vbt/VBT.i3.html">VBT</A>, <A HREF="../../ui/src/vbt/PaintOp.i3.html">PaintOp</A>, <A HREF="../../ui/src/vbt/Pixmap.i3.html">Pixmap</A>;
IMPORT <A HREF="GridSplit.i3.html">GridSplit</A>;

TYPE
  <A HREF="TableVBT.m3.html#T">T</A> &lt;: Public;
  Public = Private OBJECT METHODS
    init(READONLY colnames: ARRAY OF TEXT;
         READONLY colsizes: ARRAY OF CARDINAL;
                  fnt: Font.T := Font.BuiltIn;
                  nrows: CARDINAL := 0;
                  rowheight : CARDINAL := 24;
                  colwidth : CARDINAL := 150;
                  op : PaintOp.T := PaintOp.Bg;
                  txt: Pixmap.T := Pixmap.Solid): T;
    contents(): GridSplit.T;

    heading(col: CARDINAL; READONLY cd: VBT.MouseRec);
    content(row: CARDINAL; READONLY cd: VBT.MouseRec);

    numrows(): CARDINAL;

    insert(row: CARDINAL := LAST(CARDINAL);
           READONLY data: ARRAY OF VBT.T);

    delete(row: CARDINAL;
           VAR      data: ARRAY OF VBT.T);

  END;
  <A HREF="TableVBT.m3.html#Private">Private</A> &lt;: VBT.T;

  (* A call to &quot;v.init&quot; initializes &quot;v&quot; with
     column names and sizes &quot;colnames&quot; and &quot;colsizes&quot;,
     with &quot;fnt&quot; as the font and with &quot;nrows&quot;.
     Row height and column width are set to
     &quot;rowheight&quot;, &quot;colwidth&quot;. Finally, &quot;op&quot; and
     &quot;txt&quot; provide the usual painting operations.
     It is a checked runtime error if
     &quot;NUMBER(colsizes) # NUMBER(colnames)&quot;.

     &quot;v.contents&quot; returns the grid split
     for the &quot;v&quot;. &quot;v.heading&quot; and &quot;v.content&quot;
     are callbacks which are called when
     the user clicks on a column in the heading
     or a column in the contents.

     &quot;v.numrows&quot; returns the number of rows.

     &quot;v.insert&quot; inserts a row with the content
     &quot;data&quot; in the contents.

     &quot;v.delete&quot; deletes a row of the table. *)

END TableVBT.
</PRE>
</inInterface>
<PRE>























</PRE>
</BODY>
</HTML>
