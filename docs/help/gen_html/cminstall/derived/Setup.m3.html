<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: cminstall/derived/Setup.m3</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>cminstall/derived/Setup.m3</H2></A><HR>
<inModule>
<PRE>MODULE <module><implements><A HREF="Setup.i3.html">Setup</A></implements></module>;
</PRE><BLOCKQUOTE><EM> Generated by m3bundle; see its manpage. </EM></BLOCKQUOTE><PRE>

IMPORT <A HREF="../../libm3/src/bundleintf/Bundle.i3.html">Bundle</A>, <A HREF="../../libm3/src/bundleintf/BundleRep.i3.html">BundleRep</A>, <A HREF="../../m3core/src/text/Text.i3.html">Text</A>;

TYPE T = Bundle.T OBJECT OVERRIDES
           get      := LookUp;
           getNames := GetNames;
         END;

TYPE Texts = REF ARRAY OF TEXT;

VAR
  bundle: T     := NIL;
  names : Texts := NIL;

PROCEDURE <A NAME="Get"><procedure>Get</procedure></A>(): Bundle.T =
  BEGIN
    IF (bundle = NIL) THEN bundle := NEW (T) END;
    RETURN bundle;
  END Get;

PROCEDURE <A NAME="GetNames"><procedure>GetNames</procedure></A> (&lt;*UNUSED*&gt; self: T): Texts =
  BEGIN
    IF names = NIL THEN
      names := NEW (Texts, NUMBER (Names));
      names^ := Names;
    END;
    RETURN names;
  END GetNames;

PROCEDURE <A NAME="LookUp"><procedure>LookUp</procedure></A> (&lt;*UNUSED*&gt; self: T;  element: TEXT): TEXT =
  BEGIN
    FOR i := 0 TO LAST (Names)-1 DO
      IF Text.Equal (Names[i], element) THEN
        RETURN Elements[i];
      END;
    END;
    RETURN NIL;
  END LookUp;

CONST Names = ARRAY [0..1] OF TEXT {
  &quot;config&quot;,
  NIL
};

CONST Elements = ARRAY [0..1] OF TEXT {
  E0,
  NIL
};

CONST E0 =
   &quot;readonly TARGET = \&quot;AMD64_LINUX\&quot; % code generation target\nreadonly WO&quot;
 &amp; &quot;RD_SIZE = \&quot;64BITS\&quot; % { \&quot;32BITS\&quot; or \&quot;64BITS\&quot; }\nreadonly GNU_PLATF&quot;
 &amp; &quot;ORM = \&quot;amd64-pc-linux-gnu\&quot; % \&quot;cpu-vendor-os\&quot; string for GNU\n\n%\n%&quot;
 &amp; &quot; add s switch to ar and remove need for ranlib\n%\nreadonly AR_AND_RANL&quot;
 &amp; &quot;IB_ARE_ONE = TRUE\n\nreadonly m3back_flags = \&quot;-quiet -gstabs+ -m64 -fP&quot;
 &amp; &quot;IC -mno-align-double\&quot;\nreadonly SYSTEM_CC = \&quot;gcc -gstabs+ -m64 -fPIC &quot;
 &amp; &quot;-mno-align-double\&quot; % C compiler\nSYSTEM_LD = SYSTEM_CC\n  &amp; \&quot; -z now\&quot;&quot;
 &amp; &quot;\n  &amp; \&quot; -z origin\&quot;\n  &amp; \&quot; -Bsymbolic\&quot;\n% I thought -as-needed was g&quot;
 &amp; &quot;enerally considered good, but it is\n% breaking Linux/x86 so disable he&quot;
 &amp; &quot;re for now.\n% &amp; \&quot; -Wl,--as-needed\&quot;\n  &amp; \&quot; -Wl,--fatal-warnings\&quot;\n%&quot;
 &amp; &quot; &amp; \&quot; -Wl,-no-allow-shlib-undefined\&quot;\n  &amp; \&quot; -Wl,-rpath,\\\\$ORIGIN/..&quot;
 &amp; &quot;/lib\&quot;\n  &amp; \&quot; -Wl,--warn-common\&quot;\n% -pie is broken by linking to posi&quot;
 &amp; &quot;tition-dependent static libraries,\n% such as libz.a by cvsup on birch &quot;
 &amp; &quot;(elegosoft machine).\n% Imho position-dependent code should just never &quot;
 &amp; &quot;exist, oh well.\n%readonly POSITION_INDEPENDENT_EXECUTABLE = \&quot;-pie\&quot;\n&quot;
 &amp; &quot;readonly USE_ORIGIN = TRUE\nreadonly SYSTEM_ASM = \&quot;as --64\&quot; % Assembl&quot;
 &amp; &quot;er\n\n%\n% newer platforms never needed these workarounds for\n% bootst&quot;
 &amp; &quot;rapping with older builds\n%\nreadonly proc GetGcWrapFlags() is return &quot;
 &amp; &quot;\&quot;\&quot; end\nreadonly proc FixM3GcDefs(x) is return x end\nreadonly proc G&quot;
 &amp; &quot;etM3BackFlag(x) is return x end\n\ninclude(\&quot;Unix.common\&quot;)\ninclude(\&quot;&quot;
 &amp; &quot;gnuld.common\&quot;)\n\n&quot;;

BEGIN
END Setup.
</PRE>
</inModule>
<PRE>























</PRE>
</BODY>
</HTML>
