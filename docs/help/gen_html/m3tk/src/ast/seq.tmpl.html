<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: m3tk/src/ast/seq.tmpl</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>m3tk/src/ast/seq.tmpl</H2></A><HR>
<PRE>%************************************************************************
%		                                                        *
%*                                                                      *
%*         Copyright 1994 Sun Microsystems, Inc. All Rights Reserved.   *
%*                                                                      *
%*      Permission to use, copy, modify, and distribute this software   *
%*      and its documentation for any purpose and without fee is hereby *
%*      granted, provided that the above copyright notice appear in all *
%*      copies and that both that copyright notice and this permission  *
%*      notice appear in supporting documentation, and that the name of *
%*      Sun Microsystems, Inc. (SMI) not be used in advertising or      *
%*      publicity pertaining to distribution of the software without    *
%*      specific, written prior permission.                             *
%*                                                                      *
%*                                                                      *
%*      SMI DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,      *
%*      INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY,	        *
%*      FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.           *
%*      IN NO EVENT SHALL SMI BE LIABLE FOR ANY SPECIAL, INCIDENTAL,    *
%*	INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER     *
%*      RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN      *
%*      ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION,        *
%*      ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE     *
%*      OF THIS SOFTWARE.                                               *
%*                                                                      *
%***********************************************************************)

% quake functions to instantiate am AST sequence

readonly proc Seq (view, nm) is
  local elt = &quot;M3AST_&quot; &amp; view &amp; &quot;_&quot; &amp; nm
  local seq = &quot;Seq&quot; &amp; elt
  build_generic_intf (seq, &quot;SeqElem&quot;, [elt], VISIBLE)
  ex_build_generic_impl (seq, &quot;SeqElem&quot;, [elt])
  build_generic_intf (seq &amp; &quot;_rep&quot;, &quot;SeqElem_rep&quot;, [seq, elt], VISIBLE)
  build_T_interface(view, nm, VISIBLE)
end

readonly proc seq (view, nm) is
  local elt = &quot;M3AST_&quot; &amp; view &amp; &quot;_&quot; &amp; nm
  local seq = &quot;Seq&quot; &amp; elt
  build_generic_intf (seq, &quot;SeqElem&quot;, [elt], HIDDEN)
  ex_build_generic_impl (seq, &quot;SeqElem&quot;, [elt])
  build_generic_intf (seq &amp; &quot;_rep&quot;, &quot;SeqElem_rep&quot;, [seq, elt], HIDDEN)
  build_T_interface(view, nm, HIDDEN)
end

readonly proc ex_build_generic_impl (nm, generic, args) is
  local file = nm &amp; &quot;.m3&quot;
  local tmp  = &quot;.generic.tmp&quot;
  local sep  = &quot;&quot;
  if defined (&quot;_all&quot;)
    &gt; tmp in
      write (&quot;(*generated by m3build*)&quot;, CR, CR)
      write (&quot;MODULE &quot;, nm, &quot; EXPORTS &quot;, nm, &quot;, &quot;, nm &amp; &quot;_rep&quot;, CR,
             &quot;     = &quot;, generic, &quot; (&quot;)
      foreach f in args
        write (sep, f)
        sep = &quot;, &quot;
      end
      write (&quot;) END &quot;, nm , &quot;.&quot;, CR)
    end
    cp_if (tmp, file)
    delete_file (tmp)
  end
  derived_implementation (nm)
end

readonly proc build_T_interface(v, nm, vis) is
  local view = &quot;M3AST_&quot; &amp; v
  local unit = view &amp; &quot;_&quot; &amp; nm
  local tmp  = &quot;.generic.tmp&quot;
  if defined(&quot;_all&quot;)
    &gt; tmp in
      write (&quot;(*generated by m3build*)&quot;, CR, CR)
      write (&quot;INTERFACE &quot;, unit, &quot;;&quot;, CR)
      write (&quot;IMPORT &quot;, view, &quot;;&quot;, CR)
      write (&quot;TYPE T = &quot;, view, &quot;.&quot;, nm, &quot;;&quot;, CR)
      write (&quot;END &quot;, unit, &quot;.&quot;, CR)
    end
    cp_if(tmp, unit &amp; &quot;.i3&quot;)
    delete_file(tmp)
  end
  derived_interface (unit, vis)
end
</PRE>
</inInterface>
<PRE>























</PRE>
</BODY>
</HTML>
