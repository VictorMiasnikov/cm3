<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: m3core/src/text/TextLiteral.i3</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>m3core/src/text/TextLiteral.i3</H2></A><HR>
<inInterface>
<PRE></PRE> Copyright 1996-2000, Critical Mass, Inc.  All rights reserved. 
 See file COPYRIGHT-CMASS for details. 

<P> A <CODE>TextLiteral.T</CODE> is a text generated by the compiler.  They contain
   either 8-bit <CODE>CHAR</CODE> characters or 16-bit <CODE>WIDECHAR</CODE> characters, but
   not both.  These values do not reside in the heap.
   In spite of the declaration, the <CODE>contents</CODE> array is only large enough
   to hold the literal and its null termination. 

<P><PRE>UNSAFE INTERFACE <interface><A HREF="TextLiteral.m3.html">TextLiteral</A></interface>;

IMPORT <A HREF="../runtime/common/RTHooks.i3.html">RTHooks</A>, <A HREF="TextClass.i3.html">TextClass</A>;

CONST
 (* BUG: The front end should do target arithmetic so this is legal,
 but declaring that a text cannot be larger than 4G isn't terrible. *)
 (* MaxBytes = LAST (INTEGER) DIV BITSIZE (Byte) - 32; *)
 MaxBytes = 16_0FFFFFF0;

TYPE
  T = RTHooks.TextLiteral;
REVEAL
  <A NAME="T">T</A> = TEXT BRANDED &quot;TextLiteral.T&quot; OBJECT
    cnt : INTEGER;
    buf : ARRAY [0..MaxBytes - 1] OF Byte;
  OVERRIDES
    get_info       := RTHooks.TextLitInfo;
    get_char       := RTHooks.TextLitGetChar;
    get_wide_char  := RTHooks.TextLitGetWideChar;
    get_chars      := RTHooks.TextLitGetChars;
    get_wide_chars := RTHooks.TextLitGetWideChars;
  END;
  (* The array contains the characters of the text followed by a null
     character.  If &quot;cnt&quot; is negative each pair of bytes in &quot;buf&quot;
     is a &quot;WIDECHAR&quot;.  Otherwise, each byte of &quot;buf&quot; is a &quot;CHAR&quot;. *)

TYPE
  Byte = [0..255];

END TextLiteral.
</PRE>
</inInterface>
<PRE>























</PRE>
</BODY>
</HTML>
