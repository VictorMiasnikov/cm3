<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: cit_util/src/RTBrand.m3</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>cit_util/src/RTBrand.m3</H2></A><HR>
<inModule>
<PRE></PRE> $Id: RTBrand.m3.html,v 1.3 2010-04-29 17:17:56 wagner Exp $ 

<P><PRE>UNSAFE MODULE <module><implements><A HREF="RTBrand.i3.html">RTBrand</A></implements></module>;

IMPORT (* M3toC, *) <A HREF="../../m3core/src/runtime/common/RT0.i3.html">RT0</A>, <A HREF="../../m3core/src/runtime/common/RTType.i3.html">RTType</A>, <A HREF="../../m3core/src/C/Common/Ctypes.i3.html">Ctypes</A>, <A HREF="../../m3core/src/text/Text8CString.i3.html">Text8CString</A>;

PROCEDURE <A NAME="Get"><procedure>Get</procedure></A>(x : REFANY) : TEXT RAISES { NotBranded } =
  VAR
    b := RTType.Get(TYPECODE(x)).brand_ptr;
    s := LOOPHOLE(b, Ctypes.char_star);
  BEGIN
    IF LOOPHOLE(s,INTEGER) = 0 THEN RAISE NotBranded END;
    (* RETURN M3toC.StoT(s) *)
    RETURN Text8CString.New(s);
  END Get;

PROCEDURE <A NAME="GetByTC"><procedure>GetByTC</procedure></A>(c : RT0.Typecode) : TEXT RAISES { NotBranded } =
  VAR
    b := RTType.Get(c).brand_ptr;
    s := LOOPHOLE(b, Ctypes.char_star);
  BEGIN
    IF LOOPHOLE(s,INTEGER) = 0 THEN RAISE NotBranded END;
    (* RETURN M3toC.StoT(s) *)
    RETURN Text8CString.New(s);
  END GetByTC;

BEGIN END RTBrand.
</PRE>
</inModule>
<PRE>























</PRE>
</BODY>
</HTML>
