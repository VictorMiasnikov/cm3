<HTML>
<HEAD>
<TITLE>Critical Mass Modula-3: juno-machine/src/JunoMarshal.m3</TITLE>
</HEAD>
<BODY bgcolor="#ffffff">
<A NAME="0TOP0">
<H2>juno-machine/src/JunoMarshal.m3</H2></A><HR>
<inModule>
<PRE></PRE> Copyright (C) 1992, Digital Equipment Corporation                         
 All rights reserved.                                                      
 See the file COPYRIGHT for a full description.                            
                                                                           
 Last modified on Thu Jun  9 13:13:39 PDT 1994 by heydon                   

<P><PRE>UNSAFE MODULE <module><implements><A HREF="JunoMarshal.i3.html">JunoMarshal</A></implements></module>;

IMPORT <A HREF="#x1">JunoValue</A>, <A HREF="JunoRT.i3.html">JunoRT</A>;

TYPE
  Byte = JunoRT.ByteCode;
  RefShort = UNTRACED REF ARRAY [0..ShortSize-1] OF Byte;
  RefUShort = UNTRACED REF ARRAY [0..UShortSize-1] OF Byte;
  RefULong = UNTRACED REF ARRAY [0..ULongSize-1] OF Byte;
  RefReal = UNTRACED REF ARRAY [0..RealSize-1] OF Byte;

PROCEDURE <A NAME="ReadShort"><procedure>ReadShort</procedure></A>(VAR a: BytePtr): Short =
  VAR res: Short; ra: RefShort := ADR(res); BEGIN
    FOR i := 0 TO ShortSize - 1 DO
      ra^[i] := a^; INC(a, ADRSIZE(a^))
    END;
    RETURN res
  END ReadShort;

PROCEDURE <A NAME="WriteShort"><procedure>WriteShort</procedure></A>(VAR a: BytePtr; sh: Short) =
  VAR ri: RefShort := ADR(sh); BEGIN
    FOR i := 0 TO ShortSize - 1 DO
      a^ := ri^[i]; INC(a, ADRSIZE(a^))
    END
  END WriteShort;

PROCEDURE <A NAME="ReadUShort"><procedure>ReadUShort</procedure></A>(VAR a: BytePtr): UShort =
  VAR res: UShort; ra: RefUShort := ADR(res); BEGIN
    FOR i := 0 TO UShortSize - 1 DO
      ra^[i] := a^; INC(a, ADRSIZE(a^))
    END;
    RETURN res
  END ReadUShort;

PROCEDURE <A NAME="WriteUShort"><procedure>WriteUShort</procedure></A>(VAR a: BytePtr; us: UShort) =
  VAR ri: RefUShort := ADR(us); BEGIN
    FOR i := 0 TO UShortSize - 1 DO
      a^ := ri^[i]; INC(a, ADRSIZE(a^))
    END
  END WriteUShort;

PROCEDURE <A NAME="ReadULong"><procedure>ReadULong</procedure></A>(VAR a: BytePtr): ULong =
  VAR res: ULong; ra: RefULong := ADR(res); BEGIN
    FOR i := 0 TO ULongSize - 1 DO
      ra^[i] := a^; INC(a, ADRSIZE(a^))
    END;
    RETURN res
  END ReadULong;

PROCEDURE <A NAME="WriteULong"><procedure>WriteULong</procedure></A>(VAR a: BytePtr; ul: ULong) =
  VAR ri: RefULong := ADR(ul); BEGIN
    FOR i := 0 TO ULongSize - 1 DO
      a^ := ri^[i]; INC(a, ADRSIZE(a^))
    END
  END WriteULong;

PROCEDURE <A NAME="ReadReal"><procedure>ReadReal</procedure></A>(VAR a: BytePtr): JunoValue.Real =
  VAR res: JunoValue.Real; ra: RefReal := ADR(res); BEGIN
    FOR i := 0 TO RealSize - 1 DO
      ra^[i] := a^; INC(a, ADRSIZE(a^))
    END;
    RETURN res
  END ReadReal;

PROCEDURE <A NAME="WriteReal"><procedure>WriteReal</procedure></A>(VAR a: BytePtr; r: JunoValue.Real) =
  VAR rr: RefReal := ADR(r); BEGIN
    FOR i := 0 TO RealSize - 1 DO
      a^ := rr^[i]; INC(a, ADRSIZE(a^))
    END
  END WriteReal;

BEGIN
END JunoMarshal.
</PRE>
</inModule>
<HR>
<A NAME="x1">interface JunoValue is in:
</A><UL>
<LI><A HREF="JunoValue.i3.html#0TOP0">juno-machine/src/JunoValue.i3</A>
<LI><A HREF="../../pkl-fonts/src/JunoValue.i3.html#0TOP0">pkl-fonts/src/JunoValue.i3</A>
</UL>
<P>
<PRE>























</PRE>
</BODY>
</HTML>
